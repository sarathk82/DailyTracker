(()=>{"use strict";var e={9188:(e,t,n)=>{var o=n(7408),r=n(9307),a=n(6283),i=n(9039),s=n(6986),l=n(8648),d=n(8833),c=n(3929),u=n(6773),f=n(5648),g=n(932),m=n(3668),y=n(1690),h=n(4767),p=n(8264),x=n(1171),b=n(5412),j=n(827);const w="@daily_tracker_entries",C="@daily_tracker_action_items",S="@daily_tracker_expenses",k="@daily_tracker_settings",T="@daily_tracker_backup";class B{static async getEntries(){try{const e=await j.default.getItem(w);if(null!=e){const t=JSON.parse(e).map(e=>Object.assign({},e,{timestamp:new Date(e.timestamp),type:e.type,isMarkdown:e.isMarkdown||!1}));return t.sort((e,t)=>{if(Math.abs(e.timestamp.getTime()-t.timestamp.getTime())<2e3){if("system"===e.type&&"system"!==t.type)return 1;if("system"!==e.type&&"system"===t.type)return-1}return e.timestamp.getTime()-t.timestamp.getTime()})}return[]}catch(e){return console.error("Error getting entries:",e),[]}}static async saveEntries(e){try{const t=JSON.stringify(e);await j.default.setItem(w,t)}catch(t){console.error("Error saving entries:",t)}}static async addEntry(e){try{const t=await this.getEntries();t.push(e),await this.saveEntries(t)}catch(t){console.error("Error adding entry:",t)}}static async getActionItems(){try{const e=await j.default.getItem(C);if(null!=e){return JSON.parse(e).map(e=>Object.assign({},e,{createdAt:new Date(e.createdAt),dueDate:e.dueDate?new Date(e.dueDate):void 0}))}return[]}catch(e){return console.error("Error getting action items:",e),[]}}static async saveActionItems(e){try{const t=JSON.stringify(e);await j.default.setItem(C,t)}catch(t){console.error("Error saving action items:",t)}}static async addActionItem(e){try{const t=await this.getActionItems();t.push(e),await this.saveActionItems(t)}catch(t){console.error("Error adding action item:",t)}}static async updateActionItem(e,t){try{const n=await this.getActionItems(),o=n.findIndex(t=>t.id===e);-1!==o&&(n[o]=Object.assign({},n[o],t)),await this.saveActionItems(n)}catch(n){console.error("Error updating action item:",n)}}static async deleteActionItem(e){try{const t=(await this.getActionItems()).filter(t=>t.id!==e);await this.saveActionItems(t)}catch(t){console.error("Error deleting action item:",t)}}static async getExpenses(){try{const e=await j.default.getItem(S);if(null!=e){const t=JSON.parse(e);return t.map(e=>Object.assign({},e,{createdAt:new Date(e.createdAt)}))}return[]}catch(e){return console.error("Error getting expenses:",e),[]}}static async saveExpenses(e){try{const t=JSON.stringify(e);await j.default.setItem(S,t)}catch(t){console.error("Error saving expenses:",t)}}static async addExpense(e){try{const t=await this.getExpenses();t.push(e),await this.saveExpenses(t)}catch(t){console.error("Error adding expense:",t)}}static async updateExpense(e,t){try{const n=await this.getExpenses(),o=n.findIndex(t=>t.id===e);-1!==o&&(n[o]=Object.assign({},n[o],t),await this.saveExpenses(n))}catch(n){console.error("Error updating expense:",n)}}static async deleteExpense(e){try{const t=(await this.getExpenses()).filter(t=>t.id!==e);await this.saveExpenses(t)}catch(t){console.error("Error deleting expense:",t)}}static async getSettings(){try{const e=await j.default.getItem(k);return null!=e?JSON.parse(e):null}catch(e){return console.error("Error getting settings:",e),null}}static async saveSettings(e){try{const t=JSON.stringify(e);await j.default.setItem(k,t)}catch(t){console.error("Error saving settings:",t)}}static async saveBackup(e){try{const t=JSON.stringify(e);await j.default.setItem(T,t)}catch(t){console.error("Error saving backup:",t)}}static async getBackup(){try{const e=await j.default.getItem(T);if(null!=e){const t=JSON.parse(e);return Object.assign({},t,{entries:t.entries.map(e=>Object.assign({},e,{timestamp:new Date(e.timestamp)})),expenses:t.expenses.map(e=>Object.assign({},e,{createdAt:new Date(e.createdAt)})),actionItems:t.actionItems.map(e=>Object.assign({},e,{createdAt:new Date(e.createdAt),dueDate:e.dueDate?new Date(e.dueDate):void 0}))})}return null}catch(e){return console.error("Error getting backup:",e),null}}}const D=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});class v{static detectActionItem(e){return/^\s*\.\s*\S/.test(e)}static detectExpense(e){const t=e.toLowerCase();if(this.EXPENSE_KEYWORDS.some(e=>t.includes(e)))return!0;if(this.hasNumericValue(e)&&this.hasExpenseContext(e)){if(/^\s*\d+(\.\d{1,2})?\s*$/.test(e))return!1;return!/^\s*(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*\d+(?:\.\d{1,2})?\s*$/.test(e)}return!1}static hasNumericValue(e){return/(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*\d+(?:\.\d{1,2})?|\b\d+(?:\.\d{1,2})?\b/.test(e)}static hasExpenseContext(e){const t=e.toLowerCase();if(["spent","bought","purchased","paid","cost","price","bill","receipt","shopping","store","market","restaurant","cafe","food","lunch","dinner","gas","fuel","electricity","rent","groceries","medicine","doctor","haircut","salon","barber","transportation","taxi","uber","lyft","coffee","tea","snack","movie","ticket","parking","toll"].some(e=>t.includes(e)))return!0;if(/\d+(?:\.\d{1,2})?\s+for\s+\w+/i.test(e))return!0;return!!/(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*\d+(?:\.\d{1,2})?\s+for\s+\w+/i.test(e)}static getSystemCurrency(){try{const t=Intl.NumberFormat().resolvedOptions().locale,n=Intl.DateTimeFormat().resolvedOptions().timeZone,o={"en-IN":"INR",en_IN:"INR","hi-IN":"INR",hi_IN:"INR","en-CA":"CAD",en_CA:"CAD","en-AU":"AUD",en_AU:"AUD","de-DE":"EUR",de_DE:"EUR","fr-FR":"EUR",fr_FR:"EUR","es-ES":"EUR",es_ES:"EUR","it-IT":"EUR",it_IT:"EUR","ja-JP":"JPY",ja_JP:"JPY","ko-KR":"KRW",ko_KR:"KRW","zh-CN":"CNY",zh_CN:"CNY","pt-BR":"BRL",pt_BR:"BRL","ru-RU":"RUB",ru_RU:"RUB"};if(o[t])return o[t];if(t.endsWith("-IN")||t.endsWith("_IN"))return"INR";if(n&&(n.includes("Asia/Calcutta")||n.includes("Asia/Kolkata")))return"INR";if(t.includes("en"))try{const e=new Intl.NumberFormat(t,{style:"currency",currency:"INR"});if(e.format(100).includes("\u20b9"))return"INR"}catch(e){}if(t.endsWith("-US")||t.endsWith("_US"))return"USD";if(t.endsWith("-GB")||t.endsWith("_GB"))return"GBP";if(t.endsWith("-DE")||t.endsWith("_DE")||t.endsWith("-FR")||t.endsWith("_FR")||t.endsWith("-ES")||t.endsWith("_ES")||t.endsWith("-IT")||t.endsWith("_IT"))return"EUR";return Intl.NumberFormat(t).resolvedOptions().currency||"USD"}catch(e){return"USD"}}static extractActionItem(e,t){if(this.detectActionItem(e)){let n=e.trim();n.startsWith(".")&&(n=n.substring(1).trim());const o=this.extractDueDate(e);return{id:D(),entryId:t,title:n,completed:!1,createdAt:new Date,dueDate:o}}return null}static extractDueDate(e){const t=e.toLowerCase(),n=new Date;if(n.setHours(0,0,0,0),/\btoday\b/.test(t))return new Date(n);if(/\btomorrow\b/.test(t)){const e=new Date(n);return e.setDate(e.getDate()+1),e}if(/\bday after tomorrow\b/.test(t)||/\bday after\b/.test(t)){const e=new Date(n);return e.setDate(e.getDate()+2),e}if(/\bnext week\b/.test(t)){const e=new Date(n);return e.setDate(e.getDate()+7),e}const o=t.match(/\b(one|two|three|four|\d+)\s+weeks?\s+from\s+now\b/i);if(o){const e={one:1,two:2,three:3,four:4}[o[1].toLowerCase()]||parseInt(o[1]),t=new Date(n);return t.setDate(t.getDate()+7*e),t}const r=t.match(/\b(one|two|three|four|\d+)\s+months?\s+from\s+now\b/i);if(r){const e={one:1,two:2,three:3,four:4}[r[1].toLowerCase()]||parseInt(r[1]),t=new Date(n);return t.setMonth(t.getMonth()+e),t}const a=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(let d=0;d<a.length;d++){if(new RegExp(`\\b(?:on |next )?${a[d]}\\b`,"i").test(t)){let e=d-n.getDay();e<=0&&(e+=7);const t=new Date(n);return t.setDate(t.getDate()+e),t}}const i=["january","february","march","april","may","june","july","august","september","october","november","december"],s=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];for(let d=0;d<i.length;d++){const e=new RegExp(`\\b(?:on )?(?:${i[d]}|${s[d]})[\\s,]+([0-3]?\\d)(?:st|nd|rd|th)?\\b`,"i"),o=new RegExp(`\\b(?:on )?([0-3]?\\d)(?:st|nd|rd|th)?[\\s,]+(?:${i[d]}|${s[d]})\\b`,"i");let r=t.match(e);if(r||(r=t.match(o)),r){const e=parseInt(r[1]);if(e>=1&&e<=31){const t=new Date(n.getFullYear(),d,e);return t<n&&t.setFullYear(t.getFullYear()+1),t}}}const l=t.match(/\b(?:in|after)\s+(\d+)\s+days?\b/i);if(l){const e=parseInt(l[1]),t=new Date(n);return t.setDate(t.getDate()+e),t}return new Date(n)}static extractExpenseInfo(e,t){const n=this.extractAmount(e);if(!n)return null;const o=this.extractCategoryFromText(e);return{id:D(),entryId:t,amount:n.value,currency:n.currency,description:o.description,category:o.category,createdAt:new Date}}static extractCategoryFromText(e){const t=e.toLowerCase().trim(),n=e.trim(),o=e.match(/(?:spent|paid|bought|purchased|cost|charged)\s+(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])?\s*\d+(?:\.\d{1,2})?\s+for\s+(.+)/i);if(o){const e=o[1].trim();return{category:this.mapToStandardCategory(e),description:n}}const r=e.match(/(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])?\s*\d+(?:\.\d{1,2})?\s+for\s+(.+)/i);if(r){const e=r[1].trim();return{category:this.mapToStandardCategory(e),description:n}}const a=e.match(/(?:spent|paid|bought|purchased)\s+(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])?\s*\d+(?:\.\d{1,2})?\s+on\s+(.+)/i);if(a){const e=a[1].trim();return{category:this.mapToStandardCategory(e),description:n}}const i=["haircut","salon","barber","taxi","uber","lyft","parking","toll","coffee","tea","lunch","dinner","breakfast","snack","food","groceries","shopping","movie","ticket","gas","fuel","electricity","rent","medicine","doctor","train","bus","flight","metro","subway","cab","auto"];for(const s of i)if(t.includes(s)){if("ticket"===s){const e=t.match(/\b(train|bus|flight|metro|subway)\s+ticket\b/);if(e)return{category:this.mapToStandardCategory(e[0]),description:n};const o=t.match(/\b(movie|cinema|concert|show)\s+ticket\b/);return o?{category:this.mapToStandardCategory(o[0]),description:n}:{category:this.mapToStandardCategory("ticket"),description:n}}return{category:this.mapToStandardCategory(s),description:n}}return{description:n}}static mapToStandardCategory(e){const t=e.toLowerCase().trim();return["train ticket","bus ticket","flight ticket","metro ticket","subway ticket"].some(e=>t.includes(e))||["taxi","uber","lyft","parking","toll","gas","fuel","transportation","train","bus","flight","metro","subway","cab","auto"].some(e=>t.includes(e))?"Transportation":["coffee","tea","lunch","dinner","breakfast","snack","food","groceries","restaurant","cafe"].some(e=>t.includes(e))?"Food":["haircut","salon","barber","medicine","doctor","hospital","pharmacy"].some(e=>t.includes(e))?"Health & Personal Care":["movie ticket","concert ticket","show ticket","movie","cinema","theater","entertainment"].some(e=>t.includes(e))||t.includes("ticket")&&!["train","bus","flight","metro","subway"].some(e=>t.includes(e))?"Entertainment":["electricity","rent","bill","utilities","water","internet"].some(e=>t.includes(e))?"Utilities":["shopping","clothes","clothing","shoes","accessories"].some(e=>t.includes(e))?"Shopping":e.charAt(0).toUpperCase()+e.slice(1)}static extractAmount(e){const t=e.match(/(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*(\d+(?:\.\d{1,2})?)|(\d+(?:\.\d{1,2})?)/g);if(!t||0===t.length)return null;let n=null,o=0;const r=t.map(e=>{const t=e.replace(/^(Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*/i,""),r=parseFloat(t);return!isNaN(r)&&r>0?(r>=o&&(o=r,e.includes("$")?n="USD":e.includes("\u20ac")?n="EUR":e.includes("\xa3")?n="GBP":(e.includes("\u20b9")||/Rs\.?|rs\.?|RS\.?/i.test(e))&&(n="INR")),r):NaN}).filter(e=>!isNaN(e)&&e>0);if(0===r.length)return null;return{value:Math.max(...r),currency:n||this.getSystemCurrency()}}static formatCurrency(e,t){const n=t||this.getSystemCurrency();try{let t="en-US";switch(n){case"USD":t="en-US";break;case"EUR":case"GBP":t="en-GB";break;case"INR":t="en-IN";break;case"CAD":t="en-CA";break;case"AUD":t="en-AU"}const o=new Intl.NumberFormat(t,{style:"currency",currency:n,minimumFractionDigits:2,maximumFractionDigits:2}).format(e);return"USD"===n&&o.startsWith("US$")?o.replace("US$","$"):"CAD"===n&&o.startsWith("CA$")?o.replace("CA$","C$"):o}catch(o){return`${{USD:"$",EUR:"\u20ac",GBP:"\xa3",INR:"\u20b9",CAD:"C$",AUD:"A$",JPY:"\xa5",CNY:"\xa5"}[n]||n}${e.toFixed(2)}`}}static isExpenseRelated(e){const t=e.toLowerCase();return this.EXPENSE_KEYWORDS.some(e=>t.includes(e))}}v.CURRENCY_PATTERNS=[/\b\d+(\.\d{1,2})?\b/g,/[\u20b9$\u20ac\xa3]\s*\d+(\.\d{1,2})?|\d+(\.\d{1,2})?\s*[\u20b9$\u20ac\xa3]/g,/(?:Rs\.?|rs\.?|RS\.?)\s*\d+(\.\d{1,2})?/g,/\d+(\.\d{1,2})?\s*(rupees?|dollars?|euros?|pounds?)/g],v.EXPENSE_KEYWORDS=["spent","bought","purchased","paid","cost","expense","payment","buy","pay","shopping","store","bill","receipt","charged","withdrew","withdrawal","transaction","fee","subscription"],v.ACTION_KEYWORDS=["todo","to-do","task","need to","should","must","have to","action","plan","schedule","remind","remember","don't forget","important","deadline","due","appointment","meeting","call","email","follow up","buy","get","pick up","pack","finish","complete","start","contact","reach out","check","review","submit","apply","book","reserve"];var I=n(5009),A=n(444),z=n(2656),E=n(6725);const R=()=>{{const e=E.default.get("window").width,t="undefined"!==typeof navigator?navigator.userAgent:"",n=e>768,o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t);return n&&!o}};var W=n(4411);const M=({entry:e,onLongPress:t,onEdit:n,onDelete:o,markdownStyles:i,expense:s,actionItem:l})=>{const[d,u]=(0,r.useState)(!1),[g]=(0,r.useState)(new I.default.Value(0)),m=R(),y=A.default.create({onStartShouldSetPanResponder:()=>!m&&"system"!==e.type,onMoveShouldSetPanResponder:(t,n)=>!m&&"system"!==e.type&&Math.abs(n.dx)>5,onPanResponderMove:(e,t)=>{t.dx<0&&g.setValue(t.dx)},onPanResponderRelease:(e,t)=>{t.dx<-80?I.default.spring(g,{toValue:-80,useNativeDriver:!0}).start():I.default.spring(g,{toValue:0,useNativeDriver:!0}).start()}}),h=()=>{switch(e.type){case"expense":return(0,W.jsx)(a.default,{style:{fontSize:16,color:"#2e7d32"},children:"\ud83d\udcb0"});case"action":return(0,W.jsx)(a.default,{style:{fontSize:16,color:"#1565c0"},children:"\u2705"});default:return null}};return(0,W.jsx)(c.default,{style:"system"===e.type?P.systemMessageContainer:P.userMessageContainer,children:(0,W.jsx)(c.default,{style:P.bubbleWrapper,children:(0,W.jsxs)(I.default.View,Object.assign({},y.panHandlers,{style:[{flexDirection:"row",transform:[{translateX:g}]}]},m&&"system"!==e.type?{onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1)}:{},{children:[(0,W.jsx)(f.default,{activeOpacity:1,onLongPress:"system"!==e.type?()=>{n&&n(e)}:void 0,delayLongPress:500,disabled:m&&"system"!==e.type,style:(()=>{const t=[P.messageBubble],n="system"===e.type?P.systemMessage:P.userMessage;switch(e.type){case"expense":return[...t,P.expenseBubble,n];case"action":return[...t,P.actionBubble,n];case"system":return[...t,P.systemBubble,n];default:return[...t,P.defaultBubble,n]}})(),children:(0,W.jsx)(()=>(0,W.jsxs)(c.default,{style:{flex:1},children:[(0,W.jsxs)(c.default,{style:P.messageHeader,children:[h(),(0,W.jsx)(a.default,{style:P.timestamp,children:(0,b.default)(e.timestamp,"HH:mm")}),"system"!==e.type&&m&&d&&(0,W.jsxs)(c.default,{style:P.actionButtons,children:[n&&(0,W.jsx)(f.default,{style:P.actionButton,onPress:()=>n(e),hitSlop:{top:10,bottom:10,left:10,right:10},children:(0,W.jsx)(a.default,{style:P.actionButtonText,children:"\u270f\ufe0f Edit"})}),o&&(0,W.jsx)(f.default,{style:[P.actionButton,P.deleteButton],onPress:t=>{t.stopPropagation(),window.confirm("Are you sure you want to delete this entry?")&&o(e)},hitSlop:{top:10,bottom:10,left:10,right:10},children:(0,W.jsx)(a.default,{style:P.actionButtonText,children:"\ud83d\uddd1\ufe0f Delete"})})]})]}),"system"!==e.type&&!m&&(0,W.jsx)(a.default,{style:P.gestureHint,children:"Long press to edit \u2022 Swipe left to delete"}),e.isMarkdown?(0,W.jsx)(z.default,{style:i,children:e.text}):(0,W.jsx)(a.default,{style:[P.messageText,"system"===e.type?P.systemMessageText:"log"===e.type?P.userMessageText:P.nonUserMessageText],selectable:!0,children:e.text})]}),{})}),!m&&"system"!==e.type&&(0,W.jsx)(f.default,{style:P.deleteIndicator,onPress:()=>{o&&o(e),I.default.spring(g,{toValue:0,useNativeDriver:!0}).start()},children:(0,W.jsx)(a.default,{style:{fontSize:24,color:"#f44336"},children:"\ud83d\uddd1\ufe0f"})})]}))})})},P=m.default.create({userMessageContainer:{marginVertical:4,alignSelf:"flex-start",maxWidth:"90%",flexShrink:0},systemMessageContainer:{marginVertical:4,alignSelf:"flex-end",maxWidth:"90%",flexShrink:0},bubbleWrapper:{position:"relative",overflow:"hidden"},deleteIndicator:{position:"absolute",right:-80,top:0,bottom:0,width:80,backgroundColor:"transparent",justifyContent:"center",alignItems:"center",borderRadius:12},messageContainer:{marginVertical:1,alignSelf:"flex-start",maxWidth:"95%"},messageBubble:Object.assign({paddingHorizontal:12,paddingVertical:8,minWidth:200,maxWidth:"100%",alignSelf:"flex-start",borderRadius:12},{boxShadow:"0px 1px 1px rgba(0, 0, 0, 0.18)"}),defaultBubble:{backgroundColor:"#f0f0f0"},expenseBubble:{backgroundColor:"#e8f5e8",borderColor:"#4caf50",borderWidth:1},actionBubble:{backgroundColor:"#e3f2fd",borderColor:"#2196f3",borderWidth:1},systemBubble:{backgroundColor:"#e3f2fd",borderColor:"#2196f3",borderWidth:1,borderRadius:12},systemMessage:{backgroundColor:"#e3f2fd",marginLeft:"15%",borderTopLeftRadius:20,borderTopRightRadius:5,borderBottomLeftRadius:20,borderBottomRightRadius:5},userMessage:{backgroundColor:"#f0f0f0",marginRight:"15%",borderTopLeftRadius:5,borderTopRightRadius:20,borderBottomLeftRadius:5,borderBottomRightRadius:20},messageHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:4,flexWrap:"wrap",minWidth:200},actionButtons:{flexDirection:"row",gap:4,alignItems:"center"},actionButton:{flexDirection:"row",alignItems:"center",padding:4,paddingHorizontal:6,borderRadius:4,backgroundColor:"rgba(0, 0, 0, 0.05)"},deleteButton:{backgroundColor:"rgba(244, 67, 54, 0.1)"},actionButtonText:{fontSize:12},gestureHint:{fontSize:9,color:"#999",fontStyle:"italic",marginBottom:4},timestamp:{fontSize:10,color:"#666",marginLeft:4},messageText:Object.assign({fontSize:15,lineHeight:20},{userSelect:"text",WebkitUserSelect:"text",display:"inline-block",minWidth:"fit-content"}),userMessageText:{color:"#333"},systemMessageText:{color:"#1565c0",fontSize:14,textAlign:"left",fontWeight:"500"},nonUserMessageText:{color:"#333"},categoryLabel:{fontSize:11,color:"#666",fontStyle:"italic",marginTop:2,flexShrink:1,flexWrap:"wrap"}}),L=({item:e,expense:t,actionItem:n,onEdit:o,onDelete:i,markdownStyles:s,layoutStyles:l})=>{const d=R(),[u]=(0,r.useState)(new I.default.Value(0)),[g,m]=(0,r.useState)(!1),y=d?{panHandlers:{}}:A.default.create({onStartShouldSetPanResponder:()=>"system"!==e.type,onMoveShouldSetPanResponder:(t,n)=>"system"!==e.type&&Math.abs(n.dx)>5,onPanResponderMove:(e,t)=>{t.dx<0&&u.setValue(t.dx)},onPanResponderRelease:(e,t)=>{t.dx<-80?I.default.spring(u,{toValue:-80,useNativeDriver:!0}).start():I.default.spring(u,{toValue:0,useNativeDriver:!0}).start()}});return(0,W.jsx)(c.default,{style:{position:"relative",overflow:"hidden"},children:(0,W.jsxs)(I.default.View,Object.assign({},d?{}:y.panHandlers,{style:[{flexDirection:"row"},!d&&{transform:[{translateX:u}]}],children:[(0,W.jsx)(f.default,Object.assign({activeOpacity:1,style:{flex:1},onPress:()=>{d||m(!g)},onLongPress:()=>{d||"system"===e.type||o(e)},delayLongPress:500},d?{onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1)}:{},{children:(0,W.jsxs)(c.default,{style:l.minimalContainer,children:[(0,W.jsxs)(c.default,{style:l.minimalContent,children:[(0,W.jsx)(c.default,{style:{flex:1,minWidth:0,marginRight:4},children:e.isMarkdown?(0,W.jsx)(z.default,{style:s,children:e.text}):(0,W.jsx)(a.default,{style:l.minimalText,numberOfLines:1,ellipsizeMode:"tail",children:e.text})}),t&&(0,W.jsx)(a.default,{style:{fontSize:14,flexShrink:0},children:"\ud83d\udcb0"}),n&&(0,W.jsx)(a.default,{style:{fontSize:14,flexShrink:0},children:"\u2705"})]}),(0,W.jsxs)(c.default,{style:l.minimalMeta,children:[g&&(0,W.jsx)(a.default,{style:l.minimalTime,children:(0,b.default)(e.timestamp,"h:mm a")}),"system"!==e.type&&d&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(f.default,{style:{padding:2,backgroundColor:"rgba(0,0,0,0.05)",borderRadius:4,marginLeft:4},onPress:()=>o(e),children:(0,W.jsx)(a.default,{style:{fontSize:10},children:"\u270f\ufe0f"})}),(0,W.jsx)(f.default,{style:{padding:2,backgroundColor:"rgba(0,0,0,0.05)",borderRadius:4,marginLeft:2},onPress:()=>{window.confirm("Are you sure you want to delete this entry?")&&i(e)},children:(0,W.jsx)(a.default,{style:{fontSize:10},children:"\ud83d\uddd1\ufe0f"})})]})]})]})})),!d&&"system"!==e.type&&(0,W.jsx)(f.default,{style:H.deleteIndicator,onPress:()=>{i(e),I.default.spring(u,{toValue:0,useNativeDriver:!0}).start()},children:(0,W.jsx)(a.default,{style:{fontSize:24,color:"#f44336"},children:"\ud83d\uddd1\ufe0f"})})]}))})},H=m.default.create({deleteIndicator:{position:"absolute",right:-80,top:0,bottom:0,width:80,backgroundColor:"transparent",justifyContent:"center",alignItems:"center"}});var O=n(4037),V=n(2772);const F={isMarkdownEnabled:!0,enterToSend:!0,systemCurrency:"AUTO",layoutStyle:"chat",theme:"system"},N=[{code:"AUTO",name:"Auto-detect",symbol:"\ud83c\udf0d"},{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:"\u20ac"},{code:"GBP",name:"British Pound",symbol:"\xa3"},{code:"INR",name:"Indian Rupee",symbol:"\u20b9"},{code:"CAD",name:"Canadian Dollar",symbol:"C$"},{code:"AUD",name:"Australian Dollar",symbol:"A$"},{code:"JPY",name:"Japanese Yen",symbol:"\xa5"}],$=[{id:"light",name:"Light Mode",icon:"\u2600\ufe0f"},{id:"dark",name:"Dark Mode",icon:"\ud83c\udf19"},{id:"system",name:"System Default",icon:"\u2699\ufe0f"}],U=({onClose:e,onExportText:t,onExportJSON:n,onImport:o,onBackup:i,onRestore:s})=>{const[l,d]=(0,r.useState)(F),[u,g]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1),[b,j]=(0,r.useState)(!1);(0,r.useEffect)(()=>{w()},[]);const w=async()=>{try{const e=await B.getSettings();e&&d(Object.assign({},F,e))}catch(e){console.error("Error loading settings:",e)}},C=(e,t)=>{console.log(`Updating setting ${String(e)} to ${t}`);(async e=>{try{console.log("Saving settings:",e),await B.saveSettings(e),d(e),console.log("Settings saved successfully")}catch(t){console.error("Error saving settings:",t),y.default.alert("Error","Failed to save settings")}})(Object.assign({},l,{[e]:t}))},S=[{id:"chat",name:"Chat Style",icon:"\ud83d\udcac"},{id:"cards",name:"Card Layout",icon:"\ud83c\udccf"},{id:"timeline",name:"Timeline Style",icon:"\u23f0"},{id:"minimal",name:"Minimal Design",icon:"\u2728"}];return(0,W.jsxs)(x.SafeAreaView,{style:_.container,children:[(0,W.jsxs)(c.default,{style:_.header,children:[(0,W.jsx)(a.default,{style:_.headerTitle,children:"Settings"}),(0,W.jsx)(f.default,{onPress:e,style:_.closeButton,children:(0,W.jsx)(a.default,{style:_.closeButtonText,children:"\u2715"})})]}),(0,W.jsxs)(V.default,{style:_.content,children:[(0,W.jsxs)(c.default,{style:_.section,children:[(0,W.jsx)(a.default,{style:_.sectionTitle,children:"Text Input"}),(0,W.jsxs)(c.default,{style:_.settingItem,children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Enable Markdown"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Format text with **bold**, *italic*, and other markdown syntax"})]}),(0,W.jsx)(O.default,{value:l.isMarkdownEnabled,onValueChange:e=>C("isMarkdownEnabled",e)})]}),(0,W.jsxs)(c.default,{style:_.settingItem,children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Enter to Send"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Press Enter to send message (off = Enter adds new line)"})]}),(0,W.jsx)(O.default,{value:l.enterToSend,onValueChange:e=>C("enterToSend",e)})]})]}),(0,W.jsxs)(c.default,{style:_.section,children:[(0,W.jsx)(a.default,{style:_.sectionTitle,children:"Currency"}),(0,W.jsxs)(f.default,{style:_.settingItem,onPress:()=>{console.log("Currency picker tapped"),console.log("Setting showCurrencyModal to true"),g(!0)},children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Default Currency"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Currency for expenses (when not explicitly specified)"}),(0,W.jsx)(a.default,{style:_.settingValue,children:(()=>{const e=N.find(e=>e.code===l.systemCurrency);return e?`${e.symbol} ${e.name}`:"Auto-detect"})()})]}),(0,W.jsx)(a.default,{style:_.arrow,children:"\u203a"})]})]}),(0,W.jsxs)(c.default,{style:_.section,children:[(0,W.jsx)(a.default,{style:_.sectionTitle,children:"Appearance"}),(0,W.jsxs)(f.default,{style:_.settingItem,onPress:()=>{console.log("Theme picker tapped"),j(!0)},children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Theme"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Choose your color theme preference"}),(0,W.jsx)(a.default,{style:_.settingValue,children:(()=>{const e=l.theme||"system",t=$.find(t=>t.id===e);return t?`${t.icon} ${t.name}`:"\u2699\ufe0f System Default"})()})]}),(0,W.jsx)(a.default,{style:_.arrow,children:"\u203a"})]}),(0,W.jsxs)(f.default,{style:_.settingItem,onPress:()=>{console.log("Layout picker tapped"),console.log("Setting showLayoutModal to true"),h(!0)},children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Journal Layout"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Choose how your journal entries are displayed"}),(0,W.jsx)(a.default,{style:_.settingValue,children:(()=>{const e=S.find(e=>e.id===l.layoutStyle);return e?`${e.icon} ${e.name}`:"\ud83d\udcac Chat Style"})()})]}),(0,W.jsx)(a.default,{style:_.arrow,children:"\u203a"})]})]}),(0,W.jsxs)(c.default,{style:_.section,children:[(0,W.jsx)(a.default,{style:_.sectionTitle,children:"Data Management"}),(0,W.jsxs)(f.default,{style:_.settingItem,onPress:t,children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Export as Text"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Download all entries as a formatted text file"})]}),(0,W.jsx)(a.default,{style:_.arrow,children:"\u203a"})]}),(0,W.jsxs)(f.default,{style:_.settingItem,onPress:n,children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Export as JSON"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Download all data for backup or import"})]}),(0,W.jsx)(a.default,{style:_.arrow,children:"\u203a"})]}),(0,W.jsxs)(f.default,{style:_.settingItem,onPress:o,children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Import Data"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Import entries from a JSON file"})]}),(0,W.jsx)(a.default,{style:_.arrow,children:"\u203a"})]}),(0,W.jsx)(c.default,{style:_.divider}),(0,W.jsxs)(f.default,{style:_.settingItem,onPress:i,children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Create Backup"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Save a backup of all your data"})]}),(0,W.jsx)(a.default,{style:_.arrow,children:"\u203a"})]}),(0,W.jsxs)(f.default,{style:_.settingItem,onPress:s,children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Restore from Backup"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Restore your data from a previous backup"})]}),(0,W.jsx)(a.default,{style:_.arrow,children:"\u203a"})]}),(0,W.jsx)(c.default,{style:_.divider}),(0,W.jsxs)(f.default,{style:[_.settingItem,_.dangerSettingItem],onPress:async()=>{console.log("handleClearJournal called");if(window.confirm("This will delete all journal entries but keep your expenses and tasks. Continue?"))try{console.log("Clearing journal entries...");const e=await B.getEntries();console.log(`Found ${e.length} entries to clear`),await B.saveEntries([]),console.log("Journal entries cleared successfully"),window.alert("Journal entries cleared. Your expenses and tasks are safe. Please refresh the journal tab.")}catch(e){console.error("Error clearing journal:",e),window.alert("Failed to clear journal entries")}},children:[(0,W.jsxs)(c.default,{style:_.settingInfo,children:[(0,W.jsx)(a.default,{style:[_.settingLabel,_.dangerText],children:"Clear Journal Entries"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Delete all journal entries while keeping expenses and tasks"})]}),(0,W.jsx)(a.default,{style:[_.arrow,_.dangerText],children:"\u203a"})]})]}),(0,W.jsxs)(c.default,{style:_.section,children:[(0,W.jsx)(a.default,{style:_.sectionTitle,children:"About"}),(0,W.jsxs)(c.default,{style:_.settingItem,children:[(0,W.jsx)(a.default,{style:_.settingLabel,children:"Daily Tracker"}),(0,W.jsx)(a.default,{style:_.settingDescription,children:"Smart journal with automatic expense and task detection"})]})]})]}),(0,W.jsx)(p.default,{visible:u,animationType:"slide",transparent:!0,onRequestClose:()=>g(!1),children:(0,W.jsx)(c.default,{style:q.overlay,children:(0,W.jsxs)(c.default,{style:q.container,children:[(0,W.jsx)(a.default,{style:q.title,children:"Select Currency"}),(0,W.jsx)(a.default,{style:q.subtitle,children:"Choose your preferred currency:"}),(0,W.jsx)(V.default,{style:q.optionsList,showsVerticalScrollIndicator:!0,children:N.map(e=>(0,W.jsxs)(f.default,{style:[q.option,l.systemCurrency===e.code&&q.selectedOption],onPress:()=>{C("systemCurrency",e.code),g(!1)},children:[(0,W.jsxs)(a.default,{style:[q.optionText,l.systemCurrency===e.code&&q.selectedOptionText],children:[e.symbol," ",e.name]}),l.systemCurrency===e.code&&(0,W.jsx)(a.default,{style:q.checkmark,children:"\u2713"})]},e.code))}),(0,W.jsx)(f.default,{style:q.cancelButton,onPress:()=>g(!1),children:(0,W.jsx)(a.default,{style:q.cancelButtonText,children:"Cancel"})})]})})}),(0,W.jsx)(p.default,{visible:m,animationType:"slide",transparent:!0,onRequestClose:()=>h(!1),children:(0,W.jsx)(c.default,{style:q.overlay,children:(0,W.jsxs)(c.default,{style:q.container,children:[(0,W.jsx)(a.default,{style:q.title,children:"Select Layout Style"}),(0,W.jsx)(a.default,{style:q.subtitle,children:"Choose how your journal entries are displayed:"}),(0,W.jsx)(V.default,{style:q.optionsList,showsVerticalScrollIndicator:!0,children:S.map(e=>(0,W.jsxs)(f.default,{style:[q.option,l.layoutStyle===e.id&&q.selectedOption],onPress:()=>{C("layoutStyle",e.id),h(!1)},children:[(0,W.jsxs)(a.default,{style:[q.optionText,l.layoutStyle===e.id&&q.selectedOptionText],children:[e.icon," ",e.name]}),l.layoutStyle===e.id&&(0,W.jsx)(a.default,{style:q.checkmark,children:"\u2713"})]},e.id))}),(0,W.jsx)(f.default,{style:q.cancelButton,onPress:()=>h(!1),children:(0,W.jsx)(a.default,{style:q.cancelButtonText,children:"Cancel"})})]})})}),(0,W.jsx)(p.default,{visible:b,animationType:"slide",transparent:!0,onRequestClose:()=>j(!1),children:(0,W.jsx)(c.default,{style:q.overlay,children:(0,W.jsxs)(c.default,{style:q.container,children:[(0,W.jsx)(a.default,{style:q.title,children:"Select Theme"}),(0,W.jsx)(a.default,{style:q.subtitle,children:"Choose your preferred color theme:"}),(0,W.jsx)(V.default,{style:q.optionsList,showsVerticalScrollIndicator:!0,children:$.map(e=>{const t=l.theme||"system";return(0,W.jsxs)(f.default,{style:[q.option,t===e.id&&q.selectedOption],onPress:()=>{C("theme",e.id),j(!1)},children:[(0,W.jsxs)(a.default,{style:[q.optionText,t===e.id&&q.selectedOptionText],children:[e.icon," ",e.name]}),t===e.id&&(0,W.jsx)(a.default,{style:q.checkmark,children:"\u2713"})]},e.id)})}),(0,W.jsx)(f.default,{style:q.cancelButton,onPress:()=>j(!1),children:(0,W.jsx)(a.default,{style:q.cancelButtonText,children:"Cancel"})})]})})})]})},_=m.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},headerTitle:{fontSize:20,fontWeight:"bold",color:"#333"},closeButton:{padding:8,borderRadius:20,backgroundColor:"#f0f0f0"},closeButtonText:{fontSize:16,color:"#666",fontWeight:"bold"},content:{flex:1},section:{backgroundColor:"#fff",marginVertical:8,paddingVertical:8},sectionTitle:{fontSize:16,fontWeight:"bold",color:"#333",paddingHorizontal:16,paddingVertical:8,backgroundColor:"#f8f8f8"},settingItem:{flexDirection:"row",alignItems:"center",paddingHorizontal:16,paddingVertical:12,borderBottomWidth:1,borderBottomColor:"#f0f0f0"},settingInfo:{flex:1,marginRight:12},settingLabel:{fontSize:16,color:"#333",marginBottom:4},settingDescription:{fontSize:14,color:"#666",lineHeight:18},settingValue:{fontSize:14,color:"#007AFF",marginTop:4,fontWeight:"500"},arrow:{fontSize:20,color:"#ccc"},dangerSettingItem:{backgroundColor:"#fff0f0"},dangerText:{color:"#d32f2f"},divider:{height:8,backgroundColor:"#f5f5f5",marginVertical:8}}),q=m.default.create({overlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",paddingHorizontal:20},container:{backgroundColor:"#fff",borderRadius:12,width:"100%",maxWidth:400,minHeight:300,maxHeight:"80%",paddingVertical:20},title:{fontSize:20,fontWeight:"bold",color:"#333",textAlign:"center",marginBottom:8},subtitle:{fontSize:16,color:"#666",textAlign:"center",marginBottom:20,paddingHorizontal:20},optionsList:{flexGrow:1,minHeight:200},option:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:20,paddingVertical:16,borderBottomWidth:1,borderBottomColor:"#f0f0f0",minHeight:50},selectedOption:{backgroundColor:"#e3f2fd"},optionText:{fontSize:16,color:"#333",flex:1},selectedOptionText:{color:"#1976d2",fontWeight:"500"},checkmark:{fontSize:18,color:"#1976d2",fontWeight:"bold"},cancelButton:{marginTop:20,marginHorizontal:20,paddingVertical:12,backgroundColor:"#f5f5f5",borderRadius:8,alignItems:"center"},cancelButtonText:{fontSize:16,color:"#333",fontWeight:"500"}}),J=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),Y=()=>{const[e,t]=(0,r.useState)([]),[n,o]=(0,r.useState)(""),[i,s]=(0,r.useState)(!0),[l,d]=(0,r.useState)(0),m=(0,r.useRef)(null),j=(0,r.useRef)(null),w=((0,r.useRef)(!1),(0,r.useRef)(!0),(0,r.useRef)(!1)),[C,S]=(0,r.useState)(!0),[k,T]=(0,r.useState)(!1),[D,I]=(0,r.useState)("chat"),[A,z]=(0,r.useState)(""),[E,R]=(0,r.useState)(!1),[P,H]=(0,r.useState)([]),[O,V]=(0,r.useState)(null),[F,N]=(0,r.useState)(!1),[$,_]=(0,r.useState)([]),[q,Y]=(0,r.useState)([]),[Q,Z]=(0,r.useState)(!1),[ee,te]=(0,r.useState)(!1),[ne,oe]=(0,r.useState)(null),[re,ae]=(0,r.useState)(""),[ie,se]=(0,r.useState)(""),[le,de]=(0,r.useState)(""),[ce,ue]=(0,r.useState)(null),fe=["spent Rs150 for coffee","bought groceries for $45.50","paid \u20b92500 for electricity bill","lunch cost $12.99","purchased fuel Rs3200","500 for haircut","\u20b9300 for taxi","50 for parking","spent 200 on movie ticket","paid $25 for gym membership","dinner cost Rs850","need to call mom tomorrow","todo: finish the quarterly report","must submit tax documents by Friday","reminder: doctor appointment at 3pm","should book flight tickets",". pick up dry cleaning",". schedule dentist appointment",". buy birthday gift for Sarah",". pay credit card bill","todo: prepare presentation slides","had a great meeting today","weather is lovely","feeling productive this morning","learned something new about React Native","grateful for a good day","enjoyed my morning coffee","finished reading a great book","went for a long walk","cooked a delicious meal","watched an interesting documentary","had a video call with friends","organized my workspace","tried a new recipe today","listened to a great podcast","feeling motivated and energized","completed my daily workout","spent quality time with family","practiced meditation for 20 minutes","wrote in my journal","started learning a new skill","cleaned and organized my room","discovered a new favorite song","made progress on personal project","helped a friend with their work","reflected on my goals","enjoyed the sunset","read an inspiring article","practiced gratitude","had a relaxing evening","played games with friends","explored a new neighborhood","tried a new coffee shop","attended an online webinar","updated my resume","planned next week's schedule","sorted through old photos","donated unused items","fixed a bug in my code","reviewed my budget","called an old friend","planted some herbs","rearranged furniture","learned a new keyboard shortcut","backed up my data","cleaned out my inbox","updated my software","read documentation","wrote unit tests","refactored some code","debugged an issue","improved performance","added new features","reviewed pull requests","attended standup meeting","brainstormed ideas","sketched UI designs","created wireframes","wrote technical specs","researched best practices","optimized database queries","configured CI/CD pipeline","set up monitoring","analyzed metrics","documented API endpoints","reviewed architecture","planned sprint tasks","estimated story points","pair programmed with teammate","conducted code review","deployed to staging","tested new feature","fixed production bug","updated dependencies","wrote blog post","shared knowledge with team","mentored junior developer","attended tech talk","experimented with new library","built proof of concept","improved accessibility","enhanced security","reduced technical debt","improved error handling","added logging","created dashboard","automated workflow","simplified complex logic","improved user experience","gathered user feedback","analyzed usage patterns","identified bottlenecks","proposed solution","implemented caching","optimized bundle size","improved load time","enhanced mobile experience","added dark mode","created design system","standardized components","improved code coverage","fixed flaky tests","upgraded framework version","migrated to new API","cleaned up legacy code","consolidated services","improved modularity","reduced coupling","enhanced maintainability","documented codebase","created runbook"],ge=(0,r.useCallback)(async()=>{const e=(await B.getEntries()).sort((e,t)=>{if(Math.abs(e.timestamp.getTime()-t.timestamp.getTime())<2e3){if("system"===e.type&&"system"!==t.type)return 1;if("system"!==e.type&&"system"===t.type)return-1}return e.timestamp.getTime()-t.timestamp.getTime()});t(e),H(e),w.current=!1},[]),me=(0,r.useCallback)(e=>{if(0===e.length)return[];const t=[...e].sort((e,t)=>e.timestamp.getTime()-t.timestamp.getTime()),n=[];let o="";return t.forEach(e=>{const t=(0,b.default)(e.timestamp,"yyyy-MM-dd");t!==o&&(n.push({type:"dateSeparator",date:t,id:`date-${t}`}),o=t),n.push(e)}),n},[]);(0,r.useEffect)(()=>{if(!E)return void H(e);let t=e;if(O){const e=new Date(O);e.setHours(0,0,0,0),t=t.filter(t=>{if("system"===t.type)return!1;const n=new Date(t.timestamp);return n.setHours(0,0,0,0),n.getTime()===e.getTime()})}if(A.trim()){const e=A.toLowerCase().trim();t=t.filter(t=>"system"!==t.type&&(!!t.text.toLowerCase().includes(e)||!!t.type.toLowerCase().includes(e)))}H(t)},[A,e,O,E]);const ye=(0,r.useCallback)(async()=>{try{const e=await B.getSettings();e&&(s(e.isMarkdownEnabled),S(e.enterToSend),I(e.layoutStyle||"chat"))}catch(e){console.error("Error loading settings:",e)}},[]),he=(0,r.useCallback)(async()=>{try{const[e,t]=await Promise.all([B.getExpenses(),B.getActionItems()]);let n=!1;const o=t.map(e=>e.dueDate?e:(n=!0,Object.assign({},e,{dueDate:e.createdAt||new Date})));n?(await B.saveActionItems(o),Y(o)):Y(t),_(e)}catch(e){console.error("Error loading expenses and action items:",e)}},[]);(0,r.useEffect)(()=>{ge(),ye(),he()},[ge,ye,he]);const pe=e=>{alert(e)},xe=async()=>{const e=n.trim();if(e)try{let t=e;const n=v.detectActionItem(e);(n||ee)&&(t=e.replace(/^\s*\.\s*/,"\u2705 "));const r={id:J(),text:t,timestamp:new Date,type:"log",isMarkdown:i};await B.addEntry(r);const a=v.detectExpense(e);if(a||Q){const t=v.extractExpenseInfo(e,r.id);t?(t.autoDetected=a&&!Q,await B.addExpense(t),await Te(r.id,"expense")):Q&&y.default.alert("No Amount Found","Please include a numeric amount in your entry (e.g., 150, Rs200, $50)")}if(n||ee){let t;if(ee&&!n){const n=v.extractDueDate(e);t={id:J(),entryId:r.id,title:e,completed:!1,createdAt:new Date,dueDate:n,autoDetected:!1}}else t=v.extractActionItem(e,r.id),t&&(t.autoDetected=n&&!ee);t&&(await B.addActionItem(t),await Te(r.id,"action"))}if(await ge(),await he(),"chat"===D){let e="",t=!1,n=!1;const o=await B.getExpenses().then(e=>e.find(e=>e.entryId===r.id));if(o){t=!0;e=`\ud83d\udcb0 ${o.autoDetected?"Auto-categorized":"Manually categorized"} as Expense: ${v.formatCurrency(o.amount,o.currency)}`,o.category&&(e+=` (${o.category})`)}if(!t){const t=await B.getActionItems().then(e=>e.find(e=>e.entryId===r.id));if(t){n=!0;e=`\u2705 ${t.autoDetected?"Auto-categorized":"Manually categorized"} as Task: ${t.title}`}}if(t||n||(e="\u2713 Got it!"),e){const t={id:J(),text:e,timestamp:new Date(Date.now()+100),type:"system",isMarkdown:!1};await B.addEntry(t),await ge()}}o(""),Z(!1),te(!1),setTimeout(()=>{m.current?.scrollToOffset({offset:0,animated:!0})},100),setTimeout(()=>{j.current&&j.current.focus()},150)}catch(t){console.error("Error processing message:",t),pe("Failed to process message")}},be=e=>{const t=[{text:"Edit Entry",onPress:()=>ke(e)}];"expense"!==e.type&&t.push({text:"Mark as Expense",onPress:()=>je(e)}),"action"!==e.type&&t.push({text:"Mark as Action Item",onPress:()=>we(e)}),"log"!==e.type&&t.push({text:"Remove Category",onPress:()=>Ce(e)}),t.push({text:"Delete Entry",onPress:()=>Se(e),style:"destructive"},{text:"Cancel",style:"cancel"}),y.default.alert("Entry Options","What would you like to do with this entry?",t)},je=async e=>{if("expense"===e.type)return;const t=v.extractExpenseInfo(e.text,e.id);t?(t.autoDetected=!1,await B.addExpense(t),await Te(e.id,"expense"),await he()):y.default.alert("Cannot Extract Expense","Could not find amount information in this entry. Please ensure it contains a monetary value.")},we=async e=>{if("action"===e.type)return;let t=v.extractActionItem(e.text,e.id);t?t.autoDetected=!1:t={id:J(),entryId:e.id,title:e.text.replace(/^\u2705\s*/,""),completed:!1,createdAt:new Date,autoDetected:!1},await B.addActionItem(t),await Te(e.id,"action"),await he()},Ce=async e=>{try{if("expense"===e.type){const t=$.find(t=>t.entryId===e.id);t&&await B.deleteExpense(t.id)}else if("action"===e.type){const t=q.find(t=>t.entryId===e.id);t&&await B.deleteActionItem(t.id)}await Te(e.id,"log"),await he(),pe("Category removed")}catch(t){console.error("Error removing category:",t),pe("Failed to remove category")}},Se=async e=>{confirm("Are you sure you want to delete this entry?")&&await(async()=>{try{if("expense"===e.type){const t=$.find(t=>t.entryId===e.id);t&&await B.deleteExpense(t.id)}else if("action"===e.type){const t=q.find(t=>t.entryId===e.id);t&&await B.deleteActionItem(t.id)}const t=(await B.getEntries()).filter(t=>t.id!==e.id);await B.saveEntries(t),await ge(),await he()}catch(t){console.error("Error deleting entry:",t)}})()},ke=e=>{if(oe(e),ae(e.text.replace(/^\u2705\s*/,"")),"expense"===e.type){const t=$.find(t=>t.entryId===e.id);t&&(se(t.amount.toString()),de(t.category||""))}if("action"===e.type){const t=q.find(t=>t.entryId===e.id);t&&t.dueDate?ue(new Date(t.dueDate)):ue(new Date)}},Te=async(e,t)=>{try{const n=(await B.getEntries()).map(n=>n.id===e?Object.assign({},n,{type:t}):n);await B.saveEntries(n),await ge()}catch(n){console.error("Error updating entry type:",n),pe("Failed to update entry type")}};return(0,W.jsxs)(x.SafeAreaView,{style:G.container,children:[(0,W.jsxs)(c.default,{style:[G.header,{zIndex:1e4}],children:[(0,W.jsx)(a.default,{style:G.headerTitle,children:"Daily Journal"}),(0,W.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center",zIndex:10001},children:[(0,W.jsx)(f.default,{style:[G.settingsButton,{marginRight:8,zIndex:10004}],onPress:()=>{l>=fe.length&&d(0),o(fe[l]),d(l+1)},children:(0,W.jsx)(a.default,{style:G.settingsButtonText,children:"\ud83e\uddea"})}),(0,W.jsx)(f.default,{style:[G.settingsButton,{marginRight:8,zIndex:10002}],onPress:()=>{R(!E)},children:(0,W.jsx)(a.default,{style:G.settingsButtonText,children:"\ud83d\udd0d"})}),(0,W.jsx)(f.default,{style:[G.settingsButton,{zIndex:10003}],onPress:()=>{T(!0)},children:(0,W.jsx)(a.default,{style:G.settingsButtonText,children:"\u2699\ufe0f"})})]})]}),E&&(0,W.jsxs)(c.default,{style:G.searchContainer,children:[(0,W.jsxs)(c.default,{style:G.searchSection,children:[(0,W.jsx)(a.default,{style:G.searchLabel,children:"Search by Text:"}),(0,W.jsxs)(c.default,{style:G.searchRow,children:[(0,W.jsx)(u.default,{style:G.searchInput,placeholder:"Search entries...",value:A,onChangeText:z,autoCapitalize:"none",clearButtonMode:"while-editing"}),A.length>0&&(0,W.jsx)(f.default,{style:G.clearButton,onPress:()=>z(""),children:(0,W.jsx)(a.default,{style:G.clearButtonText,children:"\u2715"})})]})]}),(0,W.jsxs)(c.default,{style:G.dateSection,children:[(0,W.jsx)(a.default,{style:G.searchLabel,children:"Filter by Date:"}),(0,W.jsxs)(c.default,{style:G.datePickerButtonLarge,children:[(0,W.jsx)(a.default,{style:G.datePickerIconLarge,children:"\ud83d\udcc5"}),(0,W.jsx)("input",{type:"date",style:{flex:1,border:"none",background:"transparent",fontSize:16,color:"#333",outline:"none",cursor:"pointer"},onChange:e=>{e.target.value?V(new Date(e.target.value)):V(null)},value:O?(0,b.default)(O,"yyyy-MM-dd"):"",placeholder:"Select Date"}),O&&(0,W.jsx)(f.default,{onPress:e=>{e.stopPropagation(),V(null)},style:G.datePickerClear,children:(0,W.jsx)(a.default,{style:G.datePickerClearText,children:"\u2715"})})]})]}),(A||O)&&(0,W.jsx)(f.default,{style:G.clearAllButton,onPress:()=>{z(""),V(null)},children:(0,W.jsx)(a.default,{style:G.clearAllButtonText,children:"Clear All Filters"})})]}),(0,W.jsx)(g.default,{ref:m,data:me(E?P:e).reverse(),renderItem:({item:e})=>{if("type"in e&&"dateSeparator"===e.type)return(e=>{const t=new Date(e),n=new Date,o=new Date(n.getTime()-864e5);let r;return r=(0,b.default)(t,"yyyy-MM-dd")===(0,b.default)(n,"yyyy-MM-dd")?"Today":(0,b.default)(t,"yyyy-MM-dd")===(0,b.default)(o,"yyyy-MM-dd")?"Yesterday":(0,b.default)(t,"EEEE, MMMM d, yyyy"),(0,W.jsxs)(c.default,{style:G.dateSeparator,children:[(0,W.jsx)(c.default,{style:G.dateSeparatorLine}),(0,W.jsx)(a.default,{style:G.dateSeparatorText,children:r}),(0,W.jsx)(c.default,{style:G.dateSeparatorLine})]})})(e.date);const t=e,n="expense"===t.type?$.find(e=>e.entryId===t.id):void 0,o="action"===t.type?q.find(e=>e.entryId===t.id):void 0;switch(D){case"cards":return((e,t,n)=>(0,W.jsx)(c.default,{style:K.cardContainer,children:(0,W.jsx)(M,{entry:e,onLongPress:be,onEdit:ke,onDelete:Se,markdownStyles:X,expense:t,actionItem:n})}))(t,n,o);case"list":return((e,t,n)=>(0,W.jsx)(c.default,{style:K.listContainer,children:(0,W.jsx)(M,{entry:e,onLongPress:be,onEdit:ke,onDelete:Se,markdownStyles:X,expense:t,actionItem:n})}))(t,n,o);case"timeline":return((e,t,n)=>(0,W.jsxs)(c.default,{style:K.timelineContainer,children:[(0,W.jsxs)(c.default,{style:K.timelineLeft,children:[(0,W.jsx)(c.default,{style:K.timelineDot}),(0,W.jsx)(c.default,{style:K.timelineLine})]}),(0,W.jsx)(c.default,{style:K.timelineContent,children:(0,W.jsx)(M,{entry:e,onLongPress:be,onEdit:ke,onDelete:Se,markdownStyles:X,expense:t,actionItem:n})})]}))(t,n,o);case"magazine":return((e,t,n)=>(0,W.jsx)(c.default,{style:K.magazineContainer,children:(0,W.jsx)(M,{entry:e,onLongPress:be,onEdit:ke,onDelete:Se,markdownStyles:X,expense:t,actionItem:n})}))(t,n,o);case"minimal":return"system"===t.type?null:((e,t,n)=>(0,W.jsx)(L,{item:e,expense:t,actionItem:n,onEdit:ke,onDelete:Se,markdownStyles:X,layoutStyles:K}))(t,n,o);default:return((e,t,n)=>(0,W.jsx)(M,{entry:e,onLongPress:be,onEdit:ke,onDelete:Se,markdownStyles:X,expense:t,actionItem:n}))(t,n,o)}},keyExtractor:e=>("type"in e&&e.type,e.id),style:[G.messagesList,(e=>{switch(e){case"cards":return{paddingHorizontal:8};case"list":case"minimal":return{paddingHorizontal:0,backgroundColor:"#fff"};case"timeline":return{paddingHorizontal:0,backgroundColor:"#f8f9fa"};case"magazine":return{paddingHorizontal:0,backgroundColor:"#f5f5f5"};default:return{paddingHorizontal:16}}})(D)],showsVerticalScrollIndicator:!1,inverted:!0,maintainVisibleContentPosition:{minIndexForVisible:0},ListEmptyComponent:()=>{if(E&&(A.trim()||O)){let e="";return A.trim()&&O?e=`No entries found matching "${A}" on ${(0,b.default)(O,"MMM dd, yyyy")}`:A.trim()?e=`No entries found matching "${A}"`:O&&(e=`No entries found on ${(0,b.default)(O,"MMM dd, yyyy")}`),(0,W.jsx)(c.default,{style:{padding:20,alignItems:"center",transform:[{scaleY:-1}]},children:(0,W.jsx)(a.default,{style:{color:"#666",fontSize:16,textAlign:"center"},children:e})})}return null}}),(0,W.jsxs)(h.default,{behavior:"height",style:[G.inputContainer,{zIndex:1e4}],children:[(0,W.jsxs)(c.default,{style:G.quickActionsRow,children:[(0,W.jsx)(f.default,{style:[G.quickActionButton,Q&&G.quickActionButtonActive],onPress:()=>{Z(!Q),Q||te(!1)},children:(0,W.jsx)(a.default,{style:[G.quickActionText,Q&&G.quickActionTextActive],children:"\ud83d\udcb0"})}),(0,W.jsx)(f.default,{style:[G.quickActionButton,ee&&G.quickActionButtonActive],onPress:()=>{te(!ee),ee||Z(!1)},children:(0,W.jsx)(a.default,{style:[G.quickActionText,ee&&G.quickActionTextActive],children:"\u2705"})})]}),(0,W.jsxs)(c.default,{style:G.inputRow,children:[(0,W.jsx)(u.default,{ref:j,style:G.textInput,value:n,onChangeText:o,placeholder:Q?"Type expense (e.g., 150 for coffee)...":ee?"Type task description...":i?"Type a message (Markdown supported)...":"Type a message...",multiline:!0,maxLength:1e3,onSubmitEditing:C?xe:void 0,blurOnSubmit:C,returnKeyType:C?"send":"default"}),(0,W.jsx)(f.default,{style:[G.sendButton,!n.trim()&&G.sendButtonDisabled],onPress:xe,disabled:!n.trim(),children:(0,W.jsx)(a.default,{style:{color:"#fff",fontSize:16},children:"\u2192"})})]})]}),k&&(0,W.jsx)(p.default,{visible:k,animationType:"slide",presentationStyle:"formSheet",children:(0,W.jsx)(U,{onClose:()=>{T(!1),ye()},onExportText:async()=>{try{const e=await B.getEntries(),t=await B.getExpenses(),n=await B.getActionItems();let o="=".repeat(50)+"\n";o+="DAILYTRACKER EXPORT\n",o+=(0,b.default)(new Date,"MMMM dd, yyyy - hh:mm a")+"\n",o+="=".repeat(50)+"\n\n",e.forEach(e=>{if("system"===e.type)return;const r=(0,b.default)(new Date(e.timestamp),"MMM dd, yyyy - hh:mm a"),a=t.find(t=>t.entryId===e.id),i=n.find(t=>t.entryId===e.id);let s="\ud83d\udcdd";"expense"===e.type||a?s="\ud83d\udcb0":("action"===e.type||i)&&(s="\u2705"),o+=`${s} ${r}\n`,o+=`${e.text}\n`,a&&(o+=`   Amount: ${v.formatCurrency(a.amount,a.currency)}`,a.category&&(o+=` | Category: ${a.category}`),o+="\n"),i&&(o+=`   Task: ${i.title}\n`,o+=`   Status: ${i.completed?"\u2713 Completed":"\u25cb Pending"}\n`),o+="\n"+"-".repeat(50)+"\n\n"});{const e=new Blob([o],{type:"text/plain"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`dailytracker-export-${(0,b.default)(new Date,"yyyy-MM-dd")}.txt`,n.click(),URL.revokeObjectURL(t),pe("Exported successfully")}}catch(e){console.error("Export error:",e),pe("Export failed")}},onExportJSON:async()=>{try{const e=await B.getEntries(),t=await B.getExpenses(),n=await B.getActionItems(),o={exportDate:(new Date).toISOString(),version:"1.0",entries:e,expenses:t,actionItems:n},r=JSON.stringify(o,null,2);{const e=new Blob([r],{type:"application/json"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`dailytracker-export-${(0,b.default)(new Date,"yyyy-MM-dd")}.json`,n.click(),URL.revokeObjectURL(t),pe("Exported successfully")}}catch(e){console.error("Export error:",e),pe("Export failed")}},onImport:async()=>{try{0;const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=async e=>{try{const t=JSON.parse(e.target.result);if(!t.entries||!Array.isArray(t.entries))return void pe("Invalid file format");if(!window.confirm(`Import ${t.entries.length} entries? This will merge with existing data.`))return;const n=await B.getEntries(),o=await B.getExpenses(),r=await B.getActionItems(),a=new Set(n.map(e=>e.id)),i=t.entries.filter(e=>!a.has(e.id)),s=new Set(o.map(e=>e.id)),l=(t.expenses||[]).filter(e=>!s.has(e.id)),d=new Set(r.map(e=>e.id)),c=(t.actionItems||[]).filter(e=>!d.has(e.id));await B.saveEntries([...n,...i]),await B.saveExpenses([...o,...l]),await B.saveActionItems([...r,...c]),await ge(),pe(`Imported ${i.length} new entries`)}catch(t){console.error("Import error:",t),pe("Import failed - invalid file")}},n.readAsText(t)},e.click()}catch(e){console.error("Import error:",e),pe("Import failed")}},onBackup:async()=>{try{const e=await B.getEntries(),t=await B.getExpenses(),n=await B.getActionItems(),o={timestamp:(new Date).toISOString(),entries:e,expenses:t,actionItems:n};await B.saveBackup(o),pe("Backup created successfully")}catch(e){console.error("Backup error:",e),pe("Backup failed")}},onRestore:async()=>{try{const e=await B.getBackup();if(!e)return void pe("No backup found");if(!window.confirm(`Restore backup from ${(0,b.default)(new Date(e.timestamp),"MMM dd, yyyy hh:mm a")}? This will replace current data.`))return;await B.saveEntries(e.entries),await B.saveExpenses(e.expenses),await B.saveActionItems(e.actionItems),await ge(),pe("Restored successfully")}catch(e){console.error("Restore error:",e),pe("Restore failed")}}})}),ne&&(0,W.jsx)(p.default,{visible:!!ne,animationType:"slide",transparent:!0,onRequestClose:()=>{oe(null),ae(""),se(""),de(""),ue(null)},children:(0,W.jsx)(c.default,{style:G.editModalOverlay,children:(0,W.jsxs)(c.default,{style:G.editModalContent,children:[(0,W.jsx)(a.default,{style:G.editModalTitle,children:"Edit Entry"}),(0,W.jsx)(a.default,{style:G.editLabel,children:"Text:"}),(0,W.jsx)(c.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:8},children:(0,W.jsx)(f.default,{style:[G.markdownToggle,ne.isMarkdown&&G.markdownToggleActive],onPress:()=>oe(Object.assign({},ne,{isMarkdown:!ne.isMarkdown})),children:(0,W.jsx)(a.default,{style:G.markdownToggleText,children:ne.isMarkdown?"\u2705 Markdown":"\u274c Plain Text"})})}),(0,W.jsx)(u.default,{style:G.editTextInput,value:re,onChangeText:ae,placeholder:"Entry text",multiline:!0,maxLength:1e3}),(0,W.jsx)(a.default,{style:G.editLabel,children:"Category:"}),(0,W.jsxs)(c.default,{style:G.categoryButtons,children:[(0,W.jsx)(f.default,{style:[G.categoryButton,"log"===ne.type&&G.categoryButtonActive],onPress:async()=>{"log"!==ne.type&&(await Ce(ne),oe(Object.assign({},ne,{type:"log"})))},children:(0,W.jsx)(a.default,{style:G.categoryButtonText,children:"\ud83d\udcdd Log"})}),(0,W.jsx)(f.default,{style:[G.categoryButton,"expense"===ne.type&&G.categoryButtonActive],onPress:async()=>{if("expense"!==ne.type){"action"===ne.type&&await Ce(ne);const e=v.extractExpenseInfo(re,ne.id);e?(se(e.amount.toString()),de(e.category||"")):(se(""),de("")),oe(Object.assign({},ne,{type:"expense"}))}},children:(0,W.jsx)(a.default,{style:G.categoryButtonText,children:"\ud83d\udcb0 Expense"})}),(0,W.jsx)(f.default,{style:[G.categoryButton,"action"===ne.type&&G.categoryButtonActive],onPress:async()=>{"action"!==ne.type&&("expense"===ne.type&&(await Ce(ne),se(""),de("")),oe(Object.assign({},ne,{type:"action"})))},children:(0,W.jsx)(a.default,{style:G.categoryButtonText,children:"\u2705 Task"})})]}),"expense"===ne.type&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(a.default,{style:G.editLabel,children:"Amount:"}),(0,W.jsx)(u.default,{style:G.editInput,value:ie,onChangeText:se,placeholder:"Enter amount",keyboardType:"decimal-pad"}),(0,W.jsx)(a.default,{style:G.editLabel,children:"Category (optional):"}),(0,W.jsx)(u.default,{style:G.editInput,value:le,onChangeText:de,placeholder:"Food, Transportation, etc."})]}),"action"===ne.type&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(a.default,{style:G.editLabel,children:"Due Date:"}),(0,W.jsx)(c.default,{style:{marginBottom:12},children:(0,W.jsx)("input",{type:"date",style:{width:"100%",padding:12,fontSize:16,borderRadius:8,border:"1px solid #ddd",backgroundColor:"#f8f8f8"},onChange:e=>{e.target.value&&ue(new Date(e.target.value))},value:ce?(0,b.default)(ce,"yyyy-MM-dd"):""})})]}),(0,W.jsxs)(c.default,{style:G.editModalButtons,children:[(0,W.jsx)(f.default,{style:[G.editModalButton,G.editModalButtonCancel],onPress:()=>{oe(null),ae(""),se(""),de(""),ue(null)},children:(0,W.jsx)(a.default,{style:G.editModalButtonText,children:"Cancel"})}),(0,W.jsx)(f.default,{style:[G.editModalButton,G.editModalButtonSave],onPress:async()=>{if(ne&&re.trim()){if("expense"===ne.type){if(!ie||!ie.trim())return void y.default.alert("Amount Required","Please enter an amount for the expense");const e=parseFloat(ie);if(isNaN(e)||e<=0)return void y.default.alert("Invalid Amount","Please enter a valid amount greater than 0")}try{const e=(await B.getEntries()).map(e=>e.id===ne.id?Object.assign({},e,{text:re.trim(),type:ne.type,isMarkdown:ne.isMarkdown}):e);if(await B.saveEntries(e),"expense"===ne.type){const e=$.find(e=>e.entryId===ne.id);if(e&&ie){const t=parseFloat(ie);!isNaN(t)&&t>0&&await B.updateExpense(e.id,{amount:t,category:le||e.category,description:re.trim()})}}if("action"===ne.type){const e=v.extractDueDate(re.trim())||ce||new Date;let t=q.find(e=>e.entryId===ne.id);if(t)await B.updateActionItem(t.id,{title:re.trim(),dueDate:e});else{const t={id:J(),entryId:ne.id,title:re.trim(),completed:!1,createdAt:new Date,dueDate:e,autoDetected:!1};await B.addActionItem(t)}}await ge(),await he(),oe(null),ae(""),se(""),de(""),ue(null)}catch(e){console.error("Error updating entry:",e)}}},children:(0,W.jsx)(a.default,{style:[G.editModalButtonText,{color:"#fff"}],children:"Save"})})]})]})})}),F&&(0,W.jsx)(p.default,{visible:F,animationType:"fade",transparent:!0,onRequestClose:()=>N(!1),children:(0,W.jsx)(f.default,{style:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.6)",justifyContent:"center",alignItems:"center",padding:20},activeOpacity:1,onPress:()=>N(!1),children:(0,W.jsx)(f.default,{activeOpacity:1,onPress:e=>e.stopPropagation(),style:{width:"100%",maxWidth:400},children:(0,W.jsxs)(c.default,{style:G.datePickerContent,children:[(0,W.jsxs)(c.default,{style:G.datePickerHeader,children:[(0,W.jsx)(a.default,{style:G.datePickerTitle,children:"Select Date"}),(0,W.jsx)(f.default,{onPress:()=>N(!1),style:G.datePickerClose,children:(0,W.jsx)(a.default,{style:G.datePickerCloseText,children:"\u2715"})})]}),(0,W.jsxs)(c.default,{style:G.datePickerQuickButtons,children:[(0,W.jsx)(f.default,{style:G.quickDateButton,onPress:()=>{V(new Date),N(!1)},children:(0,W.jsx)(a.default,{style:G.quickDateButtonText,children:"Today"})}),(0,W.jsx)(f.default,{style:G.quickDateButton,onPress:()=>{const e=new Date;e.setDate(e.getDate()-1),V(e),N(!1)},children:(0,W.jsx)(a.default,{style:G.quickDateButtonText,children:"Yesterday"})}),(0,W.jsx)(f.default,{style:G.quickDateButton,onPress:()=>{const e=new Date;e.setDate(e.getDate()-7),V(e),N(!1)},children:(0,W.jsx)(a.default,{style:G.quickDateButtonText,children:"Last Week"})})]}),(0,W.jsxs)(c.default,{style:{marginTop:16},children:[(0,W.jsx)(a.default,{style:{fontSize:13,color:"#666",marginBottom:8,fontWeight:"600"},children:"Or pick a specific date:"}),(0,W.jsx)("input",{type:"date",style:{width:"100%",padding:12,fontSize:16,borderRadius:8,border:"1px solid #ddd",boxSizing:"border-box"},onChange:e=>{e.target.value&&(V(new Date(e.target.value)),N(!1))},defaultValue:O?(0,b.default)(O,"yyyy-MM-dd"):""})]})]})})})})]})},G=m.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:12,paddingVertical:8,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},headerTitle:{fontSize:20,fontWeight:"bold",color:"#333"},searchContainer:{paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},searchSection:{marginBottom:12},dateSection:{marginBottom:8},searchLabel:{fontSize:13,fontWeight:"600",color:"#666",marginBottom:6},searchRow:{flexDirection:"row",alignItems:"center"},searchInput:{flex:1,height:40,paddingHorizontal:12,backgroundColor:"#f8f8f8",borderRadius:8,fontSize:16,color:"#333",borderWidth:1,borderColor:"#e0e0e0"},datePickerButtonLarge:{flexDirection:"row",alignItems:"center",backgroundColor:"#f8f8f8",borderRadius:8,borderWidth:1,borderColor:"#e0e0e0",paddingHorizontal:12,paddingVertical:10,height:40},datePickerIconLarge:{fontSize:20,marginRight:8},datePickerButtonLabel:{flex:1,fontSize:16,color:"#333"},datePickerClear:{width:20,height:20,borderRadius:10,backgroundColor:"#ccc",alignItems:"center",justifyContent:"center"},datePickerClearText:{fontSize:12,color:"#666",fontWeight:"bold"},clearButton:{marginLeft:8,width:24,height:24,borderRadius:12,backgroundColor:"#ccc",alignItems:"center",justifyContent:"center"},clearAllButton:{backgroundColor:"#ff6b6b",borderRadius:8,paddingVertical:8,alignItems:"center",marginTop:4},clearAllButtonText:{color:"#fff",fontSize:14,fontWeight:"600"},clearButtonText:{fontSize:12,color:"#666",fontWeight:"bold"},settingsButton:{paddingHorizontal:8,paddingVertical:6,borderRadius:16,backgroundColor:"#f0f0f0",marginLeft:8},settingsButtonText:{fontSize:16},messagesList:{flex:1,paddingHorizontal:8,paddingVertical:4},inputContainer:{paddingHorizontal:8,paddingVertical:4,paddingBottom:4,backgroundColor:"#fff",borderTopWidth:1,borderTopColor:"#e0e0e0"},quickActionsRow:{flexDirection:"row",marginBottom:4,gap:4},quickActionButton:{paddingHorizontal:10,paddingVertical:4,borderRadius:16,backgroundColor:"#f0f0f0",borderWidth:2,borderColor:"#e0e0e0"},quickActionButtonActive:{backgroundColor:"#007AFF",borderColor:"#0056b3"},quickActionText:{fontSize:18},quickActionTextActive:{transform:[{scale:1.1}]},inputRow:{flexDirection:"row",alignItems:"flex-end"},textInput:{flex:1,borderWidth:1,borderColor:"#e0e0e0",borderRadius:20,paddingHorizontal:16,paddingVertical:12,marginRight:12,maxHeight:100,fontSize:16,backgroundColor:"#f8f8f8"},sendButton:{backgroundColor:"#007AFF",width:44,height:44,borderRadius:22,justifyContent:"center",alignItems:"center"},sendButtonDisabled:{backgroundColor:"#ccc"},editModalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},editModalContent:{backgroundColor:"#fff",borderRadius:12,padding:20,width:"100%",maxWidth:500},editModalTitle:{fontSize:20,fontWeight:"bold",marginBottom:16,color:"#333"},editLabel:{fontSize:14,fontWeight:"600",color:"#666",marginTop:12,marginBottom:6},editInput:{borderWidth:1,borderColor:"#ddd",borderRadius:8,padding:12,fontSize:16,backgroundColor:"#f9f9f9"},editTextInput:{borderWidth:1,borderColor:"#ddd",borderRadius:8,padding:12,fontSize:16,backgroundColor:"#f9f9f9",minHeight:80,maxHeight:200,textAlignVertical:"top"},editModalButtons:{flexDirection:"row",justifyContent:"flex-end",marginTop:20,gap:12},editModalButton:{paddingHorizontal:20,paddingVertical:10,borderRadius:8,minWidth:80,alignItems:"center"},editModalButtonCancel:{backgroundColor:"#f0f0f0"},editModalButtonSave:{backgroundColor:"#007AFF"},editModalButtonText:{fontSize:16,fontWeight:"600",color:"#333"},categoryButtons:{flexDirection:"row",gap:8,marginBottom:12},categoryButton:{flex:1,paddingVertical:8,paddingHorizontal:12,borderRadius:8,backgroundColor:"#f0f0f0",borderWidth:2,borderColor:"#e0e0e0",alignItems:"center"},categoryButtonActive:{backgroundColor:"#007AFF",borderColor:"#0056b3"},categoryButtonText:{fontSize:14,fontWeight:"600",color:"#333"},markdownToggle:{paddingVertical:6,paddingHorizontal:12,borderRadius:6,backgroundColor:"#f0f0f0",borderWidth:1,borderColor:"#e0e0e0"},markdownToggleActive:{backgroundColor:"#e8f5e8",borderColor:"#4caf50"},markdownToggleText:{fontSize:12,fontWeight:"600",color:"#333"},dateSeparator:{flexDirection:"row",alignItems:"center",marginVertical:16,paddingHorizontal:8},dateSeparatorLine:{flex:1,height:1,backgroundColor:"#e0e0e0"},dateSeparatorText:{marginHorizontal:12,fontSize:14,fontWeight:"600",color:"#666",backgroundColor:"#f5f5f5",paddingHorizontal:8,paddingVertical:4,borderRadius:12}}),K=m.default.create({cardContainer:{backgroundColor:"#fff",borderRadius:12,marginVertical:6,marginHorizontal:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,overflow:"hidden"},cardHeader:{flexDirection:"row",justifyContent:"space-between",paddingHorizontal:16,paddingVertical:8,backgroundColor:"#f8f9fa",borderBottomWidth:1,borderBottomColor:"#e9ecef"},cardDate:{fontSize:14,fontWeight:"600",color:"#495057"},cardTime:{fontSize:12,color:"#6c757d"},cardContent:{padding:16},cardText:{fontSize:16,lineHeight:22,color:"#212529",marginBottom:8},expenseTag:{backgroundColor:"#d4edda",borderRadius:12,paddingHorizontal:8,paddingVertical:4,alignSelf:"flex-start",marginTop:8},expenseText:{fontSize:12,color:"#155724",fontWeight:"500"},actionTag:{backgroundColor:"#cce5ff",borderRadius:12,paddingHorizontal:8,paddingVertical:4,alignSelf:"flex-start",marginTop:8},actionText:{fontSize:12,color:"#004085",fontWeight:"500"},listContainer:{flexDirection:"row",paddingVertical:12,paddingHorizontal:16,borderBottomWidth:1,borderBottomColor:"#e9ecef"},listLeft:{alignItems:"center",marginRight:16,width:60},listTime:{fontSize:12,color:"#6c757d",fontWeight:"500",marginBottom:4},listIndicator:{width:8,height:8,borderRadius:4,backgroundColor:"#007bff"},listContent:{flex:1},listText:{fontSize:16,lineHeight:22,color:"#212529",marginBottom:6},listMeta:{flexDirection:"row",gap:12},listExpense:{fontSize:12,color:"#28a745",fontWeight:"500"},listAction:{fontSize:12,color:"#007bff",fontWeight:"500"},timelineContainer:{flexDirection:"row",paddingVertical:16,paddingHorizontal:16},timelineLeft:{alignItems:"center",marginRight:16,width:20},timelineDot:{width:12,height:12,borderRadius:6,backgroundColor:"#007bff",zIndex:1},timelineLine:{width:2,flex:1,backgroundColor:"#dee2e6",marginTop:4},timelineContent:{flex:1,backgroundColor:"#fff",borderRadius:8,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},timelineDate:{fontSize:12,color:"#6c757d",fontWeight:"500",marginBottom:8},timelineText:{fontSize:16,lineHeight:22,color:"#212529"},timelineTags:{flexDirection:"row",marginTop:12,gap:8},timelineExpense:{fontSize:12,color:"#28a745",backgroundColor:"#d4edda",paddingHorizontal:8,paddingVertical:2,borderRadius:8},timelineAction:{fontSize:12,color:"#007bff",backgroundColor:"#cce5ff",paddingHorizontal:8,paddingVertical:2,borderRadius:8},magazineContainer:{backgroundColor:"#fff",marginVertical:8,marginHorizontal:16,borderRadius:8,overflow:"hidden",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},magazineHeader:{backgroundColor:"#343a40",paddingHorizontal:20,paddingVertical:12},magazineDate:{fontSize:14,color:"#fff",fontWeight:"600",textTransform:"uppercase",letterSpacing:.5},magazineBody:{paddingHorizontal:20,paddingVertical:16},magazineText:{fontSize:17,lineHeight:26,color:"#212529",fontFamily:"serif"},magazineFooter:{flexDirection:"row",paddingHorizontal:20,paddingBottom:16,gap:16},magazineExpenseBlock:{flex:1},magazineExpenseLabel:{fontSize:10,color:"#6c757d",fontWeight:"600",textTransform:"uppercase",marginBottom:2},magazineExpenseAmount:{fontSize:16,color:"#28a745",fontWeight:"600"},magazineActionBlock:{flex:1},magazineActionLabel:{fontSize:10,color:"#6c757d",fontWeight:"600",textTransform:"uppercase",marginBottom:2},magazineActionText:{fontSize:16,color:"#007bff",fontWeight:"600"},minimalContainer:{flexDirection:"row",paddingVertical:0,paddingHorizontal:20,alignItems:"center",justifyContent:"space-between",width:"100%"},minimalContent:{flex:1,marginRight:16,flexDirection:"row",alignItems:"center",minWidth:0,maxWidth:"100%",overflow:"hidden"},minimalText:{fontSize:16,color:"#212529"},minimalMeta:{flexDirection:"row",alignItems:"center",gap:6,flexShrink:0},minimalTime:{fontSize:12,color:"#9ca3af"},minimalExpense:{fontSize:12,color:"#28a745"},minimalAction:{fontSize:12,color:"#007bff"}}),X=m.default.create({body:{fontSize:16,color:"#333",lineHeight:20},heading1:{fontSize:20,fontWeight:"bold",marginTop:12,marginBottom:12,paddingVertical:4},heading2:{fontSize:18,fontWeight:"bold",marginBottom:6},strong:{fontWeight:"bold"},em:{fontStyle:"italic"},code_inline:{backgroundColor:"#f0f0f0",paddingHorizontal:4,paddingVertical:2,borderRadius:3,fontFamily:"monospace"},datePickerContent:{backgroundColor:"#fff",borderRadius:16,padding:24,width:"100%",shadowColor:"#000",shadowOffset:{width:0,height:8},shadowOpacity:.4,shadowRadius:16,elevation:20},datePickerHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},datePickerTitle:{fontSize:20,fontWeight:"bold",color:"#333"},datePickerClose:{width:32,height:32,borderRadius:16,backgroundColor:"#f0f0f0",alignItems:"center",justifyContent:"center"},datePickerCloseText:{fontSize:18,color:"#666",fontWeight:"bold"},datePickerQuickButtons:{flexDirection:"row",justifyContent:"space-around",marginBottom:16},quickDateButton:{paddingHorizontal:16,paddingVertical:10,borderRadius:20,backgroundColor:"#007AFF",flex:1,marginHorizontal:4,alignItems:"center"},quickDateButtonText:{color:"#fff",fontSize:14,fontWeight:"600"},mobileDatePicker:{padding:20,alignItems:"center"},mobileDatePickerText:{fontSize:14,color:"#666",textAlign:"center"}});var Q=n(9320),Z=n(1862);const ee=({item:e,onToggleComplete:t,onEdit:n,onDelete:o})=>(0,W.jsxs)(c.default,{style:[oe.itemCard,e.completed&&oe.completedCard],children:[(0,W.jsxs)(f.default,{style:oe.itemHeader,onPress:()=>t(e.id),activeOpacity:.7,children:[(0,W.jsx)(Q.default,{name:e.completed?"checkbox":"checkbox-outline",size:24,color:e.completed?"#4caf50":"#666"}),(0,W.jsx)(c.default,{style:{flex:1,marginLeft:8},children:(0,W.jsx)(z.default,{style:{body:{fontSize:16,color:e.completed?"#999":"#333",textDecorationLine:e.completed?"line-through":"none"}},children:e.title})})]}),e.description&&e.description!==e.title&&(0,W.jsx)(a.default,{style:[oe.itemDescription,e.completed&&oe.completedText],children:e.description}),(0,W.jsxs)(c.default,{style:oe.itemFooter,children:[(0,W.jsxs)(c.default,{children:[(0,W.jsxs)(a.default,{style:oe.itemDate,children:["Created: ",(0,b.default)(e.createdAt,"MMM d, yyyy HH:mm")]}),e.dueDate&&(0,W.jsxs)(a.default,{style:[oe.itemDueDate,e.completed&&oe.completedText,new Date(e.dueDate)<new Date&&!e.completed&&oe.overdue],children:["Due: ",(0,b.default)(new Date(e.dueDate),"MMM d, yyyy"),new Date(e.dueDate)<new Date&&!e.completed&&" (Overdue)"]})]}),(0,W.jsxs)(c.default,{style:oe.itemActions,children:[(0,W.jsx)(f.default,{style:oe.actionButton,onPress:()=>n(e),activeOpacity:.7,hitSlop:{top:15,bottom:15,left:15,right:15},children:(0,W.jsx)(Q.default,{name:"pencil",size:18,color:"#666"})}),(0,W.jsx)(f.default,{style:[oe.actionButton,oe.deleteButton],onPress:()=>o(e.id),activeOpacity:.7,hitSlop:{top:15,bottom:15,left:15,right:15},children:(0,W.jsx)(Q.default,{name:"trash",size:18,color:"#fff"})})]})]})]}),te=({visible:e,item:t,onSave:n,onCancel:o})=>{const[i,s]=(0,r.useState)(""),[l,d]=(0,r.useState)(""),[g,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{t&&(s(t.title),d(t.description||""),m(t.dueDate?new Date(t.dueDate):null))},[t]);return(0,W.jsx)(p.default,{visible:e,animationType:"slide",transparent:!0,children:(0,W.jsx)(c.default,{style:oe.modalContainer,children:(0,W.jsxs)(c.default,{style:oe.modalContent,children:[(0,W.jsx)(a.default,{style:oe.modalTitle,children:"Edit Action Item"}),(0,W.jsx)(u.default,{style:oe.modalInput,value:i,onChangeText:s,placeholder:"Title",multiline:!0}),(0,W.jsx)(u.default,{style:[oe.modalInput,oe.modalInputLarge],value:l,onChangeText:d,placeholder:"Description (optional)",multiline:!0}),(0,W.jsxs)(c.default,{style:oe.dueDateContainer,children:[(0,W.jsx)(a.default,{style:oe.dueDateLabel,children:"Due Date:"}),(0,W.jsxs)(c.default,{style:oe.dueDateInputWrapper,children:[(0,W.jsx)("input",{type:"date",style:{flex:1,padding:12,fontSize:16,borderRadius:8,border:"1px solid #ddd",backgroundColor:"#f8f8f8"},onChange:e=>{e.target.value?m(new Date(e.target.value)):m(null)},value:g?(0,b.default)(g,"yyyy-MM-dd"):""}),g&&(0,W.jsx)(f.default,{style:oe.clearDateButton,onPress:()=>m(null),children:(0,W.jsx)(a.default,{style:oe.clearDateButtonText,children:"\u2715"})})]})]}),(0,W.jsxs)(c.default,{style:oe.modalButtons,children:[(0,W.jsx)(f.default,{style:oe.modalButton,onPress:o,children:(0,W.jsx)(a.default,{style:oe.modalButtonText,children:"Cancel"})}),(0,W.jsx)(f.default,{style:[oe.modalButton,oe.modalButtonPrimary],onPress:()=>{if(!t||!i.trim())return;const e=Object.assign({},t,{title:i.trim(),description:l.trim(),dueDate:g||void 0});n(e)},children:(0,W.jsx)(a.default,{style:[oe.modalButtonText,oe.modalButtonTextPrimary],children:"Save"})})]})]})})})},ne=()=>{const[e,t]=(0,r.useState)([]),[n,o]=(0,r.useState)("all"),[i,s]=(0,r.useState)(null),[l,d]=(0,r.useState)(!1),u=(0,r.useCallback)(async()=>{const e=await B.getActionItems();t(e)},[]);(0,r.useEffect)(()=>{u()},[u]),(0,Z.useFocusEffect)((0,r.useCallback)(()=>{u()},[u]));const m=e.filter(e=>{switch(n){case"pending":return!e.completed;case"completed":return e.completed;default:return!0}}),y=e=>{switch(e){case"overdue":return"\ud83d\udd34 Overdue";case"today":return"\ud83d\udcc5 Due Today";case"this-week":return"\ud83d\udccb Due This Week";case"this-month":return"\ud83d\uddd3\ufe0f Due This Month";case"later":return"\ud83d\udcc6 Due Later";case"completed":return"\u2705 Completed";default:return""}},h=e=>["overdue","today","this-week","this-month","later","completed"].indexOf(e),p=m.reduce((e,t)=>{const n=(e=>{if(e.completed)return"completed";if(!e.dueDate)return"later";const t=new Date;t.setHours(0,0,0,0);const n=new Date(t);n.setDate(n.getDate()+(7-t.getDay()));const o=new Date(t.getFullYear(),t.getMonth()+1,0);o.setHours(0,0,0,0);const r=new Date(e.dueDate);return r.setHours(0,0,0,0),r<t?"overdue":r.getTime()===t.getTime()?"today":r<=n?"this-week":r<=o?"this-month":"later"})(t);return e[n]||(e[n]=[]),e[n].push(t),e},{});Object.keys(p).forEach(e=>{p[e].sort((t,n)=>"completed"===e||"no-date"===e?n.createdAt.getTime()-t.createdAt.getTime():t.dueDate&&n.dueDate?new Date(t.dueDate).getTime()-new Date(n.dueDate).getTime():0)});const b=[];Object.keys(p).sort((e,t)=>h(e)-h(t)).forEach(e=>{b.push({type:"header",title:y(e)}),p[e].forEach(e=>{b.push({type:"item",item:e})})});const j=async n=>{const o=e.find(e=>e.id===n);if(!o)return;const r=Object.assign({},o,{completed:!o.completed});await B.updateActionItem(n,{completed:!o.completed}),t(e=>e.map(e=>e.id===n?r:e))},w=e=>{s(e),d(!0)},C=async e=>{if("undefined"===typeof window||window.confirm("Are you sure you want to delete this action item?"))try{await B.deleteActionItem(e),t(t=>t.filter(t=>t.id!==e))}catch(n){console.error("Error deleting action item:",n)}},S=e=>[oe.filterButton,n===e&&oe.filterButtonActive],k=e=>[oe.filterButtonText,n===e&&oe.filterButtonTextActive],T=e.filter(e=>!e.completed).length,D=e.filter(e=>e.completed).length;return(0,W.jsxs)(x.SafeAreaView,{style:oe.container,children:[(0,W.jsxs)(c.default,{style:oe.header,children:[(0,W.jsx)(a.default,{style:oe.headerTitle,children:"Action Items"}),(0,W.jsx)(c.default,{style:oe.stats,children:(0,W.jsxs)(a.default,{style:oe.statsText,children:[T," pending \u2022 ",D," completed"]})})]}),(0,W.jsxs)(c.default,{style:oe.filterContainer,children:[(0,W.jsx)(f.default,{style:S("all"),onPress:()=>o("all"),children:(0,W.jsx)(a.default,{style:k("all"),children:"All"})}),(0,W.jsx)(f.default,{style:S("pending"),onPress:()=>o("pending"),children:(0,W.jsx)(a.default,{style:k("pending"),children:"Pending"})}),(0,W.jsx)(f.default,{style:S("completed"),onPress:()=>o("completed"),children:(0,W.jsx)(a.default,{style:k("completed"),children:"Completed"})})]}),0===b.length?(0,W.jsxs)(c.default,{style:oe.emptyContainer,children:[(0,W.jsx)(Q.default,{name:"checkbox-outline",size:64,color:"#ccc"}),(0,W.jsx)(a.default,{style:oe.emptyText,children:"all"===n?"No action items yet":"pending"===n?"No pending action items":"No completed action items"}),(0,W.jsx)(a.default,{style:oe.emptySubtext,children:"Add entries in your journal to create action items"})]}):(0,W.jsx)(g.default,{data:b,renderItem:({item:e})=>"header"===e.type?(0,W.jsx)(c.default,{style:oe.sectionHeader,children:(0,W.jsx)(a.default,{style:oe.sectionHeaderText,children:e.title})}):(0,W.jsx)(ee,{item:e.item,onToggleComplete:j,onEdit:w,onDelete:C}),keyExtractor:(e,t)=>"header"===e.type?`header-${t}`:`item-${e.item.id}`,style:oe.list,showsVerticalScrollIndicator:!1}),(0,W.jsx)(te,{visible:l,item:i,onSave:async e=>{await B.updateActionItem(e.id,{title:e.title,description:e.description,dueDate:e.dueDate}),t(t=>t.map(t=>t.id===e.id?e:t)),d(!1),s(null)},onCancel:()=>{d(!1),s(null)}})]})},oe=m.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},headerTitle:{fontSize:20,fontWeight:"bold",color:"#333",marginBottom:4},stats:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},statsText:{fontSize:14,color:"#666"},filterContainer:{flexDirection:"row",paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},filterButton:{paddingHorizontal:16,paddingVertical:8,marginRight:8,borderRadius:20,backgroundColor:"#f0f0f0"},filterButtonActive:{backgroundColor:"#007AFF"},filterButtonText:{fontSize:14,color:"#666",fontWeight:"500"},filterButtonTextActive:{color:"#fff"},list:{flex:1,paddingHorizontal:16},sectionHeader:{paddingVertical:12,paddingHorizontal:8,marginTop:8},sectionHeaderText:{fontSize:16,fontWeight:"700",color:"#333",textTransform:"uppercase",letterSpacing:.5},itemCard:{backgroundColor:"#fff",marginVertical:6,padding:16,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},completedCard:{backgroundColor:"#f8f8f8",opacity:.8},itemHeader:{flexDirection:"row",alignItems:"flex-start",marginBottom:8},itemTitle:{flex:1,fontSize:16,fontWeight:"600",color:"#333",marginLeft:12,lineHeight:20},completedText:{textDecorationLine:"line-through",color:"#666"},itemDescription:{fontSize:14,color:"#666",lineHeight:18,marginBottom:12,marginLeft:36},itemFooter:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:8},itemDate:{fontSize:12,color:"#999"},itemDueDate:{fontSize:12,color:"#666",marginTop:2,fontWeight:"500"},overdue:{color:"#f44336",fontWeight:"600"},itemActions:{flexDirection:"row"},actionButton:{padding:10,marginLeft:8,minWidth:36,minHeight:36,alignItems:"center",justifyContent:"center",borderRadius:6,backgroundColor:"rgba(0,0,0,0.05)",borderWidth:1,borderColor:"rgba(0,0,0,0.1)"},deleteButton:{backgroundColor:"#f44336",borderColor:"#d32f2f"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:40},emptyText:{fontSize:18,fontWeight:"600",color:"#666",marginTop:16,textAlign:"center"},emptySubtext:{fontSize:14,color:"#999",marginTop:8,textAlign:"center",lineHeight:20},modalContainer:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:"#fff",borderRadius:12,padding:20,width:"90%",maxWidth:400},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:16,textAlign:"center"},modalInput:{borderWidth:1,borderColor:"#e0e0e0",borderRadius:8,padding:12,marginBottom:12,fontSize:16,minHeight:44},modalInputLarge:{minHeight:80,textAlignVertical:"top"},dueDateContainer:{marginBottom:12},dueDateLabel:{fontSize:14,fontWeight:"600",color:"#666",marginBottom:8},dueDateInputWrapper:{flexDirection:"row",alignItems:"center"},clearDateButton:{marginLeft:8,width:32,height:32,borderRadius:16,backgroundColor:"#f44336",alignItems:"center",justifyContent:"center"},clearDateButtonText:{color:"#fff",fontSize:14,fontWeight:"bold"},modalButtons:{flexDirection:"row",justifyContent:"space-between",marginTop:16},modalButton:{flex:1,paddingVertical:12,borderRadius:8,marginHorizontal:4,backgroundColor:"#f0f0f0"},modalButtonPrimary:{backgroundColor:"#007AFF"},modalButtonText:{textAlign:"center",fontSize:16,fontWeight:"600",color:"#333"},modalButtonTextPrimary:{color:"#fff"}});var re=n(7832),ae=n(3815),ie=n(8327);const se=({expense:e,onEdit:t,onDelete:n})=>(0,W.jsxs)(c.default,{style:ce.expenseCard,children:[(0,W.jsxs)(c.default,{style:ce.expenseHeader,children:[(0,W.jsxs)(c.default,{style:ce.expenseAmount,children:[(0,W.jsx)(a.default,{style:ce.amountText,children:v.formatCurrency(e.amount,e.currency)}),e.category&&(0,W.jsx)(a.default,{style:ce.categoryText,children:e.category})]}),(0,W.jsxs)(c.default,{style:ce.expenseActions,children:[(0,W.jsx)(f.default,{style:ce.actionButton,onPress:()=>t(e),activeOpacity:.7,hitSlop:{top:15,bottom:15,left:15,right:15},children:(0,W.jsx)(Q.default,{name:"pencil",size:18,color:"#666"})}),(0,W.jsx)(f.default,{style:[ce.actionButton,ce.deleteButton],onPress:()=>n(e.id),activeOpacity:.7,hitSlop:{top:15,bottom:15,left:15,right:15},children:(0,W.jsx)(Q.default,{name:"trash",size:18,color:"#fff"})})]})]}),(0,W.jsx)(a.default,{style:ce.expenseDescription,numberOfLines:2,children:e.description}),(0,W.jsx)(a.default,{style:ce.expenseDate,children:(0,b.default)(e.createdAt,"MMM d, yyyy HH:mm")})]}),le=({visible:e,expense:t,onSave:n,onCancel:o})=>{const[i,s]=(0,r.useState)(""),[l,d]=(0,r.useState)("USD"),[g,m]=(0,r.useState)(""),[h,x]=(0,r.useState)("");(0,r.useEffect)(()=>{t&&(s(t.amount.toString()),d(t.currency),m(t.description),x(t.category||""))},[t]);return(0,W.jsx)(p.default,{visible:e,animationType:"slide",transparent:!0,children:(0,W.jsx)(c.default,{style:ce.modalContainer,children:(0,W.jsxs)(c.default,{style:ce.modalContent,children:[(0,W.jsx)(a.default,{style:ce.modalTitle,children:"Edit Expense"}),(0,W.jsx)(u.default,{style:ce.modalInput,value:i,onChangeText:s,placeholder:"Amount",keyboardType:"numeric"}),(0,W.jsxs)(c.default,{style:ce.currencyContainer,children:[(0,W.jsx)(a.default,{style:ce.inputLabel,children:"Currency:"}),(0,W.jsx)(c.default,{style:ce.currencyOptions,children:["USD","INR","EUR","GBP"].map(e=>(0,W.jsx)(f.default,{style:[ce.currencyButton,l===e&&ce.currencyButtonActive],onPress:()=>d(e),children:(0,W.jsx)(a.default,{style:[ce.currencyButtonText,l===e&&ce.currencyButtonTextActive],children:e})},e))})]}),(0,W.jsx)(u.default,{style:[ce.modalInput,ce.modalInputLarge],value:g,onChangeText:m,placeholder:"Description",multiline:!0}),(0,W.jsxs)(c.default,{style:ce.categoryContainer,children:[(0,W.jsx)(a.default,{style:ce.inputLabel,children:"Category (optional):"}),(0,W.jsx)(c.default,{style:ce.categoryOptions,children:["Food","Transportation","Shopping","Entertainment","Bills","Healthcare","Education","Travel","Other"].map(e=>(0,W.jsx)(f.default,{style:[ce.categoryButton,h===e&&ce.categoryButtonActive],onPress:()=>x(h===e?"":e),children:(0,W.jsx)(a.default,{style:[ce.categoryButtonText,h===e&&ce.categoryButtonTextActive],children:e})},e))})]}),(0,W.jsxs)(c.default,{style:ce.modalButtons,children:[(0,W.jsx)(f.default,{style:ce.modalButton,onPress:o,children:(0,W.jsx)(a.default,{style:ce.modalButtonText,children:"Cancel"})}),(0,W.jsx)(f.default,{style:[ce.modalButton,ce.modalButtonPrimary],onPress:()=>{if(!t||!i.trim()||!g.trim())return;const e=parseFloat(i);if(isNaN(e)||e<=0)return void y.default.alert("Invalid Amount","Please enter a valid amount greater than 0");const o=Object.assign({},t,{amount:e,currency:l,description:g.trim(),category:h.trim()||void 0});n(o)},children:(0,W.jsx)(a.default,{style:[ce.modalButtonText,ce.modalButtonTextPrimary],children:"Save"})})]})]})})})},de=()=>{const[e,t]=(0,r.useState)([]),[n,o]=(0,r.useState)("all"),[i,s]=(0,r.useState)(null),[l,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)("list"),y=(0,r.useCallback)(async()=>{const e=await B.getExpenses();t(e.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()))},[]);(0,r.useEffect)(()=>{y()},[y]),(0,Z.useFocusEffect)((0,r.useCallback)(()=>{y()},[y]));const h=e.filter(e=>{if("thisMonth"===n){const t=new Date,n=(0,re.default)(t),o=(0,ae.default)(t);return(0,ie.default)(e.createdAt,{start:n,end:o})}return!0}),p=e=>{const t={};return e.forEach(e=>{const n=e.category||"Other";t[n]||(t[n]={amount:0,count:0,currency:e.currency}),t[n].amount+=e.amount,t[n].count+=1}),Object.entries(t).map(([e,t])=>({category:e,amount:t.amount,count:t.count,currency:t.currency,formatted:v.formatCurrency(t.amount,t.currency)})).sort((e,t)=>t.amount-e.amount)},j=e=>{s(e),d(!0)},w=async e=>{if("undefined"===typeof window||window.confirm("Are you sure you want to delete this expense?"))try{await B.deleteExpense(e),t(t=>t.filter(t=>t.id!==e))}catch(n){console.error("Error deleting expense:",n)}},C=e=>[ce.filterButton,n===e&&ce.filterButtonActive],S=e=>[ce.filterButtonText,n===e&&ce.filterButtonTextActive];return(0,W.jsxs)(x.SafeAreaView,{style:ce.container,children:[(0,W.jsxs)(c.default,{style:ce.header,children:[(0,W.jsx)(a.default,{style:ce.headerTitle,children:"Expenses"}),(0,W.jsx)(c.default,{style:ce.totalsContainer,children:0===h.length?(0,W.jsxs)(c.default,{style:ce.totalContainer,children:[(0,W.jsx)(a.default,{style:ce.totalLabel,children:"Total:"}),(0,W.jsx)(a.default,{style:ce.totalAmount,children:"$0.00"})]}):(e=>{if(0===e.length)return[];const t={};return e.forEach(e=>{t[e.currency]=(t[e.currency]||0)+e.amount}),Object.keys(t).map(e=>({currency:e,amount:t[e],formatted:v.formatCurrency(t[e],e)}))})(h).map(e=>(0,W.jsxs)(c.default,{style:ce.totalContainer,children:[(0,W.jsxs)(a.default,{style:ce.totalLabel,children:[e.currency," Total:"]}),(0,W.jsx)(a.default,{style:ce.totalAmount,children:e.formatted})]},e.currency))})]}),(0,W.jsxs)(c.default,{style:ce.filterContainer,children:[(0,W.jsx)(f.default,{style:C("all"),onPress:()=>o("all"),children:(0,W.jsx)(a.default,{style:S("all"),children:"All Time"})}),(0,W.jsx)(f.default,{style:C("thisMonth"),onPress:()=>o("thisMonth"),children:(0,W.jsx)(a.default,{style:S("thisMonth"),children:"This Month"})})]}),(0,W.jsxs)(c.default,{style:ce.viewToggleContainer,children:[(0,W.jsx)(f.default,{style:[ce.viewToggleButton,"list"===u&&ce.viewToggleButtonActive],onPress:()=>m("list"),children:(0,W.jsx)(a.default,{style:[ce.viewToggleText,"list"===u&&ce.viewToggleTextActive],children:"List"})}),(0,W.jsx)(f.default,{style:[ce.viewToggleButton,"analytics"===u&&ce.viewToggleButtonActive],onPress:()=>m("analytics"),children:(0,W.jsx)(a.default,{style:[ce.viewToggleText,"analytics"===u&&ce.viewToggleTextActive],children:"Analytics"})})]}),0===h.length?(0,W.jsxs)(c.default,{style:ce.emptyContainer,children:[(0,W.jsx)(Q.default,{name:"receipt-outline",size:64,color:"#ccc"}),(0,W.jsx)(a.default,{style:ce.emptyText,children:"all"===n?"No expenses yet":"No expenses this month"}),(0,W.jsx)(a.default,{style:ce.emptySubtext,children:"Add entries in your journal to track expenses"})]}):"list"===u?(0,W.jsx)(g.default,{data:h,renderItem:({item:e})=>(0,W.jsx)(se,{expense:e,onEdit:j,onDelete:w}),keyExtractor:e=>e.id,style:ce.list,showsVerticalScrollIndicator:!1}):(0,W.jsxs)(V.default,{style:ce.analyticsContainer,showsVerticalScrollIndicator:!1,children:[(0,W.jsxs)(c.default,{style:ce.analyticsSection,children:[(0,W.jsx)(a.default,{style:ce.analyticsSectionTitle,children:"\ud83d\udcca Category Breakdown"}),p(h).map((e,t)=>(0,W.jsxs)(c.default,{style:ce.categoryAnalyticsItem,children:[(0,W.jsxs)(c.default,{style:ce.categoryAnalyticsInfo,children:[(0,W.jsx)(a.default,{style:ce.categoryAnalyticsName,children:e.category}),(0,W.jsxs)(a.default,{style:ce.categoryAnalyticsCount,children:[e.count," ",1===e.count?"expense":"expenses"]})]}),(0,W.jsx)(a.default,{style:ce.categoryAnalyticsAmount,children:e.formatted})]},e.category))]}),(0,W.jsxs)(c.default,{style:ce.analyticsSection,children:[(0,W.jsx)(a.default,{style:ce.analyticsSectionTitle,children:"\ud83d\udcc8 Monthly Trends"}),(()=>{const t={};return e.forEach(e=>{const n=(0,b.default)(e.createdAt,"MMM yyyy");t[n]||(t[n]={amount:0,count:0}),t[n].amount+=e.amount,t[n].count+=1}),Object.entries(t).map(([e,t])=>({month:e,amount:t.amount,count:t.count})).sort((e,t)=>new Date(e.month).getTime()-new Date(t.month).getTime())})().map((e,t)=>(0,W.jsxs)(c.default,{style:ce.trendItem,children:[(0,W.jsx)(a.default,{style:ce.trendMonth,children:e.month}),(0,W.jsxs)(c.default,{style:{alignItems:"flex-end"},children:[(0,W.jsx)(a.default,{style:ce.trendAmount,children:v.formatCurrency(e.amount,"USD")}),(0,W.jsxs)(a.default,{style:ce.categoryAnalyticsCount,children:[e.count," ",1===e.count?"expense":"expenses"]})]})]},e.month))]}),(0,W.jsxs)(c.default,{style:ce.analyticsSection,children:[(0,W.jsx)(a.default,{style:ce.analyticsSectionTitle,children:"\ud83d\udccb Quick Stats"}),(0,W.jsxs)(c.default,{style:ce.trendItem,children:[(0,W.jsx)(a.default,{style:ce.trendMonth,children:"Average per expense"}),(0,W.jsx)(a.default,{style:ce.trendAmount,children:h.length>0?v.formatCurrency(h.reduce((e,t)=>e+t.amount,0)/h.length,h[0].currency):"$0.00"})]}),(0,W.jsxs)(c.default,{style:ce.trendItem,children:[(0,W.jsx)(a.default,{style:ce.trendMonth,children:"Most expensive category"}),(0,W.jsx)(a.default,{style:ce.trendAmount,children:p(h)[0]?.category||"None"})]}),(0,W.jsxs)(c.default,{style:ce.trendItem,children:[(0,W.jsx)(a.default,{style:ce.trendMonth,children:"Total categories"}),(0,W.jsx)(a.default,{style:ce.trendAmount,children:p(h).length})]})]})]}),(0,W.jsx)(le,{visible:l,expense:i,onSave:async e=>{await B.updateExpense(e.id,{amount:e.amount,currency:e.currency,description:e.description,category:e.category}),t(t=>t.map(t=>t.id===e.id?e:t)),d(!1),s(null)},onCancel:()=>{d(!1),s(null)}})]})},ce=m.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},headerTitle:{fontSize:20,fontWeight:"bold",color:"#333",marginBottom:8},totalsContainer:{paddingHorizontal:16,paddingTop:8},totalContainer:{flexDirection:"row",alignItems:"center",marginBottom:4},totalLabel:{fontSize:14,color:"#666",marginRight:8},totalAmount:{fontSize:16,fontWeight:"bold",color:"#2e7d32"},filterContainer:{flexDirection:"row",paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},filterButton:{paddingHorizontal:16,paddingVertical:8,marginRight:8,borderRadius:20,backgroundColor:"#f0f0f0"},filterButtonActive:{backgroundColor:"#007AFF"},filterButtonText:{fontSize:14,color:"#666",fontWeight:"500"},filterButtonTextActive:{color:"#fff"},list:{flex:1,paddingHorizontal:16},expenseCard:{backgroundColor:"#fff",marginVertical:6,padding:16,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},expenseHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},expenseAmount:{flex:1},amountText:{fontSize:18,fontWeight:"bold",color:"#2e7d32"},categoryText:{fontSize:12,color:"#666",marginTop:2,backgroundColor:"#f0f0f0",paddingHorizontal:8,paddingVertical:2,borderRadius:10,alignSelf:"flex-start"},expenseActions:{flexDirection:"row"},actionButton:{padding:10,marginLeft:8,minWidth:36,minHeight:36,alignItems:"center",justifyContent:"center",borderRadius:6,backgroundColor:"rgba(0,0,0,0.05)",borderWidth:1,borderColor:"rgba(0,0,0,0.1)"},deleteButton:{backgroundColor:"#f44336",borderColor:"#d32f2f"},expenseDescription:{fontSize:14,color:"#333",lineHeight:18,marginBottom:8},expenseDate:{fontSize:12,color:"#999"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:40},emptyText:{fontSize:18,fontWeight:"600",color:"#666",marginTop:16,textAlign:"center"},emptySubtext:{fontSize:14,color:"#999",marginTop:8,textAlign:"center",lineHeight:20},modalContainer:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:"#fff",borderRadius:12,padding:20,width:"90%",maxWidth:400,maxHeight:"80%"},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:16,textAlign:"center"},modalInput:{borderWidth:1,borderColor:"#e0e0e0",borderRadius:8,padding:12,marginBottom:12,fontSize:16,minHeight:44},modalInputLarge:{minHeight:80,textAlignVertical:"top"},inputLabel:{fontSize:14,fontWeight:"600",color:"#333",marginBottom:8},currencyContainer:{marginBottom:12},currencyOptions:{flexDirection:"row",flexWrap:"wrap"},currencyButton:{paddingHorizontal:12,paddingVertical:6,marginRight:8,marginBottom:8,borderRadius:16,backgroundColor:"#f0f0f0",borderWidth:1,borderColor:"#e0e0e0"},currencyButtonActive:{backgroundColor:"#007AFF",borderColor:"#007AFF"},currencyButtonText:{fontSize:14,color:"#666",fontWeight:"500"},currencyButtonTextActive:{color:"#fff"},categoryContainer:{marginBottom:16},categoryOptions:{flexDirection:"row",flexWrap:"wrap"},categoryButton:{paddingHorizontal:12,paddingVertical:6,marginRight:8,marginBottom:8,borderRadius:16,backgroundColor:"#f0f0f0",borderWidth:1,borderColor:"#e0e0e0"},categoryButtonActive:{backgroundColor:"#4caf50",borderColor:"#4caf50"},categoryButtonText:{fontSize:12,color:"#666",fontWeight:"500"},categoryButtonTextActive:{color:"#fff"},modalButtons:{flexDirection:"row",justifyContent:"space-between",marginTop:16},modalButton:{flex:1,paddingVertical:12,borderRadius:8,marginHorizontal:4,backgroundColor:"#f0f0f0"},modalButtonPrimary:{backgroundColor:"#007AFF"},modalButtonText:{textAlign:"center",fontSize:16,fontWeight:"600",color:"#333"},modalButtonTextPrimary:{color:"#fff"},viewToggleContainer:{flexDirection:"row",paddingHorizontal:16,paddingVertical:8,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},viewToggleButton:{flex:1,paddingVertical:8,paddingHorizontal:16,marginHorizontal:4,borderRadius:16,backgroundColor:"#f0f0f0",alignItems:"center"},viewToggleButtonActive:{backgroundColor:"#007AFF"},viewToggleText:{fontSize:14,fontWeight:"600",color:"#666"},viewToggleTextActive:{color:"#fff"},analyticsContainer:{flex:1,paddingHorizontal:16},analyticsSection:{backgroundColor:"#fff",borderRadius:12,padding:16,marginVertical:8},analyticsSectionTitle:{fontSize:16,fontWeight:"bold",color:"#333",marginBottom:12},categoryAnalyticsItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,borderBottomWidth:1,borderBottomColor:"#f0f0f0"},categoryAnalyticsInfo:{flex:1},categoryAnalyticsName:{fontSize:14,fontWeight:"600",color:"#333"},categoryAnalyticsCount:{fontSize:12,color:"#666",marginTop:2},categoryAnalyticsAmount:{fontSize:14,fontWeight:"bold",color:"#2e7d32"},trendItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,borderBottomWidth:1,borderBottomColor:"#f0f0f0"},trendMonth:{fontSize:14,fontWeight:"600",color:"#333"},trendAmount:{fontSize:14,fontWeight:"bold",color:"#2e7d32"}});var ue=n(1514),fe=n(1706),ge=n(7610),me=n(9068),ye=n(9007);const he=()=>{const[e,t]=(0,r.useState)(null),[n,o]=(0,r.useState)("month"),[i,s]=(0,r.useState)(!0),l=(0,r.useCallback)(async()=>{s(!0);try{const[e,o,r]=await Promise.all([B.getEntries(),B.getExpenses(),B.getActionItems()]),a=new Date,i=(0,ue.default)(a,1),s=(0,fe.default)(a,1),l=((t=>{const n="week"===t?i:"month"===t?s:null;n&&e.filter(e=>e.timestamp>=n),n&&o.filter(e=>e.createdAt>=n),n&&r.filter(e=>e.createdAt>=n)})(n),e.length),d=e.filter(e=>e.timestamp>=i).length,c=e.filter(e=>e.timestamp>=s).length,u={},f={};o.forEach(e=>{u[e.currency]=(u[e.currency]||0)+e.amount}),o.filter(e=>e.createdAt>=s).forEach(e=>{f[e.currency]=(f[e.currency]||0)+e.amount});const g=r.length,m=r.filter(e=>e.completed).length,y=g-m,h=g>0?m/g*100:0,p={};e.forEach(e=>{const t=(0,b.default)(e.timestamp,"EEEE");p[t]=(p[t]||0)+1});const x=Object.entries(p).reduce((e,t)=>p[e[0]]>p[t[0]]?e:t,["Monday",0])[0]||"No data",j=e.length>0?e.length/Math.max(1,Math.ceil((a.getTime()-e[0].timestamp.getTime())/864e5)):0,w={};o.forEach(e=>{const t=e.category||"Other";w[t]||(w[t]={amount:0,currency:e.currency}),w[t].amount+=e.amount});const C=Object.entries(w).map(([e,t])=>({category:e,amount:t.amount,currency:t.currency})).sort((e,t)=>t.amount-e.amount).slice(0,5),S=[];for(let t=6;t>=0;t--){const n=(0,ge.default)(a,t),i=(0,me.default)(n),s=(0,ye.default)(n),l=e.filter(e=>(0,ie.default)(e.timestamp,{start:i,end:s})).length,d=o.filter(e=>(0,ie.default)(e.createdAt,{start:i,end:s})).length,c=r.filter(e=>(0,ie.default)(e.createdAt,{start:i,end:s})).length;S.push({date:(0,b.default)(n,"MMM dd"),entries:l,expenses:d,actions:c})}t({totalEntries:l,entriesThisWeek:d,entriesThisMonth:c,totalExpenses:Object.entries(u).map(([e,t])=>({currency:e,amount:t})),expensesThisMonth:Object.entries(f).map(([e,t])=>({currency:e,amount:t})),totalActionItems:g,completedActionItems:m,pendingActionItems:y,completionRate:h,averageEntriesPerDay:j,mostActiveDay:x,topExpenseCategories:C,recentActivity:S})}catch(e){console.error("Error calculating analytics:",e)}finally{s(!1)}},[n]);return(0,Z.useFocusEffect)((0,r.useCallback)(()=>{l()},[l])),i||!e?(0,W.jsx)(x.SafeAreaView,{style:pe.container,children:(0,W.jsx)(a.default,{style:pe.loadingText,children:"Loading analytics..."})}):(0,W.jsxs)(x.SafeAreaView,{style:pe.container,children:[(0,W.jsx)(c.default,{style:pe.header,children:(0,W.jsx)(a.default,{style:pe.headerTitle,children:"Analytics & Insights"})}),(0,W.jsxs)(V.default,{style:pe.content,showsVerticalScrollIndicator:!1,children:[(0,W.jsx)(c.default,{style:pe.periodSelector,children:["week","month","all"].map(e=>(0,W.jsx)(f.default,{style:[pe.periodButton,n===e&&pe.periodButtonActive],onPress:()=>o(e),children:(0,W.jsx)(a.default,{style:[pe.periodButtonText,n===e&&pe.periodButtonTextActive],children:"all"===e?"All Time":`This ${e.charAt(0).toUpperCase()+e.slice(1)}`})},e))}),(0,W.jsxs)(c.default,{style:pe.summaryGrid,children:[(0,W.jsxs)(c.default,{style:pe.summaryCard,children:[(0,W.jsx)(a.default,{style:pe.summaryNumber,children:e.totalEntries}),(0,W.jsx)(a.default,{style:pe.summaryLabel,children:"Total Entries"})]}),(0,W.jsxs)(c.default,{style:pe.summaryCard,children:[(0,W.jsx)(a.default,{style:pe.summaryNumber,children:e.totalActionItems}),(0,W.jsx)(a.default,{style:pe.summaryLabel,children:"Action Items"})]}),(0,W.jsxs)(c.default,{style:pe.summaryCard,children:[(0,W.jsxs)(a.default,{style:pe.summaryNumber,children:[e.completionRate.toFixed(0),"%"]}),(0,W.jsx)(a.default,{style:pe.summaryLabel,children:"Completion Rate"})]}),(0,W.jsxs)(c.default,{style:pe.summaryCard,children:[(0,W.jsx)(a.default,{style:pe.summaryNumber,children:e.averageEntriesPerDay.toFixed(1)}),(0,W.jsx)(a.default,{style:pe.summaryLabel,children:"Avg Entries/Day"})]})]}),(0,W.jsxs)(c.default,{style:pe.section,children:[(0,W.jsx)(a.default,{style:pe.sectionTitle,children:"\ud83d\udcb0 Spending Overview"}),e.totalExpenses.length>0?(0,W.jsx)(c.default,{style:pe.expenseList,children:e.totalExpenses.map((e,t)=>(0,W.jsxs)(c.default,{style:pe.expenseItem,children:[(0,W.jsx)(a.default,{style:pe.expenseAmount,children:v.formatCurrency(e.amount,e.currency)}),(0,W.jsx)(a.default,{style:pe.expenseLabel,children:"Total Spent"})]},e.currency))}):(0,W.jsx)(a.default,{style:pe.emptyText,children:"No expenses recorded yet"})]}),e.topExpenseCategories.length>0&&(0,W.jsxs)(c.default,{style:pe.section,children:[(0,W.jsx)(a.default,{style:pe.sectionTitle,children:"\ud83d\udcca Top Spending Categories"}),(0,W.jsx)(c.default,{style:pe.categoryList,children:e.topExpenseCategories.map((t,n)=>(0,W.jsxs)(c.default,{style:pe.categoryItem,children:[(0,W.jsxs)(c.default,{style:pe.categoryInfo,children:[(0,W.jsx)(a.default,{style:pe.categoryName,children:t.category}),(0,W.jsx)(a.default,{style:pe.categoryAmount,children:v.formatCurrency(t.amount,t.currency)})]}),(0,W.jsx)(c.default,{style:[pe.categoryBar,{width:t.amount/e.topExpenseCategories[0].amount*100+"%"}]})]},t.category))})]}),(0,W.jsxs)(c.default,{style:pe.section,children:[(0,W.jsx)(a.default,{style:pe.sectionTitle,children:"\ud83d\udcc8 Activity Patterns"}),(0,W.jsxs)(c.default,{style:pe.patternCard,children:[(0,W.jsx)(a.default,{style:pe.patternLabel,children:"Most Active Day"}),(0,W.jsx)(a.default,{style:pe.patternValue,children:e.mostActiveDay})]})]}),(0,W.jsxs)(c.default,{style:pe.section,children:[(0,W.jsx)(a.default,{style:pe.sectionTitle,children:"\ud83d\udcc5 Recent Activity (Last 7 Days)"}),(0,W.jsx)(c.default,{style:pe.chartContainer,children:e.recentActivity.map((t,n)=>{const o=Math.max(...e.recentActivity.map(e=>e.entries)),r=Math.max(...e.recentActivity.map(e=>e.expenses)),i=Math.max(...e.recentActivity.map(e=>e.actions)),s=Math.max(o,r,i,1),l=Math.max(4,t.entries/s*50),d=Math.max(4,t.expenses/s*50),u=Math.max(4,t.actions/s*50);return(0,W.jsxs)(c.default,{style:pe.chartDay,children:[(0,W.jsxs)(c.default,{style:pe.chartBars,children:[(0,W.jsx)(c.default,{style:[pe.chartBar,pe.entriesBar,{height:l}]}),(0,W.jsx)(c.default,{style:[pe.chartBar,pe.expensesBar,{height:d}]}),(0,W.jsx)(c.default,{style:[pe.chartBar,pe.actionsBar,{height:u}]})]}),(0,W.jsx)(a.default,{style:pe.chartDate,children:t.date})]},t.date)})}),(0,W.jsxs)(c.default,{style:pe.legend,children:[(0,W.jsxs)(c.default,{style:pe.legendItem,children:[(0,W.jsx)(c.default,{style:[pe.legendColor,pe.entriesBar]}),(0,W.jsx)(a.default,{style:pe.legendText,children:"Entries"})]}),(0,W.jsxs)(c.default,{style:pe.legendItem,children:[(0,W.jsx)(c.default,{style:[pe.legendColor,pe.expensesBar]}),(0,W.jsx)(a.default,{style:pe.legendText,children:"Expenses"})]}),(0,W.jsxs)(c.default,{style:pe.legendItem,children:[(0,W.jsx)(c.default,{style:[pe.legendColor,pe.actionsBar]}),(0,W.jsx)(a.default,{style:pe.legendText,children:"Actions"})]})]})]}),(0,W.jsxs)(c.default,{style:pe.section,children:[(0,W.jsx)(a.default,{style:pe.sectionTitle,children:"\ud83d\udca1 Insights"}),(0,W.jsxs)(c.default,{style:pe.insightsList,children:[e.averageEntriesPerDay>3&&(0,W.jsx)(c.default,{style:pe.insightCard,children:(0,W.jsxs)(a.default,{style:pe.insightText,children:["\ud83d\udd25 You're on fire! Averaging ",e.averageEntriesPerDay.toFixed(1)," entries per day"]})}),e.completionRate>75&&(0,W.jsx)(c.default,{style:pe.insightCard,children:(0,W.jsxs)(a.default,{style:pe.insightText,children:["\u2b50 Great job! You complete ",e.completionRate.toFixed(0),"% of your action items"]})}),e.pendingActionItems>5&&(0,W.jsx)(c.default,{style:pe.insightCard,children:(0,W.jsxs)(a.default,{style:pe.insightText,children:["\u26a0\ufe0f You have ",e.pendingActionItems," pending action items. Consider reviewing them!"]})}),0===e.totalExpenses.length&&e.totalEntries>10&&(0,W.jsx)(c.default,{style:pe.insightCard,children:(0,W.jsx)(a.default,{style:pe.insightText,children:"\ud83d\udcb8 No expenses tracked yet. Try adding some spending entries to track your budget!"})})]})]})]})]})},pe=m.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},headerTitle:{fontSize:20,fontWeight:"bold",color:"#333"},loadingText:{textAlign:"center",marginTop:50,fontSize:16,color:"#666"},content:{flex:1},periodSelector:{flexDirection:"row",paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},periodButton:{flex:1,paddingVertical:8,paddingHorizontal:12,marginHorizontal:4,borderRadius:16,backgroundColor:"#f0f0f0",alignItems:"center"},periodButtonActive:{backgroundColor:"#007AFF"},periodButtonText:{fontSize:14,fontWeight:"600",color:"#666"},periodButtonTextActive:{color:"#fff"},summaryGrid:{flexDirection:"row",flexWrap:"wrap",paddingHorizontal:16,paddingTop:16,gap:12},summaryCard:{width:(E.default.get("window").width-44)/2,backgroundColor:"#fff",padding:16,borderRadius:12,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},summaryNumber:{fontSize:24,fontWeight:"bold",color:"#333",marginBottom:4},summaryLabel:{fontSize:12,color:"#666",textAlign:"center"},section:{marginTop:16,paddingHorizontal:16},sectionTitle:{fontSize:18,fontWeight:"bold",color:"#333",marginBottom:12},expenseList:{backgroundColor:"#fff",borderRadius:12,padding:16},expenseItem:{alignItems:"center",marginBottom:8},expenseAmount:{fontSize:20,fontWeight:"bold",color:"#2e7d32"},expenseLabel:{fontSize:12,color:"#666",marginTop:2},categoryList:{backgroundColor:"#fff",borderRadius:12,padding:16},categoryItem:{marginBottom:12,position:"relative"},categoryInfo:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:4,zIndex:1},categoryName:{fontSize:14,fontWeight:"600",color:"#333"},categoryAmount:{fontSize:14,fontWeight:"bold",color:"#2e7d32"},categoryBar:{height:4,backgroundColor:"#007AFF",borderRadius:2,position:"absolute",bottom:0,left:0,opacity:.3},patternCard:{backgroundColor:"#fff",borderRadius:12,padding:16,alignItems:"center"},patternLabel:{fontSize:14,color:"#666",marginBottom:4},patternValue:{fontSize:18,fontWeight:"bold",color:"#333"},chartContainer:{backgroundColor:"#fff",borderRadius:12,padding:16,flexDirection:"row",justifyContent:"space-around",alignItems:"flex-end",height:100,marginBottom:8},chartDay:{alignItems:"center",flex:1},chartBars:{flexDirection:"row",alignItems:"flex-end",height:50,marginBottom:8,gap:2},chartBar:{width:6,borderRadius:3,minHeight:4},entriesBar:{backgroundColor:"#007AFF"},expensesBar:{backgroundColor:"#2e7d32"},actionsBar:{backgroundColor:"#ff9800"},chartDate:{fontSize:10,color:"#666"},legend:{flexDirection:"row",justifyContent:"center",marginTop:12,gap:16},legendItem:{flexDirection:"row",alignItems:"center"},legendColor:{width:8,height:8,borderRadius:4,marginRight:6},legendText:{fontSize:12,color:"#666"},insightsList:{gap:8},insightCard:{backgroundColor:"#fff",borderRadius:12,padding:16,borderLeftWidth:4,borderLeftColor:"#007AFF"},insightText:{fontSize:14,color:"#333",lineHeight:20},emptyText:{textAlign:"center",color:"#666",fontSize:14,backgroundColor:"#fff",borderRadius:12,padding:20}});m.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},headerTitle:{fontSize:20,fontWeight:"bold",color:"#333"},closeButton:{padding:8,borderRadius:20,backgroundColor:"#f0f0f0"},closeButtonText:{fontSize:16,color:"#666",fontWeight:"bold"},content:{flex:1,paddingHorizontal:16},subtitle:{fontSize:16,color:"#666",textAlign:"center",marginVertical:20,lineHeight:22},optionCard:{backgroundColor:"#fff",borderRadius:12,padding:16,marginBottom:16,borderWidth:2,borderColor:"transparent",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},selectedCard:{borderColor:"#007AFF",backgroundColor:"#f8f9ff"},optionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},optionTitleRow:{flexDirection:"row",alignItems:"center",flex:1},optionPreview:{fontSize:28,marginRight:12},optionTitleContainer:{flex:1,flexDirection:"row",alignItems:"center"},optionName:{fontSize:18,fontWeight:"bold",color:"#333",marginRight:8},currentBadge:{backgroundColor:"#007AFF",color:"#fff",fontSize:10,fontWeight:"bold",paddingHorizontal:6,paddingVertical:2,borderRadius:10,overflow:"hidden"},optionDescription:{fontSize:14,color:"#666",marginBottom:12,lineHeight:20},featuresContainer:{marginTop:4},featureRow:{flexDirection:"row",alignItems:"flex-start",marginBottom:4},featureBullet:{fontSize:16,color:"#007AFF",marginRight:8,marginTop:1},featureText:{fontSize:13,color:"#555",flex:1,lineHeight:18},radioButton:{width:24,height:24,borderRadius:12,borderWidth:2,borderColor:"#ddd",justifyContent:"center",alignItems:"center"},radioButtonSelected:{borderColor:"#007AFF"},radioButtonInner:{width:12,height:12,borderRadius:6,backgroundColor:"#007AFF"},footer:{padding:16,backgroundColor:"#fff",borderTopWidth:1,borderTopColor:"#e0e0e0"},selectButton:{backgroundColor:"#007AFF",borderRadius:12,paddingVertical:16,alignItems:"center"},selectButtonDisabled:{backgroundColor:"#f0f0f0"},selectButtonText:{color:"#fff",fontSize:16,fontWeight:"bold"},selectButtonTextDisabled:{color:"#999"}});const xe=(0,l.default)();function be(){return(0,W.jsxs)(d.SafeAreaProvider,{children:[(0,W.jsx)(i.StatusBar,{style:"dark"}),(0,W.jsx)(s.default,{children:(0,W.jsxs)(xe.Navigator,{screenOptions:({route:e})=>({tabBarIcon:({focused:t,color:n,size:o})=>{let r;return r="Journal"===e.name?"\ud83d\udcdd":"ActionItems"===e.name?"\u2705":"Expenses"===e.name?"\ud83d\udcb0":"Analytics"===e.name?"\ud83d\udcca":"\u2753",(0,W.jsx)(a.default,{style:{fontSize:o,color:n},children:r})},tabBarActiveTintColor:"#007AFF",tabBarInactiveTintColor:"gray",tabBarStyle:{backgroundColor:"#fff",borderTopWidth:1,borderTopColor:"#e0e0e0",paddingBottom:5,paddingTop:5,height:60},headerShown:!1}),children:[(0,W.jsx)(xe.Screen,{name:"Journal",component:Y,options:{tabBarLabel:"Journal"}}),(0,W.jsx)(xe.Screen,{name:"ActionItems",component:ne,options:{tabBarLabel:"Tasks"}}),(0,W.jsx)(xe.Screen,{name:"Expenses",component:de,options:{tabBarLabel:"Expenses"}}),(0,W.jsx)(xe.Screen,{name:"Analytics",component:he,options:{tabBarLabel:"Analytics"}})]})})]})}(0,o.default)(be),(0,o.default)(be)}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.m=e,(()=>{var e=[];n.O=(t,o,r,a)=>{if(!o){var i=1/0;for(c=0;c<e.length;c++){for(var[o,r,a]=e[c],s=!0,l=0;l<o.length;l++)(!1&a||i>=a)&&Object.keys(n.O).every(e=>n.O[e](o[l]))?o.splice(l--,1):(s=!1,a<i&&(i=a));if(s){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[o,r,a]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/DailyTracker/",(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var r,a,[i,s,l]=o,d=0;if(i.some(t=>0!==e[t])){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)var c=l(n)}for(t&&t(o);d<i.length;d++)a=i[d],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(c)},o=self.webpackChunkweb=self.webpackChunkweb||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=n.O(void 0,[7],()=>n(9188));o=n.O(o)})();
//# sourceMappingURL=main.48bdf047.js.map