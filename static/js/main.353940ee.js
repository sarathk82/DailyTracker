(()=>{"use strict";var e={6754:(e,t,n)=>{var r=n(7408),o=n(9307),a=n(6283),i=n(9039),s=n(6986),l=n(8648),d=n(8833),c=n(3929),u=n(6773),f=n(5648),g=n(932),m=n(3668),y=n(1690),h=n(4767),p=n(8264),x=n(1171),b=n(673),j=n(827);const w="@daily_tracker_entries",S="@daily_tracker_action_items",C="@daily_tracker_expenses",k="@daily_tracker_settings",T="@daily_tracker_backup";class D{static async getEntries(){try{const e=await j.default.getItem(w);if(null!=e){const t=JSON.parse(e).map(e=>Object.assign({},e,{timestamp:new Date(e.timestamp),type:e.type,isMarkdown:e.isMarkdown||!1}));return t.sort((e,t)=>{if(Math.abs(e.timestamp.getTime()-t.timestamp.getTime())<2e3){if("system"===e.type&&"system"!==t.type)return 1;if("system"!==e.type&&"system"===t.type)return-1}return e.timestamp.getTime()-t.timestamp.getTime()})}return[]}catch(e){return console.error("Error getting entries:",e),[]}}static async saveEntries(e){try{const t=JSON.stringify(e);await j.default.setItem(w,t)}catch(t){console.error("Error saving entries:",t)}}static async addEntry(e){try{const t=await this.getEntries();t.push(e),await this.saveEntries(t)}catch(t){console.error("Error adding entry:",t)}}static async getActionItems(){try{const e=await j.default.getItem(S);if(null!=e){return JSON.parse(e).map(e=>Object.assign({},e,{createdAt:new Date(e.createdAt),dueDate:e.dueDate?new Date(e.dueDate):void 0}))}return[]}catch(e){return console.error("Error getting action items:",e),[]}}static async saveActionItems(e){try{const t=JSON.stringify(e);await j.default.setItem(S,t)}catch(t){console.error("Error saving action items:",t)}}static async addActionItem(e){try{const t=await this.getActionItems();t.push(e),await this.saveActionItems(t)}catch(t){console.error("Error adding action item:",t)}}static async updateActionItem(e,t){try{const n=await this.getActionItems(),r=n.findIndex(t=>t.id===e);-1!==r&&(n[r]=Object.assign({},n[r],t)),await this.saveActionItems(n)}catch(n){console.error("Error updating action item:",n)}}static async deleteActionItem(e){try{const t=(await this.getActionItems()).filter(t=>t.id!==e);await this.saveActionItems(t)}catch(t){console.error("Error deleting action item:",t)}}static async getExpenses(){try{const e=await j.default.getItem(C);if(null!=e){const t=JSON.parse(e);return t.map(e=>Object.assign({},e,{createdAt:new Date(e.createdAt)}))}return[]}catch(e){return console.error("Error getting expenses:",e),[]}}static async saveExpenses(e){try{const t=JSON.stringify(e);await j.default.setItem(C,t)}catch(t){console.error("Error saving expenses:",t)}}static async addExpense(e){try{const t=await this.getExpenses();t.push(e),await this.saveExpenses(t)}catch(t){console.error("Error adding expense:",t)}}static async updateExpense(e,t){try{const n=await this.getExpenses(),r=n.findIndex(t=>t.id===e);-1!==r&&(n[r]=Object.assign({},n[r],t),await this.saveExpenses(n))}catch(n){console.error("Error updating expense:",n)}}static async deleteExpense(e){try{const t=(await this.getExpenses()).filter(t=>t.id!==e);await this.saveExpenses(t)}catch(t){console.error("Error deleting expense:",t)}}static async getSettings(){try{const e=await j.default.getItem(k);return null!=e?JSON.parse(e):null}catch(e){return console.error("Error getting settings:",e),null}}static async saveSettings(e){try{const t=JSON.stringify(e);await j.default.setItem(k,t)}catch(t){console.error("Error saving settings:",t)}}static async saveBackup(e){try{const t=JSON.stringify(e);await j.default.setItem(T,t)}catch(t){console.error("Error saving backup:",t)}}static async getBackup(){try{const e=await j.default.getItem(T);if(null!=e){const t=JSON.parse(e);return Object.assign({},t,{entries:t.entries.map(e=>Object.assign({},e,{timestamp:new Date(e.timestamp)})),expenses:t.expenses.map(e=>Object.assign({},e,{createdAt:new Date(e.createdAt)})),actionItems:t.actionItems.map(e=>Object.assign({},e,{createdAt:new Date(e.createdAt),dueDate:e.dueDate?new Date(e.dueDate):void 0}))})}return null}catch(e){return console.error("Error getting backup:",e),null}}}var B=n(4411);const v={background:"#f5f5f5",surface:"#ffffff",card:"#ffffff",text:"#000000",textSecondary:"#666666",border:"#dddddd",primary:"#007AFF",success:"#34C759",warning:"#FF9500",error:"#FF3B30",info:"#5AC8FA",shadow:"rgba(0, 0, 0, 0.1)",overlay:"rgba(0, 0, 0, 0.5)",input:"#f8f8f8",inputBorder:"#dddddd",placeholder:"#999999",divider:"#e0e0e0",highlight:"#e8f4ff"},I={background:"#000000",surface:"#1c1c1e",card:"#2c2c2e",text:"#ffffff",textSecondary:"#a0a0a0",border:"#3a3a3c",primary:"#0A84FF",success:"#30D158",warning:"#FF9F0A",error:"#FF453A",info:"#64D2FF",shadow:"rgba(0, 0, 0, 0.3)",overlay:"rgba(0, 0, 0, 0.7)",input:"#2c2c2e",inputBorder:"#3a3a3c",placeholder:"#6c6c70",divider:"#38383a",highlight:"#1a2a3a"},A=(0,o.createContext)(void 0),z=({children:e})=>{const t=(0,b.default)(),[n,r]=(0,o.useState)("system");(0,o.useEffect)(()=>{a()},[]);const a=async()=>{try{const e=await D.getSettings();e?.theme&&r(e.theme)}catch(e){console.error("Error loading theme:",e)}},i="dark"===("system"===n?"dark"===t?"dark":"light":n),s=i?I:v;return(0,B.jsx)(A.Provider,{value:{theme:s,themeMode:n,isDark:i,setThemeMode:async e=>{try{r(e);const t=await D.getSettings();await D.saveSettings(Object.assign({},t,{theme:e}))}catch(t){console.error("Error saving theme:",t)}}},children:e})},E=()=>{const e=(0,o.useContext)(A);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e};var R=n(5412);const M=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});class W{static detectActionItem(e){return/^\s*\.\s*\S/.test(e)}static detectExpense(e){const t=e.toLowerCase();if(this.EXPENSE_KEYWORDS.some(e=>t.includes(e)))return!0;if(this.hasNumericValue(e)&&this.hasExpenseContext(e)){if(/^\s*\d+(\.\d{1,2})?\s*$/.test(e))return!1;return!/^\s*(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*\d+(?:\.\d{1,2})?\s*$/.test(e)}return!1}static hasNumericValue(e){return/(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*\d+(?:\.\d{1,2})?|\b\d+(?:\.\d{1,2})?\b/.test(e)}static hasExpenseContext(e){const t=e.toLowerCase();if(["spent","bought","purchased","paid","cost","price","bill","receipt","shopping","store","market","restaurant","cafe","food","lunch","dinner","gas","fuel","electricity","rent","groceries","medicine","doctor","haircut","salon","barber","transportation","taxi","uber","lyft","coffee","tea","snack","movie","ticket","parking","toll"].some(e=>t.includes(e)))return!0;if(/\d+(?:\.\d{1,2})?\s+for\s+\w+/i.test(e))return!0;return!!/(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*\d+(?:\.\d{1,2})?\s+for\s+\w+/i.test(e)}static getSystemCurrency(){try{const t=Intl.NumberFormat().resolvedOptions().locale,n=Intl.DateTimeFormat().resolvedOptions().timeZone,r={"en-IN":"INR",en_IN:"INR","hi-IN":"INR",hi_IN:"INR","en-CA":"CAD",en_CA:"CAD","en-AU":"AUD",en_AU:"AUD","de-DE":"EUR",de_DE:"EUR","fr-FR":"EUR",fr_FR:"EUR","es-ES":"EUR",es_ES:"EUR","it-IT":"EUR",it_IT:"EUR","ja-JP":"JPY",ja_JP:"JPY","ko-KR":"KRW",ko_KR:"KRW","zh-CN":"CNY",zh_CN:"CNY","pt-BR":"BRL",pt_BR:"BRL","ru-RU":"RUB",ru_RU:"RUB"};if(r[t])return r[t];if(t.endsWith("-IN")||t.endsWith("_IN"))return"INR";if(n&&(n.includes("Asia/Calcutta")||n.includes("Asia/Kolkata")))return"INR";if(t.includes("en"))try{const e=new Intl.NumberFormat(t,{style:"currency",currency:"INR"});if(e.format(100).includes("\u20b9"))return"INR"}catch(e){}if(t.endsWith("-US")||t.endsWith("_US"))return"USD";if(t.endsWith("-GB")||t.endsWith("_GB"))return"GBP";if(t.endsWith("-DE")||t.endsWith("_DE")||t.endsWith("-FR")||t.endsWith("_FR")||t.endsWith("-ES")||t.endsWith("_ES")||t.endsWith("-IT")||t.endsWith("_IT"))return"EUR";return Intl.NumberFormat(t).resolvedOptions().currency||"USD"}catch(e){return"USD"}}static extractActionItem(e,t){if(this.detectActionItem(e)){let n=e.trim();n.startsWith(".")&&(n=n.substring(1).trim());const r=this.extractDueDate(e);return{id:M(),entryId:t,title:n,completed:!1,createdAt:new Date,dueDate:r}}return null}static extractDueDate(e){const t=e.toLowerCase(),n=new Date;if(n.setHours(0,0,0,0),/\btoday\b/.test(t))return new Date(n);if(/\btomorrow\b/.test(t)){const e=new Date(n);return e.setDate(e.getDate()+1),e}if(/\bday after tomorrow\b/.test(t)||/\bday after\b/.test(t)){const e=new Date(n);return e.setDate(e.getDate()+2),e}if(/\bnext week\b/.test(t)){const e=new Date(n);return e.setDate(e.getDate()+7),e}const r=t.match(/\b(one|two|three|four|\d+)\s+weeks?\s+from\s+now\b/i);if(r){const e={one:1,two:2,three:3,four:4}[r[1].toLowerCase()]||parseInt(r[1]),t=new Date(n);return t.setDate(t.getDate()+7*e),t}const o=t.match(/\b(one|two|three|four|\d+)\s+months?\s+from\s+now\b/i);if(o){const e={one:1,two:2,three:3,four:4}[o[1].toLowerCase()]||parseInt(o[1]),t=new Date(n);return t.setMonth(t.getMonth()+e),t}const a=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(let d=0;d<a.length;d++){if(new RegExp(`\\b(?:on |next )?${a[d]}\\b`,"i").test(t)){let e=d-n.getDay();e<=0&&(e+=7);const t=new Date(n);return t.setDate(t.getDate()+e),t}}const i=["january","february","march","april","may","june","july","august","september","october","november","december"],s=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];for(let d=0;d<i.length;d++){const e=new RegExp(`\\b(?:on )?(?:${i[d]}|${s[d]})[\\s,]+([0-3]?\\d)(?:st|nd|rd|th)?\\b`,"i"),r=new RegExp(`\\b(?:on )?([0-3]?\\d)(?:st|nd|rd|th)?[\\s,]+(?:${i[d]}|${s[d]})\\b`,"i");let o=t.match(e);if(o||(o=t.match(r)),o){const e=parseInt(o[1]);if(e>=1&&e<=31){const t=new Date(n.getFullYear(),d,e);return t<n&&t.setFullYear(t.getFullYear()+1),t}}}const l=t.match(/\b(?:in|after)\s+(\d+)\s+days?\b/i);if(l){const e=parseInt(l[1]),t=new Date(n);return t.setDate(t.getDate()+e),t}return new Date(n)}static extractExpenseInfo(e,t){const n=this.extractAmount(e);if(!n)return null;const r=this.extractCategoryFromText(e);return{id:M(),entryId:t,amount:n.value,currency:n.currency,description:r.description,category:r.category,createdAt:new Date}}static extractCategoryFromText(e){const t=e.toLowerCase().trim(),n=e.trim(),r=e.match(/(?:spent|paid|bought|purchased|cost|charged)\s+(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])?\s*\d+(?:\.\d{1,2})?\s+for\s+(.+)/i);if(r){const e=r[1].trim();return{category:this.mapToStandardCategory(e),description:n}}const o=e.match(/(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])?\s*\d+(?:\.\d{1,2})?\s+for\s+(.+)/i);if(o){const e=o[1].trim();return{category:this.mapToStandardCategory(e),description:n}}const a=e.match(/(?:spent|paid|bought|purchased)\s+(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])?\s*\d+(?:\.\d{1,2})?\s+on\s+(.+)/i);if(a){const e=a[1].trim();return{category:this.mapToStandardCategory(e),description:n}}const i=["haircut","salon","barber","taxi","uber","lyft","parking","toll","coffee","tea","lunch","dinner","breakfast","snack","food","groceries","shopping","movie","ticket","gas","fuel","electricity","rent","medicine","doctor","train","bus","flight","metro","subway","cab","auto"];for(const s of i)if(t.includes(s)){if("ticket"===s){const e=t.match(/\b(train|bus|flight|metro|subway)\s+ticket\b/);if(e)return{category:this.mapToStandardCategory(e[0]),description:n};const r=t.match(/\b(movie|cinema|concert|show)\s+ticket\b/);return r?{category:this.mapToStandardCategory(r[0]),description:n}:{category:this.mapToStandardCategory("ticket"),description:n}}return{category:this.mapToStandardCategory(s),description:n}}return{description:n}}static mapToStandardCategory(e){const t=e.toLowerCase().trim();return["train ticket","bus ticket","flight ticket","metro ticket","subway ticket"].some(e=>t.includes(e))||["taxi","uber","lyft","parking","toll","gas","fuel","transportation","train","bus","flight","metro","subway","cab","auto"].some(e=>t.includes(e))?"Transportation":["coffee","tea","lunch","dinner","breakfast","snack","food","groceries","restaurant","cafe"].some(e=>t.includes(e))?"Food":["haircut","salon","barber","medicine","doctor","hospital","pharmacy"].some(e=>t.includes(e))?"Health & Personal Care":["movie ticket","concert ticket","show ticket","movie","cinema","theater","entertainment"].some(e=>t.includes(e))||t.includes("ticket")&&!["train","bus","flight","metro","subway"].some(e=>t.includes(e))?"Entertainment":["electricity","rent","bill","utilities","water","internet"].some(e=>t.includes(e))?"Utilities":["shopping","clothes","clothing","shoes","accessories"].some(e=>t.includes(e))?"Shopping":e.charAt(0).toUpperCase()+e.slice(1)}static extractAmount(e){const t=e.match(/(?:Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*(\d+(?:\.\d{1,2})?)|(\d+(?:\.\d{1,2})?)/g);if(!t||0===t.length)return null;let n=null,r=0;const o=t.map(e=>{const t=e.replace(/^(Rs\.?|rs\.?|RS\.?|\u20b9|[$\u20ac\xa3])\s*/i,""),o=parseFloat(t);return!isNaN(o)&&o>0?(o>=r&&(r=o,e.includes("$")?n="USD":e.includes("\u20ac")?n="EUR":e.includes("\xa3")?n="GBP":(e.includes("\u20b9")||/Rs\.?|rs\.?|RS\.?/i.test(e))&&(n="INR")),o):NaN}).filter(e=>!isNaN(e)&&e>0);if(0===o.length)return null;return{value:Math.max(...o),currency:n||this.getSystemCurrency()}}static formatCurrency(e,t){const n=t||this.getSystemCurrency();try{let t="en-US";switch(n){case"USD":t="en-US";break;case"EUR":case"GBP":t="en-GB";break;case"INR":t="en-IN";break;case"CAD":t="en-CA";break;case"AUD":t="en-AU"}const r=new Intl.NumberFormat(t,{style:"currency",currency:n,minimumFractionDigits:2,maximumFractionDigits:2}).format(e);return"USD"===n&&r.startsWith("US$")?r.replace("US$","$"):"CAD"===n&&r.startsWith("CA$")?r.replace("CA$","C$"):r}catch(r){return`${{USD:"$",EUR:"\u20ac",GBP:"\xa3",INR:"\u20b9",CAD:"C$",AUD:"A$",JPY:"\xa5",CNY:"\xa5"}[n]||n}${e.toFixed(2)}`}}static isExpenseRelated(e){const t=e.toLowerCase();return this.EXPENSE_KEYWORDS.some(e=>t.includes(e))}}W.CURRENCY_PATTERNS=[/\b\d+(\.\d{1,2})?\b/g,/[\u20b9$\u20ac\xa3]\s*\d+(\.\d{1,2})?|\d+(\.\d{1,2})?\s*[\u20b9$\u20ac\xa3]/g,/(?:Rs\.?|rs\.?|RS\.?)\s*\d+(\.\d{1,2})?/g,/\d+(\.\d{1,2})?\s*(rupees?|dollars?|euros?|pounds?)/g],W.EXPENSE_KEYWORDS=["spent","bought","purchased","paid","cost","expense","payment","buy","pay","shopping","store","bill","receipt","charged","withdrew","withdrawal","transaction","fee","subscription"],W.ACTION_KEYWORDS=["todo","to-do","task","need to","should","must","have to","action","plan","schedule","remind","remember","don't forget","important","deadline","due","appointment","meeting","call","email","follow up","buy","get","pick up","pack","finish","complete","start","contact","reach out","check","review","submit","apply","book","reserve"];var P=n(5009),L=n(444),H=n(2656),O=n(6725);const V=()=>{{const e=O.default.get("window").width,t="undefined"!==typeof navigator?navigator.userAgent:"",n=e>768,r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t);return n&&!r}},N=({entry:e,onLongPress:t,onEdit:n,onDelete:r,markdownStyles:i,expense:s,actionItem:l})=>{const{theme:d}=E(),[u,g]=(0,o.useState)(!1),[m]=(0,o.useState)(new P.default.Value(0)),y=V(),h=L.default.create({onStartShouldSetPanResponder:()=>!y&&"system"!==e.type,onMoveShouldSetPanResponder:(t,n)=>!y&&"system"!==e.type&&Math.abs(n.dx)>5,onPanResponderMove:(e,t)=>{t.dx<0&&m.setValue(t.dx)},onPanResponderRelease:(e,t)=>{t.dx<-80?P.default.spring(m,{toValue:-80,useNativeDriver:!0}).start():P.default.spring(m,{toValue:0,useNativeDriver:!0}).start()}}),p=()=>{switch(e.type){case"expense":return(0,B.jsx)(a.default,{style:{fontSize:16,color:"#2e7d32"},children:"\ud83d\udcb0"});case"action":return(0,B.jsx)(a.default,{style:{fontSize:16,color:"#1565c0"},children:"\u2705"});default:return null}};return(0,B.jsx)(c.default,{style:"system"===e.type?F(d).systemMessageContainer:F(d).userMessageContainer,children:(0,B.jsx)(c.default,{style:F(d).bubbleWrapper,children:(0,B.jsxs)(P.default.View,Object.assign({},h.panHandlers,{style:[{flexDirection:"row",transform:[{translateX:m}]}]},y&&"system"!==e.type?{onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1)}:{},{children:[(0,B.jsx)(f.default,{activeOpacity:1,onLongPress:"system"!==e.type?()=>{n&&n(e)}:void 0,delayLongPress:500,disabled:y&&"system"!==e.type,style:(()=>{const t=F(d),n=[t.messageBubble],r="system"===e.type?t.systemMessage:t.userMessage;switch(e.type){case"expense":return[...n,t.expenseBubble,r];case"action":return[...n,t.actionBubble,r];case"system":return[...n,t.systemBubble,r];default:return[...n,t.defaultBubble,r]}})(),children:(0,B.jsx)(()=>{const t=F(d);return(0,B.jsxs)(c.default,{style:{flex:1},children:[(0,B.jsxs)(c.default,{style:t.messageHeader,children:[p(),(0,B.jsx)(a.default,{style:t.timestamp,children:(0,R.default)(e.timestamp,"HH:mm")}),"system"!==e.type&&y&&u&&(0,B.jsxs)(c.default,{style:t.actionButtons,children:[n&&(0,B.jsx)(f.default,{style:t.actionButton,onPress:()=>n(e),hitSlop:{top:10,bottom:10,left:10,right:10},children:(0,B.jsx)(a.default,{style:t.actionButtonText,children:"\u270f\ufe0f Edit"})}),r&&(0,B.jsx)(f.default,{style:[t.actionButton,t.deleteButton],onPress:t=>{t.stopPropagation(),window.confirm("Are you sure you want to delete this entry?")&&r(e)},hitSlop:{top:10,bottom:10,left:10,right:10},children:(0,B.jsx)(a.default,{style:t.actionButtonText,children:"\ud83d\uddd1\ufe0f Delete"})})]})]}),"system"!==e.type&&!y&&(0,B.jsx)(a.default,{style:t.gestureHint,children:"Long press to edit \u2022 Swipe left to delete"}),e.isMarkdown?(0,B.jsx)(H.default,{style:i,children:e.text}):(0,B.jsx)(a.default,{style:[t.messageText,"system"===e.type?t.systemMessageText:"log"===e.type?t.userMessageText:t.nonUserMessageText],selectable:!0,children:e.text})]})},{})}),!y&&"system"!==e.type&&(0,B.jsx)(f.default,{style:F(d).deleteIndicator,onPress:()=>{r&&r(e),P.default.spring(m,{toValue:0,useNativeDriver:!0}).start()},children:(0,B.jsx)(a.default,{style:{fontSize:24,color:"#f44336"},children:"\ud83d\uddd1\ufe0f"})})]}))})})},F=e=>m.default.create({userMessageContainer:{marginVertical:4,alignSelf:"flex-start",maxWidth:"90%",flexShrink:0},systemMessageContainer:{marginVertical:4,alignSelf:"flex-end",maxWidth:"90%",flexShrink:0},bubbleWrapper:{position:"relative",overflow:"hidden"},deleteIndicator:{position:"absolute",right:-80,top:0,bottom:0,width:80,backgroundColor:"transparent",justifyContent:"center",alignItems:"center",borderRadius:12},messageContainer:{marginVertical:1,alignSelf:"flex-start",maxWidth:"95%"},messageBubble:Object.assign({paddingHorizontal:12,paddingVertical:8,minWidth:200,maxWidth:"100%",alignSelf:"flex-start",borderRadius:12},{boxShadow:"0px 1px 1px rgba(0, 0, 0, 0.18)"}),defaultBubble:{backgroundColor:e.input},expenseBubble:{backgroundColor:e.success+"22",borderColor:e.success,borderWidth:1},actionBubble:{backgroundColor:e.info+"22",borderColor:e.info,borderWidth:1},systemBubble:{backgroundColor:e.info+"22",borderColor:e.info,borderWidth:1,borderRadius:12},systemMessage:{backgroundColor:e.info+"22",marginLeft:"15%",borderTopLeftRadius:20,borderTopRightRadius:5,borderBottomLeftRadius:20,borderBottomRightRadius:5},userMessage:{backgroundColor:e.input,marginRight:"15%",borderTopLeftRadius:5,borderTopRightRadius:20,borderBottomLeftRadius:5,borderBottomRightRadius:20},messageHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:4,flexWrap:"wrap",minWidth:200},actionButtons:{flexDirection:"row",gap:4,alignItems:"center"},actionButton:{flexDirection:"row",alignItems:"center",padding:4,paddingHorizontal:6,borderRadius:4,backgroundColor:e.input},deleteButton:{backgroundColor:e.error+"22"},actionButtonText:{fontSize:12},gestureHint:{fontSize:9,color:e.textSecondary,fontStyle:"italic",marginBottom:4},timestamp:{fontSize:10,color:e.textSecondary,marginLeft:4},messageText:Object.assign({fontSize:15,lineHeight:20},{userSelect:"text",WebkitUserSelect:"text",display:"inline-block",minWidth:"fit-content"}),userMessageText:{color:e.text},systemMessageText:{color:e.info,fontSize:14,textAlign:"left",fontWeight:"500"},nonUserMessageText:{color:e.text},categoryLabel:{fontSize:11,color:e.textSecondary,fontStyle:"italic",marginTop:2,flexShrink:1,flexWrap:"wrap"}}),$=({item:e,expense:t,actionItem:n,onEdit:r,onDelete:i,markdownStyles:s,layoutStyles:l})=>{const d=V(),[u]=(0,o.useState)(new P.default.Value(0)),[g,m]=(0,o.useState)(!1),y=d?{panHandlers:{}}:L.default.create({onStartShouldSetPanResponder:()=>"system"!==e.type,onMoveShouldSetPanResponder:(t,n)=>"system"!==e.type&&Math.abs(n.dx)>5,onPanResponderMove:(e,t)=>{t.dx<0&&u.setValue(t.dx)},onPanResponderRelease:(e,t)=>{t.dx<-80?P.default.spring(u,{toValue:-80,useNativeDriver:!0}).start():P.default.spring(u,{toValue:0,useNativeDriver:!0}).start()}});return(0,B.jsx)(c.default,{style:{position:"relative",overflow:"hidden"},children:(0,B.jsxs)(P.default.View,Object.assign({},d?{}:y.panHandlers,{style:[{flexDirection:"row"},!d&&{transform:[{translateX:u}]}],children:[(0,B.jsx)(f.default,Object.assign({activeOpacity:1,style:{flex:1},onPress:()=>{d||m(!g)},onLongPress:()=>{d||"system"===e.type||r(e)},delayLongPress:500},d?{onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1)}:{},{children:(0,B.jsxs)(c.default,{style:l.minimalContainer,children:[(0,B.jsxs)(c.default,{style:l.minimalContent,children:[(0,B.jsx)(c.default,{style:{flex:1,minWidth:0,marginRight:4},children:e.isMarkdown?(0,B.jsx)(H.default,{style:s,children:e.text}):(0,B.jsx)(a.default,{style:l.minimalText,numberOfLines:1,ellipsizeMode:"tail",children:e.text})}),t&&(0,B.jsx)(a.default,{style:{fontSize:14,flexShrink:0},children:"\ud83d\udcb0"}),n&&(0,B.jsx)(a.default,{style:{fontSize:14,flexShrink:0},children:"\u2705"})]}),(0,B.jsxs)(c.default,{style:l.minimalMeta,children:[g&&(0,B.jsx)(a.default,{style:l.minimalTime,children:(0,R.default)(e.timestamp,"h:mm a")}),"system"!==e.type&&d&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(f.default,{style:{padding:2,backgroundColor:"rgba(0,0,0,0.05)",borderRadius:4,marginLeft:4},onPress:()=>r(e),children:(0,B.jsx)(a.default,{style:{fontSize:10},children:"\u270f\ufe0f"})}),(0,B.jsx)(f.default,{style:{padding:2,backgroundColor:"rgba(0,0,0,0.05)",borderRadius:4,marginLeft:2},onPress:()=>{window.confirm("Are you sure you want to delete this entry?")&&i(e)},children:(0,B.jsx)(a.default,{style:{fontSize:10},children:"\ud83d\uddd1\ufe0f"})})]})]})]})})),!d&&"system"!==e.type&&(0,B.jsx)(f.default,{style:U.deleteIndicator,onPress:()=>{i(e),P.default.spring(u,{toValue:0,useNativeDriver:!0}).start()},children:(0,B.jsx)(a.default,{style:{fontSize:24,color:"#f44336"},children:"\ud83d\uddd1\ufe0f"})})]}))})},U=m.default.create({deleteIndicator:{position:"absolute",right:-80,top:0,bottom:0,width:80,backgroundColor:"transparent",justifyContent:"center",alignItems:"center"}});var _=n(4037),q=n(2772);const J={isMarkdownEnabled:!0,enterToSend:!0,systemCurrency:"AUTO",layoutStyle:"chat",theme:"system"},Y=[{code:"AUTO",name:"Auto-detect",symbol:"\ud83c\udf0d"},{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:"\u20ac"},{code:"GBP",name:"British Pound",symbol:"\xa3"},{code:"INR",name:"Indian Rupee",symbol:"\u20b9"},{code:"CAD",name:"Canadian Dollar",symbol:"C$"},{code:"AUD",name:"Australian Dollar",symbol:"A$"},{code:"JPY",name:"Japanese Yen",symbol:"\xa5"}],G=[{id:"light",name:"Light Mode",icon:"\u2600\ufe0f"},{id:"dark",name:"Dark Mode",icon:"\ud83c\udf19"},{id:"system",name:"System Default",icon:"\u2699\ufe0f"}],K=({onClose:e,onExportText:t,onExportJSON:n,onImport:r,onBackup:i,onRestore:s})=>{const{theme:l,isDark:d,setThemeMode:u,themeMode:g}=E(),[m,h]=(0,o.useState)(J),[b,j]=(0,o.useState)(!1),[w,S]=(0,o.useState)(!1),[C,k]=(0,o.useState)(!1);(0,o.useEffect)(()=>{T()},[]);const T=async()=>{try{const e=await D.getSettings();e&&h(Object.assign({},J,e))}catch(e){console.error("Error loading settings:",e)}},v=(e,t)=>{console.log(`Updating setting ${String(e)} to ${t}`);(async e=>{try{console.log("Saving settings:",e),await D.saveSettings(e),h(e),console.log("Settings saved successfully")}catch(t){console.error("Error saving settings:",t),y.default.alert("Error","Failed to save settings")}})(Object.assign({},m,{[e]:t}))},I=[{id:"chat",name:"Chat Style",icon:"\ud83d\udcac"},{id:"cards",name:"Card Layout",icon:"\ud83c\udccf"},{id:"timeline",name:"Timeline Style",icon:"\u23f0"},{id:"minimal",name:"Minimal Design",icon:"\u2728"}],A=X(l),z=Q(l);return(0,B.jsxs)(x.SafeAreaView,{style:A.container,children:[(0,B.jsxs)(c.default,{style:A.header,children:[(0,B.jsx)(a.default,{style:A.headerTitle,children:"Settings"}),(0,B.jsx)(f.default,{onPress:e,style:A.closeButton,children:(0,B.jsx)(a.default,{style:A.closeButtonText,children:"\u2715"})})]}),(0,B.jsxs)(q.default,{style:A.content,children:[(0,B.jsxs)(c.default,{style:A.section,children:[(0,B.jsx)(a.default,{style:A.sectionTitle,children:"Text Input"}),(0,B.jsxs)(c.default,{style:A.settingItem,children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Enable Markdown"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Format text with **bold**, *italic*, and other markdown syntax"})]}),(0,B.jsx)(_.default,{value:m.isMarkdownEnabled,onValueChange:e=>v("isMarkdownEnabled",e)})]}),(0,B.jsxs)(c.default,{style:A.settingItem,children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Enter to Send"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Press Enter to send message (off = Enter adds new line)"})]}),(0,B.jsx)(_.default,{value:m.enterToSend,onValueChange:e=>v("enterToSend",e)})]})]}),(0,B.jsxs)(c.default,{style:A.section,children:[(0,B.jsx)(a.default,{style:A.sectionTitle,children:"Currency"}),(0,B.jsxs)(f.default,{style:A.settingItem,onPress:()=>{console.log("Currency picker tapped"),console.log("Setting showCurrencyModal to true"),j(!0)},children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Default Currency"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Currency for expenses (when not explicitly specified)"}),(0,B.jsx)(a.default,{style:A.settingValue,children:(()=>{const e=Y.find(e=>e.code===m.systemCurrency);return e?`${e.symbol} ${e.name}`:"Auto-detect"})()})]}),(0,B.jsx)(a.default,{style:A.arrow,children:"\u203a"})]})]}),(0,B.jsxs)(c.default,{style:A.section,children:[(0,B.jsx)(a.default,{style:A.sectionTitle,children:"Appearance"}),(0,B.jsxs)(f.default,{style:A.settingItem,onPress:()=>{console.log("Theme picker tapped"),k(!0)},children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Theme"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Choose your color theme preference"}),(0,B.jsx)(a.default,{style:A.settingValue,children:(()=>{const e=m.theme||"system",t=G.find(t=>t.id===e);return t?`${t.icon} ${t.name}`:"\u2699\ufe0f System Default"})()})]}),(0,B.jsx)(a.default,{style:A.arrow,children:"\u203a"})]}),(0,B.jsxs)(f.default,{style:A.settingItem,onPress:()=>{console.log("Layout picker tapped"),console.log("Setting showLayoutModal to true"),S(!0)},children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Journal Layout"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Choose how your journal entries are displayed"}),(0,B.jsx)(a.default,{style:A.settingValue,children:(()=>{const e=I.find(e=>e.id===m.layoutStyle);return e?`${e.icon} ${e.name}`:"\ud83d\udcac Chat Style"})()})]}),(0,B.jsx)(a.default,{style:A.arrow,children:"\u203a"})]})]}),(0,B.jsxs)(c.default,{style:A.section,children:[(0,B.jsx)(a.default,{style:A.sectionTitle,children:"Data Management"}),(0,B.jsxs)(f.default,{style:A.settingItem,onPress:t,children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Export as Text"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Download all entries as a formatted text file"})]}),(0,B.jsx)(a.default,{style:A.arrow,children:"\u203a"})]}),(0,B.jsxs)(f.default,{style:A.settingItem,onPress:n,children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Export as JSON"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Download all data for backup or import"})]}),(0,B.jsx)(a.default,{style:A.arrow,children:"\u203a"})]}),(0,B.jsxs)(f.default,{style:A.settingItem,onPress:r,children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Import Data"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Import entries from a JSON file"})]}),(0,B.jsx)(a.default,{style:A.arrow,children:"\u203a"})]}),(0,B.jsx)(c.default,{style:A.divider}),(0,B.jsxs)(f.default,{style:A.settingItem,onPress:i,children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Create Backup"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Save a backup of all your data"})]}),(0,B.jsx)(a.default,{style:A.arrow,children:"\u203a"})]}),(0,B.jsxs)(f.default,{style:A.settingItem,onPress:s,children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Restore from Backup"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Restore your data from a previous backup"})]}),(0,B.jsx)(a.default,{style:A.arrow,children:"\u203a"})]}),(0,B.jsx)(c.default,{style:A.divider}),(0,B.jsxs)(f.default,{style:[A.settingItem,A.dangerSettingItem],onPress:async()=>{console.log("handleClearJournal called");if(window.confirm("This will delete all journal entries but keep your expenses and tasks. Continue?"))try{console.log("Clearing journal entries...");const e=await D.getEntries();console.log(`Found ${e.length} entries to clear`),await D.saveEntries([]),console.log("Journal entries cleared successfully"),window.alert("Journal entries cleared. Your expenses and tasks are safe. Please refresh the journal tab.")}catch(e){console.error("Error clearing journal:",e),window.alert("Failed to clear journal entries")}},children:[(0,B.jsxs)(c.default,{style:A.settingInfo,children:[(0,B.jsx)(a.default,{style:[A.settingLabel,A.dangerText],children:"Clear Journal Entries"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Delete all journal entries while keeping expenses and tasks"})]}),(0,B.jsx)(a.default,{style:[A.arrow,A.dangerText],children:"\u203a"})]})]}),(0,B.jsxs)(c.default,{style:A.section,children:[(0,B.jsx)(a.default,{style:A.sectionTitle,children:"About"}),(0,B.jsxs)(c.default,{style:A.settingItem,children:[(0,B.jsx)(a.default,{style:A.settingLabel,children:"Daily Tracker"}),(0,B.jsx)(a.default,{style:A.settingDescription,children:"Smart journal with automatic expense and task detection"})]})]})]}),(0,B.jsx)(p.default,{visible:b,animationType:"slide",transparent:!0,onRequestClose:()=>j(!1),children:(0,B.jsx)(c.default,{style:z.overlay,children:(0,B.jsxs)(c.default,{style:z.container,children:[(0,B.jsx)(a.default,{style:z.title,children:"Select Currency"}),(0,B.jsx)(a.default,{style:z.subtitle,children:"Choose your preferred currency:"}),(0,B.jsx)(q.default,{style:z.optionsList,showsVerticalScrollIndicator:!0,children:Y.map(e=>(0,B.jsxs)(f.default,{style:[z.option,m.systemCurrency===e.code&&z.selectedOption],onPress:()=>{v("systemCurrency",e.code),j(!1)},children:[(0,B.jsxs)(a.default,{style:[z.optionText,m.systemCurrency===e.code&&z.selectedOptionText],children:[e.symbol," ",e.name]}),m.systemCurrency===e.code&&(0,B.jsx)(a.default,{style:z.checkmark,children:"\u2713"})]},e.code))}),(0,B.jsx)(f.default,{style:z.cancelButton,onPress:()=>j(!1),children:(0,B.jsx)(a.default,{style:z.cancelButtonText,children:"Cancel"})})]})})}),(0,B.jsx)(p.default,{visible:w,animationType:"slide",transparent:!0,onRequestClose:()=>S(!1),children:(0,B.jsx)(c.default,{style:z.overlay,children:(0,B.jsxs)(c.default,{style:z.container,children:[(0,B.jsx)(a.default,{style:z.title,children:"Select Layout Style"}),(0,B.jsx)(a.default,{style:z.subtitle,children:"Choose how your journal entries are displayed:"}),(0,B.jsx)(q.default,{style:z.optionsList,showsVerticalScrollIndicator:!0,children:I.map(e=>(0,B.jsxs)(f.default,{style:[z.option,m.layoutStyle===e.id&&z.selectedOption],onPress:()=>{v("layoutStyle",e.id),S(!1)},children:[(0,B.jsxs)(a.default,{style:[z.optionText,m.layoutStyle===e.id&&z.selectedOptionText],children:[e.icon," ",e.name]}),m.layoutStyle===e.id&&(0,B.jsx)(a.default,{style:z.checkmark,children:"\u2713"})]},e.id))}),(0,B.jsx)(f.default,{style:z.cancelButton,onPress:()=>S(!1),children:(0,B.jsx)(a.default,{style:z.cancelButtonText,children:"Cancel"})})]})})}),(0,B.jsx)(p.default,{visible:C,animationType:"slide",transparent:!0,onRequestClose:()=>k(!1),children:(0,B.jsx)(c.default,{style:z.overlay,children:(0,B.jsxs)(c.default,{style:z.container,children:[(0,B.jsx)(a.default,{style:z.title,children:"Select Theme"}),(0,B.jsx)(a.default,{style:z.subtitle,children:"Choose your preferred color theme:"}),(0,B.jsx)(q.default,{style:z.optionsList,showsVerticalScrollIndicator:!0,children:G.map(e=>(0,B.jsxs)(f.default,{style:[z.option,g===e.id&&z.selectedOption],onPress:()=>{u(e.id),v("theme",e.id),k(!1)},children:[(0,B.jsxs)(a.default,{style:[z.optionText,g===e.id&&z.selectedOptionText],children:[e.icon," ",e.name]}),g===e.id&&(0,B.jsx)(a.default,{style:z.checkmark,children:"\u2713"})]},e.id))}),(0,B.jsx)(f.default,{style:z.cancelButton,onPress:()=>k(!1),children:(0,B.jsx)(a.default,{style:z.cancelButtonText,children:"Cancel"})})]})})})]})},X=e=>m.default.create({container:{flex:1,backgroundColor:e.background},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:16,paddingVertical:12,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},headerTitle:{fontSize:20,fontWeight:"bold",color:e.text},closeButton:{padding:8,borderRadius:20,backgroundColor:e.input},closeButtonText:{fontSize:16,color:e.textSecondary,fontWeight:"bold"},content:{flex:1},section:{backgroundColor:e.surface,marginVertical:8,paddingVertical:8},sectionTitle:{fontSize:16,fontWeight:"bold",color:e.text,paddingHorizontal:16,paddingVertical:8,backgroundColor:e.input},settingItem:{flexDirection:"row",alignItems:"center",paddingHorizontal:16,paddingVertical:12,borderBottomWidth:1,borderBottomColor:e.divider},settingInfo:{flex:1,marginRight:12},settingLabel:{fontSize:16,color:e.text,marginBottom:4},settingDescription:{fontSize:14,color:e.textSecondary,lineHeight:18},settingValue:{fontSize:14,color:"#007AFF",marginTop:4,fontWeight:"500"},arrow:{fontSize:20,color:"#ccc"},dangerSettingItem:{backgroundColor:"#fff0f0"},dangerText:{color:"#d32f2f"},divider:{height:8,backgroundColor:e.background,marginVertical:8}}),Q=e=>m.default.create({overlay:{flex:1,backgroundColor:e.overlay,justifyContent:"center",alignItems:"center",paddingHorizontal:20},container:{backgroundColor:e.surface,borderRadius:12,width:"100%",maxWidth:400,minHeight:300,maxHeight:"80%",paddingVertical:20},title:{fontSize:20,fontWeight:"bold",color:e.text,textAlign:"center",marginBottom:8},subtitle:{fontSize:16,color:e.textSecondary,textAlign:"center",marginBottom:20,paddingHorizontal:20},optionsList:{flexGrow:1,minHeight:200},option:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:20,paddingVertical:16,borderBottomWidth:1,borderBottomColor:e.divider,minHeight:50},selectedOption:{backgroundColor:e.highlight},optionText:{fontSize:16,color:e.text,flex:1},selectedOptionText:{color:e.primary,fontWeight:"500"},checkmark:{fontSize:18,color:e.primary,fontWeight:"bold"},cancelButton:{marginTop:20,marginHorizontal:20,paddingVertical:12,backgroundColor:e.background,borderRadius:8,alignItems:"center"},cancelButtonText:{fontSize:16,color:e.text,fontWeight:"500"}}),Z=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),ee=()=>{const{theme:e,isDark:t}=E(),[n,r]=(0,o.useState)([]),[i,s]=(0,o.useState)(""),[l,d]=(0,o.useState)(!0),[m,b]=(0,o.useState)(0),j=(0,o.useRef)(null),w=(0,o.useRef)(null),S=((0,o.useRef)(!1),(0,o.useRef)(!0),(0,o.useRef)(!1)),[C,k]=(0,o.useState)(!0),[T,v]=(0,o.useState)(!1),[I,A]=(0,o.useState)("chat"),[z,M]=(0,o.useState)(""),[P,L]=(0,o.useState)(!1),[H,O]=(0,o.useState)([]),[V,F]=(0,o.useState)(null),[U,_]=(0,o.useState)(!1),[q,J]=(0,o.useState)([]),[Y,G]=(0,o.useState)([]),[X,Q]=(0,o.useState)(!1),[ee,oe]=(0,o.useState)(!1),[ae,ie]=(0,o.useState)(null),[se,le]=(0,o.useState)(""),[de,ce]=(0,o.useState)(""),[ue,fe]=(0,o.useState)(""),[ge,me]=(0,o.useState)(null),ye=["spent Rs150 for coffee","bought groceries for $45.50","paid \u20b92500 for electricity bill","lunch cost $12.99","purchased fuel Rs3200","500 for haircut","\u20b9300 for taxi","50 for parking","spent 200 on movie ticket","paid $25 for gym membership","dinner cost Rs850","need to call mom tomorrow","todo: finish the quarterly report","must submit tax documents by Friday","reminder: doctor appointment at 3pm","should book flight tickets",". pick up dry cleaning",". schedule dentist appointment",". buy birthday gift for Sarah",". pay credit card bill","todo: prepare presentation slides","had a great meeting today","weather is lovely","feeling productive this morning","learned something new about React Native","grateful for a good day","enjoyed my morning coffee","finished reading a great book","went for a long walk","cooked a delicious meal","watched an interesting documentary","had a video call with friends","organized my workspace","tried a new recipe today","listened to a great podcast","feeling motivated and energized","completed my daily workout","spent quality time with family","practiced meditation for 20 minutes","wrote in my journal","started learning a new skill","cleaned and organized my room","discovered a new favorite song","made progress on personal project","helped a friend with their work","reflected on my goals","enjoyed the sunset","read an inspiring article","practiced gratitude","had a relaxing evening","played games with friends","explored a new neighborhood","tried a new coffee shop","attended an online webinar","updated my resume","planned next week's schedule","sorted through old photos","donated unused items","fixed a bug in my code","reviewed my budget","called an old friend","planted some herbs","rearranged furniture","learned a new keyboard shortcut","backed up my data","cleaned out my inbox","updated my software","read documentation","wrote unit tests","refactored some code","debugged an issue","improved performance","added new features","reviewed pull requests","attended standup meeting","brainstormed ideas","sketched UI designs","created wireframes","wrote technical specs","researched best practices","optimized database queries","configured CI/CD pipeline","set up monitoring","analyzed metrics","documented API endpoints","reviewed architecture","planned sprint tasks","estimated story points","pair programmed with teammate","conducted code review","deployed to staging","tested new feature","fixed production bug","updated dependencies","wrote blog post","shared knowledge with team","mentored junior developer","attended tech talk","experimented with new library","built proof of concept","improved accessibility","enhanced security","reduced technical debt","improved error handling","added logging","created dashboard","automated workflow","simplified complex logic","improved user experience","gathered user feedback","analyzed usage patterns","identified bottlenecks","proposed solution","implemented caching","optimized bundle size","improved load time","enhanced mobile experience","added dark mode","created design system","standardized components","improved code coverage","fixed flaky tests","upgraded framework version","migrated to new API","cleaned up legacy code","consolidated services","improved modularity","reduced coupling","enhanced maintainability","documented codebase","created runbook"],he=(0,o.useCallback)(async()=>{const e=(await D.getEntries()).sort((e,t)=>{if(Math.abs(e.timestamp.getTime()-t.timestamp.getTime())<2e3){if("system"===e.type&&"system"!==t.type)return 1;if("system"!==e.type&&"system"===t.type)return-1}return e.timestamp.getTime()-t.timestamp.getTime()});r(e),O(e),S.current=!1},[]),pe=(0,o.useCallback)(e=>{if(0===e.length)return[];const t=[...e].sort((e,t)=>e.timestamp.getTime()-t.timestamp.getTime()),n=[];let r="";return t.forEach(e=>{const t=(0,R.default)(e.timestamp,"yyyy-MM-dd");t!==r&&(n.push({type:"dateSeparator",date:t,id:`date-${t}`}),r=t),n.push(e)}),n},[]);(0,o.useEffect)(()=>{if(!P)return void O(n);let e=n;if(V){const t=new Date(V);t.setHours(0,0,0,0),e=e.filter(e=>{if("system"===e.type)return!1;const n=new Date(e.timestamp);return n.setHours(0,0,0,0),n.getTime()===t.getTime()})}if(z.trim()){const t=z.toLowerCase().trim();e=e.filter(e=>"system"!==e.type&&(!!e.text.toLowerCase().includes(t)||!!e.type.toLowerCase().includes(t)))}O(e)},[z,n,V,P]);const xe=(0,o.useCallback)(async()=>{try{const e=await D.getSettings();e&&(d(e.isMarkdownEnabled),k(e.enterToSend),A(e.layoutStyle||"chat"))}catch(e){console.error("Error loading settings:",e)}},[]),be=(0,o.useCallback)(async()=>{try{const[e,t]=await Promise.all([D.getExpenses(),D.getActionItems()]);let n=!1;const r=t.map(e=>e.dueDate?e:(n=!0,Object.assign({},e,{dueDate:e.createdAt||new Date})));n?(await D.saveActionItems(r),G(r)):G(t),J(e)}catch(e){console.error("Error loading expenses and action items:",e)}},[]);(0,o.useEffect)(()=>{he(),xe(),be()},[he,xe,be]);const je=e=>{alert(e)},we=async()=>{const e=i.trim();if(e)try{let t=e;const n=W.detectActionItem(e);(n||ee)&&(t=e.replace(/^\s*\.\s*/,"\u2705 "));const r={id:Z(),text:t,timestamp:new Date,type:"log",isMarkdown:l};await D.addEntry(r);const o=W.detectExpense(e);if(o||X){const t=W.extractExpenseInfo(e,r.id);t?(t.autoDetected=o&&!X,await D.addExpense(t),await ve(r.id,"expense")):X&&y.default.alert("No Amount Found","Please include a numeric amount in your entry (e.g., 150, Rs200, $50)")}if(n||ee){let t;if(ee&&!n){const n=W.extractDueDate(e);t={id:Z(),entryId:r.id,title:e,completed:!1,createdAt:new Date,dueDate:n,autoDetected:!1}}else t=W.extractActionItem(e,r.id),t&&(t.autoDetected=n&&!ee);t&&(await D.addActionItem(t),await ve(r.id,"action"))}if(await he(),await be(),"chat"===I){let e="",t=!1,n=!1;const o=await D.getExpenses().then(e=>e.find(e=>e.entryId===r.id));if(o){t=!0;e=`\ud83d\udcb0 ${o.autoDetected?"Auto-categorized":"Manually categorized"} as Expense: ${W.formatCurrency(o.amount,o.currency)}`,o.category&&(e+=` (${o.category})`)}if(!t){const t=await D.getActionItems().then(e=>e.find(e=>e.entryId===r.id));if(t){n=!0;e=`\u2705 ${t.autoDetected?"Auto-categorized":"Manually categorized"} as Task: ${t.title}`}}if(t||n||(e="\u2713 Got it!"),e){const t={id:Z(),text:e,timestamp:new Date(Date.now()+100),type:"system",isMarkdown:!1};await D.addEntry(t),await he()}}s(""),Q(!1),oe(!1),setTimeout(()=>{j.current?.scrollToOffset({offset:0,animated:!0})},100),setTimeout(()=>{w.current&&w.current.focus()},150)}catch(t){console.error("Error processing message:",t),je("Failed to process message")}},Se=e=>{const t=[{text:"Edit Entry",onPress:()=>Be(e)}];"expense"!==e.type&&t.push({text:"Mark as Expense",onPress:()=>Ce(e)}),"action"!==e.type&&t.push({text:"Mark as Action Item",onPress:()=>ke(e)}),"log"!==e.type&&t.push({text:"Remove Category",onPress:()=>Te(e)}),t.push({text:"Delete Entry",onPress:()=>De(e),style:"destructive"},{text:"Cancel",style:"cancel"}),y.default.alert("Entry Options","What would you like to do with this entry?",t)},Ce=async e=>{if("expense"===e.type)return;const t=W.extractExpenseInfo(e.text,e.id);t?(t.autoDetected=!1,await D.addExpense(t),await ve(e.id,"expense"),await be()):y.default.alert("Cannot Extract Expense","Could not find amount information in this entry. Please ensure it contains a monetary value.")},ke=async e=>{if("action"===e.type)return;let t=W.extractActionItem(e.text,e.id);t?t.autoDetected=!1:t={id:Z(),entryId:e.id,title:e.text.replace(/^\u2705\s*/,""),completed:!1,createdAt:new Date,autoDetected:!1},await D.addActionItem(t),await ve(e.id,"action"),await be()},Te=async e=>{try{if("expense"===e.type){const t=q.find(t=>t.entryId===e.id);t&&await D.deleteExpense(t.id)}else if("action"===e.type){const t=Y.find(t=>t.entryId===e.id);t&&await D.deleteActionItem(t.id)}await ve(e.id,"log"),await be(),je("Category removed")}catch(t){console.error("Error removing category:",t),je("Failed to remove category")}},De=async e=>{confirm("Are you sure you want to delete this entry?")&&await(async()=>{try{if("expense"===e.type){const t=q.find(t=>t.entryId===e.id);t&&await D.deleteExpense(t.id)}else if("action"===e.type){const t=Y.find(t=>t.entryId===e.id);t&&await D.deleteActionItem(t.id)}const t=(await D.getEntries()).filter(t=>t.id!==e.id);await D.saveEntries(t),await he(),await be()}catch(t){console.error("Error deleting entry:",t)}})()},Be=e=>{if(ie(e),le(e.text.replace(/^\u2705\s*/,"")),"expense"===e.type){const t=q.find(t=>t.entryId===e.id);t&&(ce(t.amount.toString()),fe(t.category||""))}if("action"===e.type){const t=Y.find(t=>t.entryId===e.id);t&&t.dueDate?me(new Date(t.dueDate)):me(new Date)}},ve=async(e,t)=>{try{const n=(await D.getEntries()).map(n=>n.id===e?Object.assign({},n,{type:t}):n);await D.saveEntries(n),await he()}catch(n){console.error("Error updating entry type:",n),je("Failed to update entry type")}},Ie=te(e),Ae=ne(e),ze=re(e);return(0,B.jsxs)(x.SafeAreaView,{style:Ie.container,children:[(0,B.jsxs)(c.default,{style:[Ie.header,{zIndex:1e4}],children:[(0,B.jsx)(a.default,{style:Ie.headerTitle,children:"Daily Journal"}),(0,B.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center",zIndex:10001},children:[(0,B.jsx)(f.default,{style:[Ie.settingsButton,{marginRight:8,zIndex:10004}],onPress:()=>{m>=ye.length&&b(0),s(ye[m]),b(m+1)},children:(0,B.jsx)(a.default,{style:Ie.settingsButtonText,children:"\ud83e\uddea"})}),(0,B.jsx)(f.default,{style:[Ie.settingsButton,{marginRight:8,zIndex:10002}],onPress:()=>{L(!P)},children:(0,B.jsx)(a.default,{style:Ie.settingsButtonText,children:"\ud83d\udd0d"})}),(0,B.jsx)(f.default,{style:[Ie.settingsButton,{zIndex:10003}],onPress:()=>{v(!0)},children:(0,B.jsx)(a.default,{style:Ie.settingsButtonText,children:"\u2699\ufe0f"})})]})]}),P&&(0,B.jsxs)(c.default,{style:Ie.searchContainer,children:[(0,B.jsxs)(c.default,{style:Ie.searchSection,children:[(0,B.jsx)(a.default,{style:Ie.searchLabel,children:"Search by Text:"}),(0,B.jsxs)(c.default,{style:Ie.searchRow,children:[(0,B.jsx)(u.default,{style:Ie.searchInput,placeholder:"Search entries...",value:z,onChangeText:M,autoCapitalize:"none",clearButtonMode:"while-editing"}),z.length>0&&(0,B.jsx)(f.default,{style:Ie.clearButton,onPress:()=>M(""),children:(0,B.jsx)(a.default,{style:Ie.clearButtonText,children:"\u2715"})})]})]}),(0,B.jsxs)(c.default,{style:Ie.dateSection,children:[(0,B.jsx)(a.default,{style:Ie.searchLabel,children:"Filter by Date:"}),(0,B.jsxs)(c.default,{style:Ie.datePickerButtonLarge,children:[(0,B.jsx)(a.default,{style:Ie.datePickerIconLarge,children:"\ud83d\udcc5"}),(0,B.jsx)("input",{type:"date",style:{flex:1,border:"none",background:"transparent",fontSize:16,color:e.text,outline:"none",cursor:"pointer"},onChange:e=>{e.target.value?F(new Date(e.target.value)):F(null)},value:V?(0,R.default)(V,"yyyy-MM-dd"):"",placeholder:"Select Date"}),V&&(0,B.jsx)(f.default,{onPress:e=>{e.stopPropagation(),F(null)},style:Ie.datePickerClear,children:(0,B.jsx)(a.default,{style:Ie.datePickerClearText,children:"\u2715"})})]})]}),(z||V)&&(0,B.jsx)(f.default,{style:Ie.clearAllButton,onPress:()=>{M(""),F(null)},children:(0,B.jsx)(a.default,{style:Ie.clearAllButtonText,children:"Clear All Filters"})})]}),(0,B.jsx)(g.default,{ref:j,data:pe(P?H:n).reverse(),renderItem:({item:e})=>{if("type"in e&&"dateSeparator"===e.type)return(e=>{const t=new Date(e),n=new Date,r=new Date(n.getTime()-864e5);let o;return o=(0,R.default)(t,"yyyy-MM-dd")===(0,R.default)(n,"yyyy-MM-dd")?"Today":(0,R.default)(t,"yyyy-MM-dd")===(0,R.default)(r,"yyyy-MM-dd")?"Yesterday":(0,R.default)(t,"EEEE, MMMM d, yyyy"),(0,B.jsxs)(c.default,{style:Ie.dateSeparator,children:[(0,B.jsx)(c.default,{style:Ie.dateSeparatorLine}),(0,B.jsx)(a.default,{style:Ie.dateSeparatorText,children:o}),(0,B.jsx)(c.default,{style:Ie.dateSeparatorLine})]})})(e.date);const t=e,n="expense"===t.type?q.find(e=>e.entryId===t.id):void 0,r="action"===t.type?Y.find(e=>e.entryId===t.id):void 0;switch(I){case"cards":return((e,t,n)=>(0,B.jsx)(c.default,{style:Ae.cardContainer,children:(0,B.jsx)(N,{entry:e,onLongPress:Se,onEdit:Be,onDelete:De,markdownStyles:ze,expense:t,actionItem:n})}))(t,n,r);case"list":return((e,t,n)=>(0,B.jsx)(c.default,{style:Ae.listContainer,children:(0,B.jsx)(N,{entry:e,onLongPress:Se,onEdit:Be,onDelete:De,markdownStyles:ze,expense:t,actionItem:n})}))(t,n,r);case"timeline":return((e,t,n)=>(0,B.jsxs)(c.default,{style:Ae.timelineContainer,children:[(0,B.jsxs)(c.default,{style:Ae.timelineLeft,children:[(0,B.jsx)(c.default,{style:Ae.timelineDot}),(0,B.jsx)(c.default,{style:Ae.timelineLine})]}),(0,B.jsx)(c.default,{style:Ae.timelineContent,children:(0,B.jsx)(N,{entry:e,onLongPress:Se,onEdit:Be,onDelete:De,markdownStyles:ze,expense:t,actionItem:n})})]}))(t,n,r);case"magazine":return((e,t,n)=>(0,B.jsx)(c.default,{style:Ae.magazineContainer,children:(0,B.jsx)(N,{entry:e,onLongPress:Se,onEdit:Be,onDelete:De,markdownStyles:ze,expense:t,actionItem:n})}))(t,n,r);case"minimal":return"system"===t.type?null:((e,t,n)=>(0,B.jsx)($,{item:e,expense:t,actionItem:n,onEdit:Be,onDelete:De,markdownStyles:ze,layoutStyles:Ae}))(t,n,r);default:return((e,t,n)=>(0,B.jsx)(N,{entry:e,onLongPress:Se,onEdit:Be,onDelete:De,markdownStyles:ze,expense:t,actionItem:n}))(t,n,r)}},keyExtractor:e=>("type"in e&&e.type,e.id),style:[Ie.messagesList,(t=>{switch(t){case"cards":return{paddingHorizontal:8};case"list":case"minimal":return{paddingHorizontal:0,backgroundColor:e.surface};case"timeline":return{paddingHorizontal:0,backgroundColor:e.input};case"magazine":return{paddingHorizontal:0,backgroundColor:e.background};default:return{paddingHorizontal:16}}})(I)],showsVerticalScrollIndicator:!1,inverted:!0,maintainVisibleContentPosition:{minIndexForVisible:0},ListEmptyComponent:()=>{if(P&&(z.trim()||V)){let t="";return z.trim()&&V?t=`No entries found matching "${z}" on ${(0,R.default)(V,"MMM dd, yyyy")}`:z.trim()?t=`No entries found matching "${z}"`:V&&(t=`No entries found on ${(0,R.default)(V,"MMM dd, yyyy")}`),(0,B.jsx)(c.default,{style:{padding:20,alignItems:"center",transform:[{scaleY:-1}]},children:(0,B.jsx)(a.default,{style:{color:e.textSecondary,fontSize:16,textAlign:"center"},children:t})})}return null}}),(0,B.jsxs)(h.default,{behavior:"height",style:[Ie.inputContainer,{zIndex:1e4}],children:[(0,B.jsxs)(c.default,{style:Ie.quickActionsRow,children:[(0,B.jsx)(f.default,{style:[Ie.quickActionButton,X&&Ie.quickActionButtonActive],onPress:()=>{Q(!X),X||oe(!1)},children:(0,B.jsx)(a.default,{style:[Ie.quickActionText,X&&Ie.quickActionTextActive],children:"\ud83d\udcb0"})}),(0,B.jsx)(f.default,{style:[Ie.quickActionButton,ee&&Ie.quickActionButtonActive],onPress:()=>{oe(!ee),ee||Q(!1)},children:(0,B.jsx)(a.default,{style:[Ie.quickActionText,ee&&Ie.quickActionTextActive],children:"\u2705"})})]}),(0,B.jsxs)(c.default,{style:Ie.inputRow,children:[(0,B.jsx)(u.default,{ref:w,style:Ie.textInput,value:i,onChangeText:s,placeholder:X?"Type expense (e.g., 150 for coffee)...":ee?"Type task description...":l?"Type a message (Markdown supported)...":"Type a message...",multiline:!0,maxLength:1e3,onSubmitEditing:C?we:void 0,blurOnSubmit:C,returnKeyType:C?"send":"default"}),(0,B.jsx)(f.default,{style:[Ie.sendButton,!i.trim()&&Ie.sendButtonDisabled],onPress:we,disabled:!i.trim(),children:(0,B.jsx)(a.default,{style:{color:e.surface,fontSize:16},children:"\u2192"})})]})]}),T&&(0,B.jsx)(p.default,{visible:T,animationType:"slide",presentationStyle:"formSheet",children:(0,B.jsx)(K,{onClose:()=>{v(!1),xe()},onExportText:async()=>{try{const e=await D.getEntries(),t=await D.getExpenses(),n=await D.getActionItems();let r="=".repeat(50)+"\n";r+="DAILYTRACKER EXPORT\n",r+=(0,R.default)(new Date,"MMMM dd, yyyy - hh:mm a")+"\n",r+="=".repeat(50)+"\n\n",e.forEach(e=>{if("system"===e.type)return;const o=(0,R.default)(new Date(e.timestamp),"MMM dd, yyyy - hh:mm a"),a=t.find(t=>t.entryId===e.id),i=n.find(t=>t.entryId===e.id);let s="\ud83d\udcdd";"expense"===e.type||a?s="\ud83d\udcb0":("action"===e.type||i)&&(s="\u2705"),r+=`${s} ${o}\n`,r+=`${e.text}\n`,a&&(r+=`   Amount: ${W.formatCurrency(a.amount,a.currency)}`,a.category&&(r+=` | Category: ${a.category}`),r+="\n"),i&&(r+=`   Task: ${i.title}\n`,r+=`   Status: ${i.completed?"\u2713 Completed":"\u25cb Pending"}\n`),r+="\n"+"-".repeat(50)+"\n\n"});{const e=new Blob([r],{type:"text/plain"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`dailytracker-export-${(0,R.default)(new Date,"yyyy-MM-dd")}.txt`,n.click(),URL.revokeObjectURL(t),je("Exported successfully")}}catch(e){console.error("Export error:",e),je("Export failed")}},onExportJSON:async()=>{try{const e=await D.getEntries(),t=await D.getExpenses(),n=await D.getActionItems(),r={exportDate:(new Date).toISOString(),version:"1.0",entries:e,expenses:t,actionItems:n},o=JSON.stringify(r,null,2);{const e=new Blob([o],{type:"application/json"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`dailytracker-export-${(0,R.default)(new Date,"yyyy-MM-dd")}.json`,n.click(),URL.revokeObjectURL(t),je("Exported successfully")}}catch(e){console.error("Export error:",e),je("Export failed")}},onImport:async()=>{try{0;const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=async e=>{try{const t=JSON.parse(e.target.result);if(!t.entries||!Array.isArray(t.entries))return void je("Invalid file format");if(!window.confirm(`Import ${t.entries.length} entries? This will merge with existing data.`))return;const n=await D.getEntries(),r=await D.getExpenses(),o=await D.getActionItems(),a=new Set(n.map(e=>e.id)),i=t.entries.filter(e=>!a.has(e.id)),s=new Set(r.map(e=>e.id)),l=(t.expenses||[]).filter(e=>!s.has(e.id)),d=new Set(o.map(e=>e.id)),c=(t.actionItems||[]).filter(e=>!d.has(e.id));await D.saveEntries([...n,...i]),await D.saveExpenses([...r,...l]),await D.saveActionItems([...o,...c]),await he(),je(`Imported ${i.length} new entries`)}catch(t){console.error("Import error:",t),je("Import failed - invalid file")}},n.readAsText(t)},e.click()}catch(e){console.error("Import error:",e),je("Import failed")}},onBackup:async()=>{try{const e=await D.getEntries(),t=await D.getExpenses(),n=await D.getActionItems(),r={timestamp:(new Date).toISOString(),entries:e,expenses:t,actionItems:n};await D.saveBackup(r),je("Backup created successfully")}catch(e){console.error("Backup error:",e),je("Backup failed")}},onRestore:async()=>{try{const e=await D.getBackup();if(!e)return void je("No backup found");if(!window.confirm(`Restore backup from ${(0,R.default)(new Date(e.timestamp),"MMM dd, yyyy hh:mm a")}? This will replace current data.`))return;await D.saveEntries(e.entries),await D.saveExpenses(e.expenses),await D.saveActionItems(e.actionItems),await he(),je("Restored successfully")}catch(e){console.error("Restore error:",e),je("Restore failed")}}})}),ae&&(0,B.jsx)(p.default,{visible:!!ae,animationType:"slide",transparent:!0,onRequestClose:()=>{ie(null),le(""),ce(""),fe(""),me(null)},children:(0,B.jsx)(c.default,{style:Ie.editModalOverlay,children:(0,B.jsxs)(c.default,{style:Ie.editModalContent,children:[(0,B.jsx)(a.default,{style:Ie.editModalTitle,children:"Edit Entry"}),(0,B.jsx)(a.default,{style:Ie.editLabel,children:"Text:"}),(0,B.jsx)(c.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:8},children:(0,B.jsx)(f.default,{style:[Ie.markdownToggle,ae.isMarkdown&&Ie.markdownToggleActive],onPress:()=>ie(Object.assign({},ae,{isMarkdown:!ae.isMarkdown})),children:(0,B.jsx)(a.default,{style:Ie.markdownToggleText,children:ae.isMarkdown?"\u2705 Markdown":"\u274c Plain Text"})})}),(0,B.jsx)(u.default,{style:Ie.editTextInput,value:se,onChangeText:le,placeholder:"Entry text",multiline:!0,maxLength:1e3}),(0,B.jsx)(a.default,{style:Ie.editLabel,children:"Category:"}),(0,B.jsxs)(c.default,{style:Ie.categoryButtons,children:[(0,B.jsx)(f.default,{style:[Ie.categoryButton,"log"===ae.type&&Ie.categoryButtonActive],onPress:async()=>{"log"!==ae.type&&(await Te(ae),ie(Object.assign({},ae,{type:"log"})))},children:(0,B.jsx)(a.default,{style:Ie.categoryButtonText,children:"\ud83d\udcdd Log"})}),(0,B.jsx)(f.default,{style:[Ie.categoryButton,"expense"===ae.type&&Ie.categoryButtonActive],onPress:async()=>{if("expense"!==ae.type){"action"===ae.type&&await Te(ae);const e=W.extractExpenseInfo(se,ae.id);e?(ce(e.amount.toString()),fe(e.category||"")):(ce(""),fe("")),ie(Object.assign({},ae,{type:"expense"}))}},children:(0,B.jsx)(a.default,{style:Ie.categoryButtonText,children:"\ud83d\udcb0 Expense"})}),(0,B.jsx)(f.default,{style:[Ie.categoryButton,"action"===ae.type&&Ie.categoryButtonActive],onPress:async()=>{"action"!==ae.type&&("expense"===ae.type&&(await Te(ae),ce(""),fe("")),ie(Object.assign({},ae,{type:"action"})))},children:(0,B.jsx)(a.default,{style:Ie.categoryButtonText,children:"\u2705 Task"})})]}),"expense"===ae.type&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(a.default,{style:Ie.editLabel,children:"Amount:"}),(0,B.jsx)(u.default,{style:Ie.editInput,value:de,onChangeText:ce,placeholder:"Enter amount",keyboardType:"decimal-pad"}),(0,B.jsx)(a.default,{style:Ie.editLabel,children:"Category (optional):"}),(0,B.jsx)(u.default,{style:Ie.editInput,value:ue,onChangeText:fe,placeholder:"Food, Transportation, etc."})]}),"action"===ae.type&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(a.default,{style:Ie.editLabel,children:"Due Date:"}),(0,B.jsx)(c.default,{style:{marginBottom:12},children:(0,B.jsx)("input",{type:"date",style:{width:"100%",padding:12,fontSize:16,borderRadius:8,border:"1px solid #ddd",backgroundColor:e.input},onChange:e=>{e.target.value&&me(new Date(e.target.value))},value:ge?(0,R.default)(ge,"yyyy-MM-dd"):""})})]}),(0,B.jsxs)(c.default,{style:Ie.editModalButtons,children:[(0,B.jsx)(f.default,{style:[Ie.editModalButton,Ie.editModalButtonCancel],onPress:()=>{ie(null),le(""),ce(""),fe(""),me(null)},children:(0,B.jsx)(a.default,{style:Ie.editModalButtonText,children:"Cancel"})}),(0,B.jsx)(f.default,{style:[Ie.editModalButton,Ie.editModalButtonSave],onPress:async()=>{if(ae&&se.trim()){if("expense"===ae.type){if(!de||!de.trim())return void y.default.alert("Amount Required","Please enter an amount for the expense");const e=parseFloat(de);if(isNaN(e)||e<=0)return void y.default.alert("Invalid Amount","Please enter a valid amount greater than 0")}try{const e=(await D.getEntries()).map(e=>e.id===ae.id?Object.assign({},e,{text:se.trim(),type:ae.type,isMarkdown:ae.isMarkdown}):e);if(await D.saveEntries(e),"expense"===ae.type){const e=q.find(e=>e.entryId===ae.id);if(e&&de){const t=parseFloat(de);!isNaN(t)&&t>0&&await D.updateExpense(e.id,{amount:t,category:ue||e.category,description:se.trim()})}}if("action"===ae.type){const e=W.extractDueDate(se.trim())||ge||new Date;let t=Y.find(e=>e.entryId===ae.id);if(t)await D.updateActionItem(t.id,{title:se.trim(),dueDate:e});else{const t={id:Z(),entryId:ae.id,title:se.trim(),completed:!1,createdAt:new Date,dueDate:e,autoDetected:!1};await D.addActionItem(t)}}await he(),await be(),ie(null),le(""),ce(""),fe(""),me(null)}catch(e){console.error("Error updating entry:",e)}}},children:(0,B.jsx)(a.default,{style:[Ie.editModalButtonText,{color:e.surface}],children:"Save"})})]})]})})}),U&&(0,B.jsx)(p.default,{visible:U,animationType:"fade",transparent:!0,onRequestClose:()=>_(!1),children:(0,B.jsx)(f.default,{style:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.6)",justifyContent:"center",alignItems:"center",padding:20},activeOpacity:1,onPress:()=>_(!1),children:(0,B.jsx)(f.default,{activeOpacity:1,onPress:e=>e.stopPropagation(),style:{width:"100%",maxWidth:400},children:(0,B.jsxs)(c.default,{style:Ie.datePickerContent,children:[(0,B.jsxs)(c.default,{style:Ie.datePickerHeader,children:[(0,B.jsx)(a.default,{style:Ie.datePickerTitle,children:"Select Date"}),(0,B.jsx)(f.default,{onPress:()=>_(!1),style:Ie.datePickerClose,children:(0,B.jsx)(a.default,{style:Ie.datePickerCloseText,children:"\u2715"})})]}),(0,B.jsxs)(c.default,{style:Ie.datePickerQuickButtons,children:[(0,B.jsx)(f.default,{style:Ie.quickDateButton,onPress:()=>{F(new Date),_(!1)},children:(0,B.jsx)(a.default,{style:Ie.quickDateButtonText,children:"Today"})}),(0,B.jsx)(f.default,{style:Ie.quickDateButton,onPress:()=>{const e=new Date;e.setDate(e.getDate()-1),F(e),_(!1)},children:(0,B.jsx)(a.default,{style:Ie.quickDateButtonText,children:"Yesterday"})}),(0,B.jsx)(f.default,{style:Ie.quickDateButton,onPress:()=>{const e=new Date;e.setDate(e.getDate()-7),F(e),_(!1)},children:(0,B.jsx)(a.default,{style:Ie.quickDateButtonText,children:"Last Week"})})]}),(0,B.jsxs)(c.default,{style:{marginTop:16},children:[(0,B.jsx)(a.default,{style:{fontSize:13,color:e.textSecondary,marginBottom:8,fontWeight:"600"},children:"Or pick a specific date:"}),(0,B.jsx)("input",{type:"date",style:{width:"100%",padding:12,fontSize:16,borderRadius:8,border:"1px solid #ddd",boxSizing:"border-box"},onChange:e=>{e.target.value&&(F(new Date(e.target.value)),_(!1))},defaultValue:V?(0,R.default)(V,"yyyy-MM-dd"):""})]})]})})})})]})},te=e=>m.default.create({container:{flex:1,backgroundColor:e.background},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:12,paddingVertical:8,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},headerTitle:{fontSize:20,fontWeight:"bold",color:e.text},searchContainer:{paddingHorizontal:16,paddingVertical:12,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},searchSection:{marginBottom:12},dateSection:{marginBottom:8},searchLabel:{fontSize:13,fontWeight:"600",color:e.textSecondary,marginBottom:6},searchRow:{flexDirection:"row",alignItems:"center"},searchInput:{flex:1,height:40,paddingHorizontal:12,backgroundColor:e.input,borderRadius:8,fontSize:16,color:e.text,borderWidth:1,borderColor:e.border},datePickerButtonLarge:{flexDirection:"row",alignItems:"center",backgroundColor:e.input,borderRadius:8,borderWidth:1,borderColor:e.border,paddingHorizontal:12,paddingVertical:10,height:40},datePickerIconLarge:{fontSize:20,marginRight:8},datePickerButtonLabel:{flex:1,fontSize:16,color:e.text},datePickerClear:{width:20,height:20,borderRadius:10,backgroundColor:e.border,alignItems:"center",justifyContent:"center"},datePickerClearText:{fontSize:12,color:e.textSecondary,fontWeight:"bold"},clearButton:{marginLeft:8,width:24,height:24,borderRadius:12,backgroundColor:e.border,alignItems:"center",justifyContent:"center"},clearAllButton:{backgroundColor:e.error,borderRadius:8,paddingVertical:8,alignItems:"center",marginTop:4},clearAllButtonText:{color:e.surface,fontSize:14,fontWeight:"600"},clearButtonText:{fontSize:12,color:e.textSecondary,fontWeight:"bold"},settingsButton:{paddingHorizontal:8,paddingVertical:6,borderRadius:16,backgroundColor:e.input,marginLeft:8},settingsButtonText:{fontSize:16},messagesList:{flex:1,paddingHorizontal:8,paddingVertical:4},inputContainer:{paddingHorizontal:8,paddingVertical:4,paddingBottom:4,backgroundColor:e.surface,borderTopWidth:1,borderTopColor:e.border},quickActionsRow:{flexDirection:"row",marginBottom:4,gap:4},quickActionButton:{paddingHorizontal:10,paddingVertical:4,borderRadius:16,backgroundColor:e.input,borderWidth:2,borderColor:e.border},quickActionButtonActive:{backgroundColor:e.primary,borderColor:e.primary},quickActionText:{fontSize:18},quickActionTextActive:{transform:[{scale:1.1}]},inputRow:{flexDirection:"row",alignItems:"flex-end"},textInput:{flex:1,borderWidth:1,borderColor:e.border,borderRadius:20,paddingHorizontal:16,paddingVertical:12,marginRight:12,maxHeight:100,fontSize:16,backgroundColor:e.input,color:e.text},sendButton:{backgroundColor:e.primary,width:44,height:44,borderRadius:22,justifyContent:"center",alignItems:"center"},sendButtonDisabled:{backgroundColor:e.border},editModalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},editModalContent:{backgroundColor:e.surface,borderRadius:12,padding:20,width:"100%",maxWidth:500},editModalTitle:{fontSize:20,fontWeight:"bold",marginBottom:16,color:e.text},editLabel:{fontSize:14,fontWeight:"600",color:e.textSecondary,marginTop:12,marginBottom:6},editInput:{borderWidth:1,borderColor:e.border,borderRadius:8,padding:12,fontSize:16,backgroundColor:e.input,color:e.text},editTextInput:{borderWidth:1,borderColor:e.border,borderRadius:8,padding:12,fontSize:16,backgroundColor:e.input,color:e.text,minHeight:80,maxHeight:200,textAlignVertical:"top"},editModalButtons:{flexDirection:"row",justifyContent:"flex-end",marginTop:20,gap:12},editModalButton:{paddingHorizontal:20,paddingVertical:10,borderRadius:8,minWidth:80,alignItems:"center"},editModalButtonCancel:{backgroundColor:e.input},editModalButtonSave:{backgroundColor:e.primary},editModalButtonText:{fontSize:16,fontWeight:"600",color:e.text},categoryButtons:{flexDirection:"row",gap:8,marginBottom:12},categoryButton:{flex:1,paddingVertical:8,paddingHorizontal:12,borderRadius:8,backgroundColor:e.input,borderWidth:2,borderColor:e.border,alignItems:"center"},categoryButtonActive:{backgroundColor:e.primary,borderColor:e.primary},categoryButtonText:{fontSize:14,fontWeight:"600",color:e.text},markdownToggle:{paddingVertical:6,paddingHorizontal:12,borderRadius:6,backgroundColor:e.input,borderWidth:1,borderColor:e.border},markdownToggleActive:{backgroundColor:e.success+"33",borderColor:e.success},markdownToggleText:{fontSize:12,fontWeight:"600",color:e.text},dateSeparator:{flexDirection:"row",alignItems:"center",marginVertical:16,paddingHorizontal:8},dateSeparatorLine:{flex:1,height:1,backgroundColor:e.border},dateSeparatorText:{marginHorizontal:12,fontSize:14,fontWeight:"600",color:e.textSecondary,backgroundColor:e.background,paddingHorizontal:8,paddingVertical:4,borderRadius:12}}),ne=e=>m.default.create({cardContainer:{backgroundColor:e.surface,borderRadius:12,marginVertical:6,marginHorizontal:8,shadowColor:e.text,shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,overflow:"hidden"},cardHeader:{flexDirection:"row",justifyContent:"space-between",paddingHorizontal:16,paddingVertical:8,backgroundColor:e.input,borderBottomWidth:1,borderBottomColor:e.divider},cardDate:{fontSize:14,fontWeight:"600",color:e.text},cardTime:{fontSize:12,color:e.textSecondary},cardContent:{padding:16},cardText:{fontSize:16,lineHeight:22,color:e.text,marginBottom:8},expenseTag:{backgroundColor:e.success+"33",borderRadius:12,paddingHorizontal:8,paddingVertical:4,alignSelf:"flex-start",marginTop:8},expenseText:{fontSize:12,color:e.success,fontWeight:"500"},actionTag:{backgroundColor:e.info+"33",borderRadius:12,paddingHorizontal:8,paddingVertical:4,alignSelf:"flex-start",marginTop:8},actionText:{fontSize:12,color:e.info,fontWeight:"500"},listContainer:{flexDirection:"row",paddingVertical:12,paddingHorizontal:16,borderBottomWidth:1,borderBottomColor:e.divider},listLeft:{alignItems:"center",marginRight:16,width:60},listTime:{fontSize:12,color:e.textSecondary,fontWeight:"500",marginBottom:4},listIndicator:{width:8,height:8,borderRadius:4,backgroundColor:e.primary},listContent:{flex:1},listText:{fontSize:16,lineHeight:22,color:e.text,marginBottom:6},listMeta:{flexDirection:"row",gap:12},listExpense:{fontSize:12,color:e.success,fontWeight:"500"},listAction:{fontSize:12,color:e.primary,fontWeight:"500"},timelineContainer:{flexDirection:"row",paddingVertical:16,paddingHorizontal:16},timelineLeft:{alignItems:"center",marginRight:16,width:20},timelineDot:{width:12,height:12,borderRadius:6,backgroundColor:e.primary,zIndex:1},timelineLine:{width:2,flex:1,backgroundColor:e.border,marginTop:4},timelineContent:{flex:1,backgroundColor:e.surface,borderRadius:8,padding:16,shadowColor:e.text,shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},timelineDate:{fontSize:12,color:e.textSecondary,fontWeight:"500",marginBottom:8},timelineText:{fontSize:16,lineHeight:22,color:e.text},timelineTags:{flexDirection:"row",marginTop:12,gap:8},timelineExpense:{fontSize:12,color:e.success,backgroundColor:e.success+"33",paddingHorizontal:8,paddingVertical:2,borderRadius:8},timelineAction:{fontSize:12,color:e.primary,backgroundColor:e.info+"33",paddingHorizontal:8,paddingVertical:2,borderRadius:8},magazineContainer:{backgroundColor:e.surface,marginVertical:8,marginHorizontal:16,borderRadius:8,overflow:"hidden",shadowColor:e.text,shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},magazineHeader:{backgroundColor:e.primaryDark||e.primary,paddingHorizontal:20,paddingVertical:12},magazineDate:{fontSize:14,color:e.surface,fontWeight:"600",textTransform:"uppercase",letterSpacing:.5},magazineBody:{paddingHorizontal:20,paddingVertical:16},magazineText:{fontSize:17,lineHeight:26,color:e.text,fontFamily:"serif"},magazineFooter:{flexDirection:"row",paddingHorizontal:20,paddingBottom:16,gap:16},magazineExpenseBlock:{flex:1},magazineExpenseLabel:{fontSize:10,color:e.textSecondary,fontWeight:"600",textTransform:"uppercase",marginBottom:2},magazineExpenseAmount:{fontSize:16,color:e.success,fontWeight:"600"},magazineActionBlock:{flex:1},magazineActionLabel:{fontSize:10,color:e.textSecondary,fontWeight:"600",textTransform:"uppercase",marginBottom:2},magazineActionText:{fontSize:16,color:e.primary,fontWeight:"600"},minimalContainer:{flexDirection:"row",paddingVertical:0,paddingHorizontal:20,alignItems:"center",justifyContent:"space-between",width:"100%"},minimalContent:{flex:1,marginRight:16,flexDirection:"row",alignItems:"center",minWidth:0,maxWidth:"100%",overflow:"hidden"},minimalText:{fontSize:16,color:e.text},minimalMeta:{flexDirection:"row",alignItems:"center",gap:6,flexShrink:0},minimalTime:{fontSize:12,color:e.textSecondary},minimalExpense:{fontSize:12,color:e.success},minimalAction:{fontSize:12,color:e.primary},datePickerContent:{backgroundColor:e.surface,borderRadius:16,padding:24,width:"100%",shadowColor:e.text,shadowOffset:{width:0,height:8},shadowOpacity:.4,shadowRadius:16,elevation:20},datePickerHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},datePickerTitle:{fontSize:20,fontWeight:"bold",color:e.text},datePickerClose:{width:32,height:32,borderRadius:16,backgroundColor:e.input,alignItems:"center",justifyContent:"center"},datePickerCloseText:{fontSize:18,color:e.textSecondary,fontWeight:"bold"},datePickerQuickButtons:{flexDirection:"row",justifyContent:"space-around",marginBottom:16},quickDateButton:{paddingHorizontal:16,paddingVertical:10,borderRadius:20,backgroundColor:e.primary,flex:1,marginHorizontal:4,alignItems:"center"},quickDateButtonText:{color:e.surface,fontSize:14,fontWeight:"600"},mobileDatePicker:{padding:20,alignItems:"center"},mobileDatePickerText:{fontSize:14,color:e.textSecondary,textAlign:"center"}}),re=e=>m.default.create({body:{fontSize:16,color:e.text,lineHeight:20},heading1:{fontSize:20,fontWeight:"bold",marginTop:12,marginBottom:12,paddingVertical:4,color:e.text},heading2:{fontSize:18,fontWeight:"bold",marginBottom:6,color:e.text},strong:{fontWeight:"bold",color:e.text},em:{fontStyle:"italic",color:e.text},code_inline:{backgroundColor:e.input,paddingHorizontal:4,paddingVertical:2,borderRadius:3,fontFamily:"monospace",color:e.text}});var oe=n(9320),ae=n(1862);const ie=({item:e,onToggleComplete:t,onEdit:n,onDelete:r,theme:o,dynamicStyles:i})=>(0,B.jsxs)(c.default,{style:[i.itemCard,e.completed&&i.completedCard],children:[(0,B.jsxs)(f.default,{style:i.itemHeader,onPress:()=>t(e.id),activeOpacity:.7,children:[(0,B.jsx)(oe.default,{name:e.completed?"checkbox":"checkbox-outline",size:24,color:e.completed?"#4caf50":"#666"}),(0,B.jsx)(c.default,{style:{flex:1,marginLeft:8},children:(0,B.jsx)(H.default,{style:{body:{fontSize:16,color:e.completed?o.placeholder:o.text,textDecorationLine:e.completed?"line-through":"none"}},children:e.title})})]}),e.description&&e.description!==e.title&&(0,B.jsx)(a.default,{style:[i.itemDescription,e.completed&&i.completedText],children:e.description}),(0,B.jsxs)(c.default,{style:i.itemFooter,children:[(0,B.jsxs)(c.default,{children:[(0,B.jsxs)(a.default,{style:i.itemDate,children:["Created: ",(0,R.default)(e.createdAt,"MMM d, yyyy HH:mm")]}),e.dueDate&&(0,B.jsxs)(a.default,{style:[i.itemDueDate,e.completed&&i.completedText,new Date(e.dueDate)<new Date&&!e.completed&&i.overdue],children:["Due: ",(0,R.default)(new Date(e.dueDate),"MMM d, yyyy"),new Date(e.dueDate)<new Date&&!e.completed&&" (Overdue)"]})]}),(0,B.jsxs)(c.default,{style:i.itemActions,children:[(0,B.jsx)(f.default,{style:i.actionButton,onPress:()=>n(e),activeOpacity:.7,hitSlop:{top:15,bottom:15,left:15,right:15},children:(0,B.jsx)(oe.default,{name:"pencil",size:18,color:"#666"})}),(0,B.jsx)(f.default,{style:[i.actionButton,i.deleteButton],onPress:()=>r(e.id),activeOpacity:.7,hitSlop:{top:15,bottom:15,left:15,right:15},children:(0,B.jsx)(oe.default,{name:"trash",size:18,color:"#fff"})})]})]})]}),se=({visible:e,item:t,onSave:n,onCancel:r,theme:i,dynamicStyles:s})=>{const[l,d]=(0,o.useState)(""),[g,m]=(0,o.useState)(""),[y,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{t&&(d(t.title),m(t.description||""),h(t.dueDate?new Date(t.dueDate):null))},[t]);return(0,B.jsx)(p.default,{visible:e,animationType:"slide",transparent:!0,children:(0,B.jsx)(c.default,{style:s.modalContainer,children:(0,B.jsxs)(c.default,{style:s.modalContent,children:[(0,B.jsx)(a.default,{style:s.modalTitle,children:"Edit Action Item"}),(0,B.jsx)(u.default,{style:s.modalInput,value:l,onChangeText:d,placeholder:"Title",multiline:!0}),(0,B.jsx)(u.default,{style:[s.modalInput,s.modalInputLarge],value:g,onChangeText:m,placeholder:"Description (optional)",multiline:!0}),(0,B.jsxs)(c.default,{style:s.dueDateContainer,children:[(0,B.jsx)(a.default,{style:s.dueDateLabel,children:"Due Date:"}),(0,B.jsxs)(c.default,{style:s.dueDateInputWrapper,children:[(0,B.jsx)("input",{type:"date",style:{flex:1,padding:12,fontSize:16,borderRadius:8,border:"1px solid #ddd",backgroundColor:i.input},onChange:e=>{e.target.value?h(new Date(e.target.value)):h(null)},value:y?(0,R.default)(y,"yyyy-MM-dd"):""}),y&&(0,B.jsx)(f.default,{style:s.clearDateButton,onPress:()=>h(null),children:(0,B.jsx)(a.default,{style:s.clearDateButtonText,children:"\u2715"})})]})]}),(0,B.jsxs)(c.default,{style:s.modalButtons,children:[(0,B.jsx)(f.default,{style:s.modalButton,onPress:r,children:(0,B.jsx)(a.default,{style:s.modalButtonText,children:"Cancel"})}),(0,B.jsx)(f.default,{style:[s.modalButton,s.modalButtonPrimary],onPress:()=>{if(!t||!l.trim())return;const e=Object.assign({},t,{title:l.trim(),description:g.trim(),dueDate:y||void 0});n(e)},children:(0,B.jsx)(a.default,{style:[s.modalButtonText,s.modalButtonTextPrimary],children:"Save"})})]})]})})})},le=()=>{const{theme:e,isDark:t}=E(),[n,r]=(0,o.useState)([]),[i,s]=(0,o.useState)("all"),[l,d]=(0,o.useState)(null),[u,m]=(0,o.useState)(!1),y=(0,o.useCallback)(async()=>{const e=await D.getActionItems();r(e)},[]);(0,o.useEffect)(()=>{y()},[y]),(0,ae.useFocusEffect)((0,o.useCallback)(()=>{y()},[y]));const h=n.filter(e=>{switch(i){case"pending":return!e.completed;case"completed":return e.completed;default:return!0}}),p=e=>{switch(e){case"overdue":return"\ud83d\udd34 Overdue";case"today":return"\ud83d\udcc5 Due Today";case"this-week":return"\ud83d\udccb Due This Week";case"this-month":return"\ud83d\uddd3\ufe0f Due This Month";case"later":return"\ud83d\udcc6 Due Later";case"completed":return"\u2705 Completed";default:return""}},b=e=>["overdue","today","this-week","this-month","later","completed"].indexOf(e),j=h.reduce((e,t)=>{const n=(e=>{if(e.completed)return"completed";if(!e.dueDate)return"later";const t=new Date;t.setHours(0,0,0,0);const n=new Date(t);n.setDate(n.getDate()+(7-t.getDay()));const r=new Date(t.getFullYear(),t.getMonth()+1,0);r.setHours(0,0,0,0);const o=new Date(e.dueDate);return o.setHours(0,0,0,0),o<t?"overdue":o.getTime()===t.getTime()?"today":o<=n?"this-week":o<=r?"this-month":"later"})(t);return e[n]||(e[n]=[]),e[n].push(t),e},{});Object.keys(j).forEach(e=>{j[e].sort((t,n)=>"completed"===e||"no-date"===e?n.createdAt.getTime()-t.createdAt.getTime():t.dueDate&&n.dueDate?new Date(t.dueDate).getTime()-new Date(n.dueDate).getTime():0)});const w=[];Object.keys(j).sort((e,t)=>b(e)-b(t)).forEach(e=>{w.push({type:"header",title:p(e)}),j[e].forEach(e=>{w.push({type:"item",item:e})})});const S=async e=>{const t=n.find(t=>t.id===e);if(!t)return;const o=Object.assign({},t,{completed:!t.completed});await D.updateActionItem(e,{completed:!t.completed}),r(t=>t.map(t=>t.id===e?o:t))},C=e=>{d(e),m(!0)},k=async e=>{if("undefined"===typeof window||window.confirm("Are you sure you want to delete this action item?"))try{await D.deleteActionItem(e),r(t=>t.filter(t=>t.id!==e))}catch(t){console.error("Error deleting action item:",t)}},T=e=>[z.filterButton,i===e&&z.filterButtonActive],v=e=>[z.filterButtonText,i===e&&z.filterButtonTextActive],I=n.filter(e=>!e.completed).length,A=n.filter(e=>e.completed).length,z=de(e);return(0,B.jsxs)(x.SafeAreaView,{style:z.container,children:[(0,B.jsxs)(c.default,{style:z.header,children:[(0,B.jsx)(a.default,{style:z.headerTitle,children:"Action Items"}),(0,B.jsx)(c.default,{style:z.stats,children:(0,B.jsxs)(a.default,{style:z.statsText,children:[I," pending \u2022 ",A," completed"]})})]}),(0,B.jsxs)(c.default,{style:z.filterContainer,children:[(0,B.jsx)(f.default,{style:T("all"),onPress:()=>s("all"),children:(0,B.jsx)(a.default,{style:v("all"),children:"All"})}),(0,B.jsx)(f.default,{style:T("pending"),onPress:()=>s("pending"),children:(0,B.jsx)(a.default,{style:v("pending"),children:"Pending"})}),(0,B.jsx)(f.default,{style:T("completed"),onPress:()=>s("completed"),children:(0,B.jsx)(a.default,{style:v("completed"),children:"Completed"})})]}),0===w.length?(0,B.jsxs)(c.default,{style:z.emptyContainer,children:[(0,B.jsx)(oe.default,{name:"checkbox-outline",size:64,color:"#ccc"}),(0,B.jsx)(a.default,{style:z.emptyText,children:"all"===i?"No action items yet":"pending"===i?"No pending action items":"No completed action items"}),(0,B.jsx)(a.default,{style:z.emptySubtext,children:"Add entries in your journal to create action items"})]}):(0,B.jsx)(g.default,{data:w,renderItem:({item:t})=>"header"===t.type?(0,B.jsx)(c.default,{style:z.sectionHeader,children:(0,B.jsx)(a.default,{style:z.sectionHeaderText,children:t.title})}):(0,B.jsx)(ie,{item:t.item,onToggleComplete:S,onEdit:C,onDelete:k,theme:e,dynamicStyles:z}),keyExtractor:(e,t)=>"header"===e.type?`header-${t}`:`item-${e.item.id}`,style:z.list,showsVerticalScrollIndicator:!1}),(0,B.jsx)(se,{visible:u,item:l,onSave:async e=>{await D.updateActionItem(e.id,{title:e.title,description:e.description,dueDate:e.dueDate}),r(t=>t.map(t=>t.id===e.id?e:t)),m(!1),d(null)},onCancel:()=>{m(!1),d(null)},theme:e,dynamicStyles:z})]})},de=e=>m.default.create({container:{flex:1,backgroundColor:e.background},header:{paddingHorizontal:16,paddingVertical:12,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},headerTitle:{fontSize:20,fontWeight:"bold",color:e.text,marginBottom:4},stats:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},statsText:{fontSize:14,color:e.textSecondary},filterContainer:{flexDirection:"row",paddingHorizontal:16,paddingVertical:12,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},filterButton:{paddingHorizontal:16,paddingVertical:8,marginRight:8,borderRadius:20,backgroundColor:e.input},filterButtonActive:{backgroundColor:e.primary},filterButtonText:{fontSize:14,color:e.textSecondary,fontWeight:"500"},filterButtonTextActive:{color:e.surface},list:{flex:1,paddingHorizontal:16},sectionHeader:{paddingVertical:12,paddingHorizontal:8,marginTop:8},sectionHeaderText:{fontSize:16,fontWeight:"700",color:e.text,textTransform:"uppercase",letterSpacing:.5},itemCard:{backgroundColor:e.surface,marginVertical:6,padding:16,borderRadius:12,shadowColor:e.text,shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},completedCard:{backgroundColor:e.input,opacity:.8},itemHeader:{flexDirection:"row",alignItems:"flex-start",marginBottom:8},itemTitle:{flex:1,fontSize:16,fontWeight:"600",color:e.text,marginLeft:12,lineHeight:20},completedText:{textDecorationLine:"line-through",color:e.textSecondary},itemDescription:{fontSize:14,color:e.textSecondary,lineHeight:18,marginBottom:12,marginLeft:36},itemFooter:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:8},itemDate:{fontSize:12,color:e.placeholder},itemDueDate:{fontSize:12,color:e.textSecondary,marginTop:2,fontWeight:"500"},overdue:{color:"#f44336",fontWeight:"600"},itemActions:{flexDirection:"row"},actionButton:{padding:10,marginLeft:8,minWidth:36,minHeight:36,alignItems:"center",justifyContent:"center",borderRadius:6,backgroundColor:"rgba(0,0,0,0.05)",borderWidth:1,borderColor:"rgba(0,0,0,0.1)"},deleteButton:{backgroundColor:"#f44336",borderColor:"#d32f2f"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:40},emptyText:{fontSize:18,fontWeight:"600",color:e.textSecondary,marginTop:16,textAlign:"center"},emptySubtext:{fontSize:14,color:e.placeholder,marginTop:8,textAlign:"center",lineHeight:20},modalContainer:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:e.surface,borderRadius:12,padding:20,width:"90%",maxWidth:400},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:16,textAlign:"center"},modalInput:{borderWidth:1,borderColor:e.border,borderRadius:8,padding:12,marginBottom:12,fontSize:16,minHeight:44},modalInputLarge:{minHeight:80,textAlignVertical:"top"},dueDateContainer:{marginBottom:12},dueDateLabel:{fontSize:14,fontWeight:"600",color:e.textSecondary,marginBottom:8},dueDateInputWrapper:{flexDirection:"row",alignItems:"center"},clearDateButton:{marginLeft:8,width:32,height:32,borderRadius:16,backgroundColor:"#f44336",alignItems:"center",justifyContent:"center"},clearDateButtonText:{color:e.surface,fontSize:14,fontWeight:"bold"},modalButtons:{flexDirection:"row",justifyContent:"space-between",marginTop:16},modalButton:{flex:1,paddingVertical:12,borderRadius:8,marginHorizontal:4,backgroundColor:e.input},modalButtonPrimary:{backgroundColor:e.primary},modalButtonText:{textAlign:"center",fontSize:16,fontWeight:"600",color:e.text},modalButtonTextPrimary:{color:e.surface}});var ce=n(7832),ue=n(3815),fe=n(8327);const ge=({expense:e,onEdit:t,onDelete:n,theme:r,dynamicStyles:o})=>(0,B.jsxs)(c.default,{style:o.expenseCard,children:[(0,B.jsxs)(c.default,{style:o.expenseHeader,children:[(0,B.jsxs)(c.default,{style:o.expenseAmount,children:[(0,B.jsx)(a.default,{style:o.amountText,children:W.formatCurrency(e.amount,e.currency)}),e.category&&(0,B.jsx)(a.default,{style:o.categoryText,children:e.category})]}),(0,B.jsxs)(c.default,{style:o.expenseActions,children:[(0,B.jsx)(f.default,{style:o.actionButton,onPress:()=>t(e),activeOpacity:.7,hitSlop:{top:15,bottom:15,left:15,right:15},children:(0,B.jsx)(oe.default,{name:"pencil",size:18,color:"#666"})}),(0,B.jsx)(f.default,{style:[o.actionButton,o.deleteButton],onPress:()=>n(e.id),activeOpacity:.7,hitSlop:{top:15,bottom:15,left:15,right:15},children:(0,B.jsx)(oe.default,{name:"trash",size:18,color:"#fff"})})]})]}),(0,B.jsx)(a.default,{style:o.expenseDescription,numberOfLines:2,children:e.description}),(0,B.jsx)(a.default,{style:o.expenseDate,children:(0,R.default)(e.createdAt,"MMM d, yyyy HH:mm")})]}),me=({visible:e,expense:t,onSave:n,onCancel:r,theme:i,dynamicStyles:s})=>{const[l,d]=(0,o.useState)(""),[g,m]=(0,o.useState)("USD"),[h,x]=(0,o.useState)(""),[b,j]=(0,o.useState)("");(0,o.useEffect)(()=>{t&&(d(t.amount.toString()),m(t.currency),x(t.description),j(t.category||""))},[t]);return(0,B.jsx)(p.default,{visible:e,animationType:"slide",transparent:!0,children:(0,B.jsx)(c.default,{style:s.modalContainer,children:(0,B.jsxs)(c.default,{style:s.modalContent,children:[(0,B.jsx)(a.default,{style:s.modalTitle,children:"Edit Expense"}),(0,B.jsx)(u.default,{style:s.modalInput,value:l,onChangeText:d,placeholder:"Amount",keyboardType:"numeric"}),(0,B.jsxs)(c.default,{style:s.currencyContainer,children:[(0,B.jsx)(a.default,{style:s.inputLabel,children:"Currency:"}),(0,B.jsx)(c.default,{style:s.currencyOptions,children:["USD","INR","EUR","GBP"].map(e=>(0,B.jsx)(f.default,{style:[s.currencyButton,g===e&&s.currencyButtonActive],onPress:()=>m(e),children:(0,B.jsx)(a.default,{style:[s.currencyButtonText,g===e&&s.currencyButtonTextActive],children:e})},e))})]}),(0,B.jsx)(u.default,{style:[s.modalInput,s.modalInputLarge],value:h,onChangeText:x,placeholder:"Description",multiline:!0}),(0,B.jsxs)(c.default,{style:s.categoryContainer,children:[(0,B.jsx)(a.default,{style:s.inputLabel,children:"Category (optional):"}),(0,B.jsx)(c.default,{style:s.categoryOptions,children:["Food","Transportation","Shopping","Entertainment","Bills","Healthcare","Education","Travel","Other"].map(e=>(0,B.jsx)(f.default,{style:[s.categoryButton,b===e&&s.categoryButtonActive],onPress:()=>j(b===e?"":e),children:(0,B.jsx)(a.default,{style:[s.categoryButtonText,b===e&&s.categoryButtonTextActive],children:e})},e))})]}),(0,B.jsxs)(c.default,{style:s.modalButtons,children:[(0,B.jsx)(f.default,{style:s.modalButton,onPress:r,children:(0,B.jsx)(a.default,{style:s.modalButtonText,children:"Cancel"})}),(0,B.jsx)(f.default,{style:[s.modalButton,s.modalButtonPrimary],onPress:()=>{if(!t||!l.trim()||!h.trim())return;const e=parseFloat(l);if(isNaN(e)||e<=0)return void y.default.alert("Invalid Amount","Please enter a valid amount greater than 0");const r=Object.assign({},t,{amount:e,currency:g,description:h.trim(),category:b.trim()||void 0});n(r)},children:(0,B.jsx)(a.default,{style:[s.modalButtonText,s.modalButtonTextPrimary],children:"Save"})})]})]})})})},ye=()=>{const{theme:e,isDark:t}=E(),n=he(e),[r,i]=(0,o.useState)([]),[s,l]=(0,o.useState)("all"),[d,u]=(0,o.useState)(null),[m,y]=(0,o.useState)(!1),[h,p]=(0,o.useState)("list"),b=(0,o.useCallback)(async()=>{const e=await D.getExpenses();i(e.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()))},[]);(0,o.useEffect)(()=>{b()},[b]),(0,ae.useFocusEffect)((0,o.useCallback)(()=>{b()},[b]));const j=r.filter(e=>{if("thisMonth"===s){const t=new Date,n=(0,ce.default)(t),r=(0,ue.default)(t);return(0,fe.default)(e.createdAt,{start:n,end:r})}return!0}),w=e=>{const t={};return e.forEach(e=>{const n=e.category||"Other";t[n]||(t[n]={amount:0,count:0,currency:e.currency}),t[n].amount+=e.amount,t[n].count+=1}),Object.entries(t).map(([e,t])=>({category:e,amount:t.amount,count:t.count,currency:t.currency,formatted:W.formatCurrency(t.amount,t.currency)})).sort((e,t)=>t.amount-e.amount)},S=e=>{u(e),y(!0)},C=async e=>{if("undefined"===typeof window||window.confirm("Are you sure you want to delete this expense?"))try{await D.deleteExpense(e),i(t=>t.filter(t=>t.id!==e))}catch(t){console.error("Error deleting expense:",t)}},k=e=>[n.filterButton,s===e&&n.filterButtonActive],T=e=>[n.filterButtonText,s===e&&n.filterButtonTextActive];return(0,B.jsxs)(x.SafeAreaView,{style:n.container,children:[(0,B.jsxs)(c.default,{style:n.header,children:[(0,B.jsx)(a.default,{style:n.headerTitle,children:"Expenses"}),(0,B.jsx)(c.default,{style:n.totalsContainer,children:0===j.length?(0,B.jsxs)(c.default,{style:n.totalContainer,children:[(0,B.jsx)(a.default,{style:n.totalLabel,children:"Total:"}),(0,B.jsx)(a.default,{style:n.totalAmount,children:"$0.00"})]}):(e=>{if(0===e.length)return[];const t={};return e.forEach(e=>{t[e.currency]=(t[e.currency]||0)+e.amount}),Object.keys(t).map(e=>({currency:e,amount:t[e],formatted:W.formatCurrency(t[e],e)}))})(j).map(e=>(0,B.jsxs)(c.default,{style:n.totalContainer,children:[(0,B.jsxs)(a.default,{style:n.totalLabel,children:[e.currency," Total:"]}),(0,B.jsx)(a.default,{style:n.totalAmount,children:e.formatted})]},e.currency))})]}),(0,B.jsxs)(c.default,{style:n.filterContainer,children:[(0,B.jsx)(f.default,{style:k("all"),onPress:()=>l("all"),children:(0,B.jsx)(a.default,{style:T("all"),children:"All Time"})}),(0,B.jsx)(f.default,{style:k("thisMonth"),onPress:()=>l("thisMonth"),children:(0,B.jsx)(a.default,{style:T("thisMonth"),children:"This Month"})})]}),(0,B.jsxs)(c.default,{style:n.viewToggleContainer,children:[(0,B.jsx)(f.default,{style:[n.viewToggleButton,"list"===h&&n.viewToggleButtonActive],onPress:()=>p("list"),children:(0,B.jsx)(a.default,{style:[n.viewToggleText,"list"===h&&n.viewToggleTextActive],children:"List"})}),(0,B.jsx)(f.default,{style:[n.viewToggleButton,"analytics"===h&&n.viewToggleButtonActive],onPress:()=>p("analytics"),children:(0,B.jsx)(a.default,{style:[n.viewToggleText,"analytics"===h&&n.viewToggleTextActive],children:"Analytics"})})]}),0===j.length?(0,B.jsxs)(c.default,{style:n.emptyContainer,children:[(0,B.jsx)(oe.default,{name:"receipt-outline",size:64,color:"#ccc"}),(0,B.jsx)(a.default,{style:n.emptyText,children:"all"===s?"No expenses yet":"No expenses this month"}),(0,B.jsx)(a.default,{style:n.emptySubtext,children:"Add entries in your journal to track expenses"})]}):"list"===h?(0,B.jsx)(g.default,{data:j,renderItem:({item:t})=>(0,B.jsx)(ge,{expense:t,onEdit:S,onDelete:C,theme:e,dynamicStyles:n}),keyExtractor:e=>e.id,style:n.list,showsVerticalScrollIndicator:!1}):(0,B.jsxs)(q.default,{style:n.analyticsContainer,showsVerticalScrollIndicator:!1,children:[(0,B.jsxs)(c.default,{style:n.analyticsSection,children:[(0,B.jsx)(a.default,{style:n.analyticsSectionTitle,children:"\ud83d\udcca Category Breakdown"}),w(j).map((e,t)=>(0,B.jsxs)(c.default,{style:n.categoryAnalyticsItem,children:[(0,B.jsxs)(c.default,{style:n.categoryAnalyticsInfo,children:[(0,B.jsx)(a.default,{style:n.categoryAnalyticsName,children:e.category}),(0,B.jsxs)(a.default,{style:n.categoryAnalyticsCount,children:[e.count," ",1===e.count?"expense":"expenses"]})]}),(0,B.jsx)(a.default,{style:n.categoryAnalyticsAmount,children:e.formatted})]},e.category))]}),(0,B.jsxs)(c.default,{style:n.analyticsSection,children:[(0,B.jsx)(a.default,{style:n.analyticsSectionTitle,children:"\ud83d\udcc8 Monthly Trends"}),(()=>{const e={};return r.forEach(t=>{const n=(0,R.default)(t.createdAt,"MMM yyyy");e[n]||(e[n]={amount:0,count:0}),e[n].amount+=t.amount,e[n].count+=1}),Object.entries(e).map(([e,t])=>({month:e,amount:t.amount,count:t.count})).sort((e,t)=>new Date(e.month).getTime()-new Date(t.month).getTime())})().map((e,t)=>(0,B.jsxs)(c.default,{style:n.trendItem,children:[(0,B.jsx)(a.default,{style:n.trendMonth,children:e.month}),(0,B.jsxs)(c.default,{style:{alignItems:"flex-end"},children:[(0,B.jsx)(a.default,{style:n.trendAmount,children:W.formatCurrency(e.amount,"USD")}),(0,B.jsxs)(a.default,{style:n.categoryAnalyticsCount,children:[e.count," ",1===e.count?"expense":"expenses"]})]})]},e.month))]}),(0,B.jsxs)(c.default,{style:n.analyticsSection,children:[(0,B.jsx)(a.default,{style:n.analyticsSectionTitle,children:"\ud83d\udccb Quick Stats"}),(0,B.jsxs)(c.default,{style:n.trendItem,children:[(0,B.jsx)(a.default,{style:n.trendMonth,children:"Average per expense"}),(0,B.jsx)(a.default,{style:n.trendAmount,children:j.length>0?W.formatCurrency(j.reduce((e,t)=>e+t.amount,0)/j.length,j[0].currency):"$0.00"})]}),(0,B.jsxs)(c.default,{style:n.trendItem,children:[(0,B.jsx)(a.default,{style:n.trendMonth,children:"Most expensive category"}),(0,B.jsx)(a.default,{style:n.trendAmount,children:w(j)[0]?.category||"None"})]}),(0,B.jsxs)(c.default,{style:n.trendItem,children:[(0,B.jsx)(a.default,{style:n.trendMonth,children:"Total categories"}),(0,B.jsx)(a.default,{style:n.trendAmount,children:w(j).length})]})]})]}),(0,B.jsx)(me,{visible:m,expense:d,onSave:async e=>{await D.updateExpense(e.id,{amount:e.amount,currency:e.currency,description:e.description,category:e.category}),i(t=>t.map(t=>t.id===e.id?e:t)),y(!1),u(null)},onCancel:()=>{y(!1),u(null)},theme:e,dynamicStyles:n})]})},he=e=>m.default.create({container:{flex:1,backgroundColor:e.background},header:{paddingHorizontal:16,paddingVertical:12,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},headerTitle:{fontSize:20,fontWeight:"bold",color:e.text,marginBottom:8},totalsContainer:{paddingHorizontal:16,paddingTop:8},totalContainer:{flexDirection:"row",alignItems:"center",marginBottom:4},totalLabel:{fontSize:14,color:e.textSecondary,marginRight:8},totalAmount:{fontSize:16,fontWeight:"bold",color:"#2e7d32"},filterContainer:{flexDirection:"row",paddingHorizontal:16,paddingVertical:12,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},filterButton:{paddingHorizontal:16,paddingVertical:8,marginRight:8,borderRadius:20,backgroundColor:e.input},filterButtonActive:{backgroundColor:e.primary},filterButtonText:{fontSize:14,color:e.textSecondary,fontWeight:"500"},filterButtonTextActive:{color:e.surface},list:{flex:1,paddingHorizontal:16},expenseCard:{backgroundColor:e.surface,marginVertical:6,padding:16,borderRadius:12,shadowColor:e.text,shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},expenseHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},expenseAmount:{flex:1},amountText:{fontSize:18,fontWeight:"bold",color:"#2e7d32"},categoryText:{fontSize:12,color:e.textSecondary,marginTop:2,backgroundColor:e.input,paddingHorizontal:8,paddingVertical:2,borderRadius:10,alignSelf:"flex-start"},expenseActions:{flexDirection:"row"},actionButton:{padding:10,marginLeft:8,minWidth:36,minHeight:36,alignItems:"center",justifyContent:"center",borderRadius:6,backgroundColor:"rgba(0,0,0,0.05)",borderWidth:1,borderColor:"rgba(0,0,0,0.1)"},deleteButton:{backgroundColor:"#f44336",borderColor:"#d32f2f"},expenseDescription:{fontSize:14,color:e.text,lineHeight:18,marginBottom:8},expenseDate:{fontSize:12,color:e.placeholder},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:40},emptyText:{fontSize:18,fontWeight:"600",color:e.textSecondary,marginTop:16,textAlign:"center"},emptySubtext:{fontSize:14,color:e.placeholder,marginTop:8,textAlign:"center",lineHeight:20},modalContainer:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:e.surface,borderRadius:12,padding:20,width:"90%",maxWidth:400,maxHeight:"80%"},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:16,textAlign:"center"},modalInput:{borderWidth:1,borderColor:e.border,borderRadius:8,padding:12,marginBottom:12,fontSize:16,minHeight:44},modalInputLarge:{minHeight:80,textAlignVertical:"top"},inputLabel:{fontSize:14,fontWeight:"600",color:e.text,marginBottom:8},currencyContainer:{marginBottom:12},currencyOptions:{flexDirection:"row",flexWrap:"wrap"},currencyButton:{paddingHorizontal:12,paddingVertical:6,marginRight:8,marginBottom:8,borderRadius:16,backgroundColor:e.input,borderWidth:1,borderColor:e.border},currencyButtonActive:{backgroundColor:e.primary,borderColor:e.primary},currencyButtonText:{fontSize:14,color:e.textSecondary,fontWeight:"500"},currencyButtonTextActive:{color:e.surface},categoryContainer:{marginBottom:16},categoryOptions:{flexDirection:"row",flexWrap:"wrap"},categoryButton:{paddingHorizontal:12,paddingVertical:6,marginRight:8,marginBottom:8,borderRadius:16,backgroundColor:e.input,borderWidth:1,borderColor:e.border},categoryButtonActive:{backgroundColor:"#4caf50",borderColor:"#4caf50"},categoryButtonText:{fontSize:12,color:e.textSecondary,fontWeight:"500"},categoryButtonTextActive:{color:e.surface},modalButtons:{flexDirection:"row",justifyContent:"space-between",marginTop:16},modalButton:{flex:1,paddingVertical:12,borderRadius:8,marginHorizontal:4,backgroundColor:e.input},modalButtonPrimary:{backgroundColor:e.primary},modalButtonText:{textAlign:"center",fontSize:16,fontWeight:"600",color:e.text},modalButtonTextPrimary:{color:e.surface},viewToggleContainer:{flexDirection:"row",paddingHorizontal:16,paddingVertical:8,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},viewToggleButton:{flex:1,paddingVertical:8,paddingHorizontal:16,marginHorizontal:4,borderRadius:16,backgroundColor:e.input,alignItems:"center"},viewToggleButtonActive:{backgroundColor:e.primary},viewToggleText:{fontSize:14,fontWeight:"600",color:e.textSecondary},viewToggleTextActive:{color:e.surface},analyticsContainer:{flex:1,paddingHorizontal:16},analyticsSection:{backgroundColor:e.surface,borderRadius:12,padding:16,marginVertical:8},analyticsSectionTitle:{fontSize:16,fontWeight:"bold",color:e.text,marginBottom:12},categoryAnalyticsItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,borderBottomWidth:1,borderBottomColor:e.input},categoryAnalyticsInfo:{flex:1},categoryAnalyticsName:{fontSize:14,fontWeight:"600",color:e.text},categoryAnalyticsCount:{fontSize:12,color:e.textSecondary,marginTop:2},categoryAnalyticsAmount:{fontSize:14,fontWeight:"bold",color:"#2e7d32"},trendItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,borderBottomWidth:1,borderBottomColor:e.input},trendMonth:{fontSize:14,fontWeight:"600",color:e.text},trendAmount:{fontSize:14,fontWeight:"bold",color:"#2e7d32"}});var pe=n(1514),xe=n(1706),be=n(7610),je=n(9068),we=n(9007);const Se=()=>{const{theme:e,isDark:t}=E(),n=Ce(e),[r,i]=(0,o.useState)(null),[s,l]=(0,o.useState)("month"),[d,u]=(0,o.useState)(!0),g=(0,o.useCallback)(async()=>{u(!0);try{const[e,t,n]=await Promise.all([D.getEntries(),D.getExpenses(),D.getActionItems()]),r=new Date,o=(0,pe.default)(r,1),a=(0,xe.default)(r,1),l=((r=>{const i="week"===r?o:"month"===r?a:null;i&&e.filter(e=>e.timestamp>=i),i&&t.filter(e=>e.createdAt>=i),i&&n.filter(e=>e.createdAt>=i)})(s),e.length),d=e.filter(e=>e.timestamp>=o).length,c=e.filter(e=>e.timestamp>=a).length,u={},f={};t.forEach(e=>{u[e.currency]=(u[e.currency]||0)+e.amount}),t.filter(e=>e.createdAt>=a).forEach(e=>{f[e.currency]=(f[e.currency]||0)+e.amount});const g=n.length,m=n.filter(e=>e.completed).length,y=g-m,h=g>0?m/g*100:0,p={};e.forEach(e=>{const t=(0,R.default)(e.timestamp,"EEEE");p[t]=(p[t]||0)+1});const x=Object.entries(p).reduce((e,t)=>p[e[0]]>p[t[0]]?e:t,["Monday",0])[0]||"No data",b=e.length>0?e.length/Math.max(1,Math.ceil((r.getTime()-e[0].timestamp.getTime())/864e5)):0,j={};t.forEach(e=>{const t=e.category||"Other";j[t]||(j[t]={amount:0,currency:e.currency}),j[t].amount+=e.amount});const w=Object.entries(j).map(([e,t])=>({category:e,amount:t.amount,currency:t.currency})).sort((e,t)=>t.amount-e.amount).slice(0,5),S=[];for(let i=6;i>=0;i--){const o=(0,be.default)(r,i),a=(0,je.default)(o),s=(0,we.default)(o),l=e.filter(e=>(0,fe.default)(e.timestamp,{start:a,end:s})).length,d=t.filter(e=>(0,fe.default)(e.createdAt,{start:a,end:s})).length,c=n.filter(e=>(0,fe.default)(e.createdAt,{start:a,end:s})).length;S.push({date:(0,R.default)(o,"MMM dd"),entries:l,expenses:d,actions:c})}i({totalEntries:l,entriesThisWeek:d,entriesThisMonth:c,totalExpenses:Object.entries(u).map(([e,t])=>({currency:e,amount:t})),expensesThisMonth:Object.entries(f).map(([e,t])=>({currency:e,amount:t})),totalActionItems:g,completedActionItems:m,pendingActionItems:y,completionRate:h,averageEntriesPerDay:b,mostActiveDay:x,topExpenseCategories:w,recentActivity:S})}catch(e){console.error("Error calculating analytics:",e)}finally{u(!1)}},[s]);return(0,ae.useFocusEffect)((0,o.useCallback)(()=>{g()},[g])),d||!r?(0,B.jsx)(x.SafeAreaView,{style:n.container,children:(0,B.jsx)(a.default,{style:n.loadingText,children:"Loading analytics..."})}):(0,B.jsxs)(x.SafeAreaView,{style:n.container,children:[(0,B.jsx)(c.default,{style:n.header,children:(0,B.jsx)(a.default,{style:n.headerTitle,children:"Analytics & Insights"})}),(0,B.jsxs)(q.default,{style:n.content,showsVerticalScrollIndicator:!1,children:[(0,B.jsx)(c.default,{style:n.periodSelector,children:["week","month","all"].map(e=>(0,B.jsx)(f.default,{style:[n.periodButton,s===e&&n.periodButtonActive],onPress:()=>l(e),children:(0,B.jsx)(a.default,{style:[n.periodButtonText,s===e&&n.periodButtonTextActive],children:"all"===e?"All Time":`This ${e.charAt(0).toUpperCase()+e.slice(1)}`})},e))}),(0,B.jsxs)(c.default,{style:n.summaryGrid,children:[(0,B.jsxs)(c.default,{style:n.summaryCard,children:[(0,B.jsx)(a.default,{style:n.summaryNumber,children:r.totalEntries}),(0,B.jsx)(a.default,{style:n.summaryLabel,children:"Total Entries"})]}),(0,B.jsxs)(c.default,{style:n.summaryCard,children:[(0,B.jsx)(a.default,{style:n.summaryNumber,children:r.totalActionItems}),(0,B.jsx)(a.default,{style:n.summaryLabel,children:"Action Items"})]}),(0,B.jsxs)(c.default,{style:n.summaryCard,children:[(0,B.jsxs)(a.default,{style:n.summaryNumber,children:[r.completionRate.toFixed(0),"%"]}),(0,B.jsx)(a.default,{style:n.summaryLabel,children:"Completion Rate"})]}),(0,B.jsxs)(c.default,{style:n.summaryCard,children:[(0,B.jsx)(a.default,{style:n.summaryNumber,children:r.averageEntriesPerDay.toFixed(1)}),(0,B.jsx)(a.default,{style:n.summaryLabel,children:"Avg Entries/Day"})]})]}),(0,B.jsxs)(c.default,{style:n.section,children:[(0,B.jsx)(a.default,{style:n.sectionTitle,children:"\ud83d\udcb0 Spending Overview"}),r.totalExpenses.length>0?(0,B.jsx)(c.default,{style:n.expenseList,children:r.totalExpenses.map((e,t)=>(0,B.jsxs)(c.default,{style:n.expenseItem,children:[(0,B.jsx)(a.default,{style:n.expenseAmount,children:W.formatCurrency(e.amount,e.currency)}),(0,B.jsx)(a.default,{style:n.expenseLabel,children:"Total Spent"})]},e.currency))}):(0,B.jsx)(a.default,{style:n.emptyText,children:"No expenses recorded yet"})]}),r.topExpenseCategories.length>0&&(0,B.jsxs)(c.default,{style:n.section,children:[(0,B.jsx)(a.default,{style:n.sectionTitle,children:"\ud83d\udcca Top Spending Categories"}),(0,B.jsx)(c.default,{style:n.categoryList,children:r.topExpenseCategories.map((e,t)=>(0,B.jsxs)(c.default,{style:n.categoryItem,children:[(0,B.jsxs)(c.default,{style:n.categoryInfo,children:[(0,B.jsx)(a.default,{style:n.categoryName,children:e.category}),(0,B.jsx)(a.default,{style:n.categoryAmount,children:W.formatCurrency(e.amount,e.currency)})]}),(0,B.jsx)(c.default,{style:[n.categoryBar,{width:e.amount/r.topExpenseCategories[0].amount*100+"%"}]})]},e.category))})]}),(0,B.jsxs)(c.default,{style:n.section,children:[(0,B.jsx)(a.default,{style:n.sectionTitle,children:"\ud83d\udcc8 Activity Patterns"}),(0,B.jsxs)(c.default,{style:n.patternCard,children:[(0,B.jsx)(a.default,{style:n.patternLabel,children:"Most Active Day"}),(0,B.jsx)(a.default,{style:n.patternValue,children:r.mostActiveDay})]})]}),(0,B.jsxs)(c.default,{style:n.section,children:[(0,B.jsx)(a.default,{style:n.sectionTitle,children:"\ud83d\udcc5 Recent Activity (Last 7 Days)"}),(0,B.jsx)(c.default,{style:n.chartContainer,children:r.recentActivity.map((e,t)=>{const o=Math.max(...r.recentActivity.map(e=>e.entries)),i=Math.max(...r.recentActivity.map(e=>e.expenses)),s=Math.max(...r.recentActivity.map(e=>e.actions)),l=Math.max(o,i,s,1),d=Math.max(4,e.entries/l*50),u=Math.max(4,e.expenses/l*50),f=Math.max(4,e.actions/l*50);return(0,B.jsxs)(c.default,{style:n.chartDay,children:[(0,B.jsxs)(c.default,{style:n.chartBars,children:[(0,B.jsx)(c.default,{style:[n.chartBar,n.entriesBar,{height:d}]}),(0,B.jsx)(c.default,{style:[n.chartBar,n.expensesBar,{height:u}]}),(0,B.jsx)(c.default,{style:[n.chartBar,n.actionsBar,{height:f}]})]}),(0,B.jsx)(a.default,{style:n.chartDate,children:e.date})]},e.date)})}),(0,B.jsxs)(c.default,{style:n.legend,children:[(0,B.jsxs)(c.default,{style:n.legendItem,children:[(0,B.jsx)(c.default,{style:[n.legendColor,n.entriesBar]}),(0,B.jsx)(a.default,{style:n.legendText,children:"Entries"})]}),(0,B.jsxs)(c.default,{style:n.legendItem,children:[(0,B.jsx)(c.default,{style:[n.legendColor,n.expensesBar]}),(0,B.jsx)(a.default,{style:n.legendText,children:"Expenses"})]}),(0,B.jsxs)(c.default,{style:n.legendItem,children:[(0,B.jsx)(c.default,{style:[n.legendColor,n.actionsBar]}),(0,B.jsx)(a.default,{style:n.legendText,children:"Actions"})]})]})]}),(0,B.jsxs)(c.default,{style:n.section,children:[(0,B.jsx)(a.default,{style:n.sectionTitle,children:"\ud83d\udca1 Insights"}),(0,B.jsxs)(c.default,{style:n.insightsList,children:[r.averageEntriesPerDay>3&&(0,B.jsx)(c.default,{style:n.insightCard,children:(0,B.jsxs)(a.default,{style:n.insightText,children:["\ud83d\udd25 You're on fire! Averaging ",r.averageEntriesPerDay.toFixed(1)," entries per day"]})}),r.completionRate>75&&(0,B.jsx)(c.default,{style:n.insightCard,children:(0,B.jsxs)(a.default,{style:n.insightText,children:["\u2b50 Great job! You complete ",r.completionRate.toFixed(0),"% of your action items"]})}),r.pendingActionItems>5&&(0,B.jsx)(c.default,{style:n.insightCard,children:(0,B.jsxs)(a.default,{style:n.insightText,children:["\u26a0\ufe0f You have ",r.pendingActionItems," pending action items. Consider reviewing them!"]})}),0===r.totalExpenses.length&&r.totalEntries>10&&(0,B.jsx)(c.default,{style:n.insightCard,children:(0,B.jsx)(a.default,{style:n.insightText,children:"\ud83d\udcb8 No expenses tracked yet. Try adding some spending entries to track your budget!"})})]})]})]})]})},Ce=e=>m.default.create({container:{flex:1,backgroundColor:e.background},header:{paddingHorizontal:16,paddingVertical:12,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},headerTitle:{fontSize:20,fontWeight:"bold",color:e.text},loadingText:{textAlign:"center",marginTop:50,fontSize:16,color:e.textSecondary},content:{flex:1},periodSelector:{flexDirection:"row",paddingHorizontal:16,paddingVertical:12,backgroundColor:e.surface,borderBottomWidth:1,borderBottomColor:e.border},periodButton:{flex:1,paddingVertical:8,paddingHorizontal:12,marginHorizontal:4,borderRadius:16,backgroundColor:e.input,alignItems:"center"},periodButtonActive:{backgroundColor:e.primary},periodButtonText:{fontSize:14,fontWeight:"600",color:e.textSecondary},periodButtonTextActive:{color:e.surface},summaryGrid:{flexDirection:"row",flexWrap:"wrap",paddingHorizontal:16,paddingTop:16,gap:12},summaryCard:{width:(O.default.get("window").width-44)/2,backgroundColor:e.surface,padding:16,borderRadius:12,alignItems:"center",shadowColor:e.text,shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},summaryNumber:{fontSize:24,fontWeight:"bold",color:e.text,marginBottom:4},summaryLabel:{fontSize:12,color:e.textSecondary,textAlign:"center"},section:{marginTop:16,paddingHorizontal:16},sectionTitle:{fontSize:18,fontWeight:"bold",color:e.text,marginBottom:12},expenseList:{backgroundColor:e.surface,borderRadius:12,padding:16},expenseItem:{alignItems:"center",marginBottom:8},expenseAmount:{fontSize:20,fontWeight:"bold",color:"#2e7d32"},expenseLabel:{fontSize:12,color:e.textSecondary,marginTop:2},categoryList:{backgroundColor:e.surface,borderRadius:12,padding:16},categoryItem:{marginBottom:12,position:"relative"},categoryInfo:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:4,zIndex:1},categoryName:{fontSize:14,fontWeight:"600",color:e.text},categoryAmount:{fontSize:14,fontWeight:"bold",color:"#2e7d32"},categoryBar:{height:4,backgroundColor:e.primary,borderRadius:2,position:"absolute",bottom:0,left:0,opacity:.3},patternCard:{backgroundColor:e.surface,borderRadius:12,padding:16,alignItems:"center"},patternLabel:{fontSize:14,color:e.textSecondary,marginBottom:4},patternValue:{fontSize:18,fontWeight:"bold",color:e.text},chartContainer:{backgroundColor:e.surface,borderRadius:12,padding:16,flexDirection:"row",justifyContent:"space-around",alignItems:"flex-end",height:100,marginBottom:8},chartDay:{alignItems:"center",flex:1},chartBars:{flexDirection:"row",alignItems:"flex-end",height:50,marginBottom:8,gap:2},chartBar:{width:6,borderRadius:3,minHeight:4},entriesBar:{backgroundColor:e.primary},expensesBar:{backgroundColor:"#2e7d32"},actionsBar:{backgroundColor:"#ff9800"},chartDate:{fontSize:10,color:e.textSecondary},legend:{flexDirection:"row",justifyContent:"center",marginTop:12,gap:16},legendItem:{flexDirection:"row",alignItems:"center"},legendColor:{width:8,height:8,borderRadius:4,marginRight:6},legendText:{fontSize:12,color:e.textSecondary},insightsList:{gap:8},insightCard:{backgroundColor:e.surface,borderRadius:12,padding:16,borderLeftWidth:4,borderLeftColor:e.primary},insightText:{fontSize:14,color:e.text,lineHeight:20},emptyText:{textAlign:"center",color:e.textSecondary,fontSize:14,backgroundColor:e.surface,borderRadius:12,padding:20}});m.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:16,paddingVertical:12,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},headerTitle:{fontSize:20,fontWeight:"bold",color:"#333"},closeButton:{padding:8,borderRadius:20,backgroundColor:"#f0f0f0"},closeButtonText:{fontSize:16,color:"#666",fontWeight:"bold"},content:{flex:1,paddingHorizontal:16},subtitle:{fontSize:16,color:"#666",textAlign:"center",marginVertical:20,lineHeight:22},optionCard:{backgroundColor:"#fff",borderRadius:12,padding:16,marginBottom:16,borderWidth:2,borderColor:"transparent",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},selectedCard:{borderColor:"#007AFF",backgroundColor:"#f8f9ff"},optionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},optionTitleRow:{flexDirection:"row",alignItems:"center",flex:1},optionPreview:{fontSize:28,marginRight:12},optionTitleContainer:{flex:1,flexDirection:"row",alignItems:"center"},optionName:{fontSize:18,fontWeight:"bold",color:"#333",marginRight:8},currentBadge:{backgroundColor:"#007AFF",color:"#fff",fontSize:10,fontWeight:"bold",paddingHorizontal:6,paddingVertical:2,borderRadius:10,overflow:"hidden"},optionDescription:{fontSize:14,color:"#666",marginBottom:12,lineHeight:20},featuresContainer:{marginTop:4},featureRow:{flexDirection:"row",alignItems:"flex-start",marginBottom:4},featureBullet:{fontSize:16,color:"#007AFF",marginRight:8,marginTop:1},featureText:{fontSize:13,color:"#555",flex:1,lineHeight:18},radioButton:{width:24,height:24,borderRadius:12,borderWidth:2,borderColor:"#ddd",justifyContent:"center",alignItems:"center"},radioButtonSelected:{borderColor:"#007AFF"},radioButtonInner:{width:12,height:12,borderRadius:6,backgroundColor:"#007AFF"},footer:{padding:16,backgroundColor:"#fff",borderTopWidth:1,borderTopColor:"#e0e0e0"},selectButton:{backgroundColor:"#007AFF",borderRadius:12,paddingVertical:16,alignItems:"center"},selectButtonDisabled:{backgroundColor:"#f0f0f0"},selectButtonText:{color:"#fff",fontSize:16,fontWeight:"bold"},selectButtonTextDisabled:{color:"#999"}});const ke=(0,l.default)();function Te(){const{theme:e,isDark:t}=E();return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(i.StatusBar,{style:t?"light":"dark"}),(0,B.jsx)(s.default,{children:(0,B.jsxs)(ke.Navigator,{screenOptions:({route:t})=>({tabBarIcon:({focused:e,color:n,size:r})=>{let o;return o="Journal"===t.name?"\ud83d\udcdd":"ActionItems"===t.name?"\u2705":"Expenses"===t.name?"\ud83d\udcb0":"Analytics"===t.name?"\ud83d\udcca":"\u2753",(0,B.jsx)(a.default,{style:{fontSize:r,color:n},children:o})},tabBarActiveTintColor:e.primary,tabBarInactiveTintColor:e.textSecondary,tabBarStyle:{backgroundColor:e.surface,borderTopWidth:1,borderTopColor:e.border,paddingBottom:5,paddingTop:5,height:60},headerShown:!1}),children:[(0,B.jsx)(ke.Screen,{name:"Journal",component:ee,options:{tabBarLabel:"Journal"}}),(0,B.jsx)(ke.Screen,{name:"ActionItems",component:le,options:{tabBarLabel:"Tasks"}}),(0,B.jsx)(ke.Screen,{name:"Expenses",component:ye,options:{tabBarLabel:"Expenses"}}),(0,B.jsx)(ke.Screen,{name:"Analytics",component:Se,options:{tabBarLabel:"Analytics"}})]})})]})}function De(){return(0,B.jsx)(d.SafeAreaProvider,{children:(0,B.jsx)(z,{children:(0,B.jsx)(Te,{})})})}(0,r.default)(De),(0,r.default)(De)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,(()=>{var e=[];n.O=(t,r,o,a)=>{if(!r){var i=1/0;for(c=0;c<e.length;c++){for(var[r,o,a]=e[c],s=!0,l=0;l<r.length;l++)(!1&a||i>=a)&&Object.keys(n.O).every(e=>n.O[e](r[l]))?r.splice(l--,1):(s=!1,a<i&&(i=a));if(s){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,o,a]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/DailyTracker/",(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,a,[i,s,l]=r,d=0;if(i.some(t=>0!==e[t])){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(l)var c=l(n)}for(t&&t(r);d<i.length;d++)a=i[d],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(c)},r=self.webpackChunkweb=self.webpackChunkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[7],()=>n(6754));r=n.O(r)})();
//# sourceMappingURL=main.353940ee.js.map